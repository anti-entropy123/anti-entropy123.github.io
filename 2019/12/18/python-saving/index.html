<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    <link rel="canonical" href="https://tjuyjn.top/2019/12/18/python-saving/">
    
    
    <title>python拯救计划 | Anti-entropy&#39;s blog | 向一切虚伪的美好宣战</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="python,scrapy,flask,爬虫,正则表达式">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.2">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":null,"app_id":"falsee1f779yetMaV1lNERajntYJH-gzGzoHsz","app_key":"CGROdujMx4Hw9l84Eysyhp7D","icon":true}'),
            v: JSON.parse('{"enable":true,"appid":"w6aWfPRvBTtEbBcUQVnWa1fl-MdYXbMMI","appkey":"96PaRwN0DWkNUdwQrWx3Ff7g","notify":true,"verify":true,"placeholder":"来和希儿一起玩吧 -- 记得告诉希儿你的昵称和邮箱哟","avatar":"retro"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    

    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?85ac030db207eb5660d0fd7b00b2205d";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
        <!-- live2d css -->
        <style>
            .live2d-widget-dialog-container {
                width: 300px;
                height: 120px;
                position: absolute;
                bottom: 65%;
                right: 0px;
                transform-origin: right;
                padding: 12px;
                box-sizing: border-box;
                -webkit-font-smoothing: antialiased;
            }
            .live2d-widget-dialog {
                width: 100%;
                height: 100%;
                color: #917159;
                font-size: 16px;
                padding: 12px;
                border: 2px solid rgb(236, 203, 180);
                background: rgb(252, 248, 244);
                box-sizing: border-box;
                border-radius: 10px;
                transform: rotate(-2deg);
                opacity: 0;
                transition: 200ms opacity;
                box-shadow: rgba(0, 0, 0, 0.12) 0px 1px 6px, rgba(0, 0, 0, 0.12) 0px 1px 4px;
                animation: live2d-widget-dialog-tingle 4s ease-in-out 0s infinite alternate;
            }
            @keyframes live2d-widget-dialog-tingle {
                0% { transform: translate(-1px, 1.5px) rotate(-2deg); }
                100% { transform: translate(1px, -1.5px) rotate(2deg); }
            }
        </style>
    
        <!--- live2d js -->
        <script src="http://188.131.227.20:999/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script>
        <script>L2Dwidget.init({"pluginRootPath":"http://188.131.227.20:999/live2dw/","pluginJsPath":"http://188.131.227.20:999/lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/Epsilon2.1.model.json"},"display":{"position":"right","width":300,"height":400},"mobile":{"show":false},"log":false});</script>
        <div id="live2d-widget" class="live2d-widget-container" style="position: fixed; right: 0px; bottom: -20px; width: 300px; height: 400px; z-index: 99999; opacity: 1; pointer-events: none;"><canvas id="live2dcanvas" width="600" height="800" style="position: absolute; left: 0px; top: 0px; width: 300px; height: 400px;"></canvas></div>
        <script>
            var imageArr=[];
        </script>
        
</head>



<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Anti-entropy</h5>
          <a href="mailto:1348651580@qq.com" title="1348651580@qq.com" class="mail">
            
              <span>1</span>
            
              <span>3</span>
            
              <span>4</span>
            
              <span>8</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>1</span>
            
              <span>5</span>
            
              <span>8</span>
            
              <span>0</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/anti-entropy123/" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
          <div id="binft" style=" text-align:center;">
              <script>
                var binft = function (r) {
                  function t() {
                    return b[Math.floor(Math.random() * b.length)]
                  }  
                  function e() {
                    return String.fromCharCode(94 * Math.random() + 33)
                  }
                  function n(r) {
                    for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
                      var l = document.createElement("span");
                      l.textContent = e(), l.style.color = t(), n.appendChild(l)
                    }
                    return n
                  }
                  function i() {
                    var t = o[c.skillI];
                    c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
                  }
                  var l = "",
                  o = [
                        "孤独是常态,", "寂寞是病态",
                        "孤独使我自由,", "寂寞让我作呕",
                        "为守护所有美好而战,", "向一切虚伪的美好宣战",
                        "Don't be sorry,", "Be better",
                        "伤痕,", "是我的勋章",
                        "但置我于低谷者,", "必将助我以崛起",
                        "但置我于死地者,", "必将赐我以后生",
                        "行于黑暗,", "侍奉光明", 
                        "万物皆虚,", "万事皆允",
                        "天生我材必有用,", "千金散尽还复来",
                        "解甲归田,", "只为月光"
                      ].map(function (r) {
                  return r + ""
                  }),
                  a = 2,
                  g = 1,
                  s = 5,
                  d = 75,
                  b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
                  c = {
                    text: "",
                    prefixP: -s,
                    skillI: 0,
                    skillP: 0,
                    direction: "forward",
                    delay: a,
                    step: g
                  };
                  i()
                  };
                  binft(document.getElementById('binft'));
              </script>
            </div>
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>python拯救计划</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">python拯救计划</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-12-18T12:39:51.000Z" itemprop="datePublished" class="page-time">
  2019-12-18
</time>


            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-python-saving"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">python拯救计划</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-18 20:39:51" datetime="2019-12-18T12:39:51.000Z"  itemprop="datePublished">2019-12-18</time>

            


            

            
    <span class="leancloud-comment">
        <i class="icon icon-comment-o"></i>
        <a href="/2019/12/18/python-saving/#comment">
            <span class="valine-comment-count" data-xid="/2019/12/18/python-saving/"></span>
        </a>
    </span>



            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p>我决心要提高python编程能力. 在此积累一些牛逼的python使用方法.</p>
<a id="more"></a>


<h1 id="高阶特性"><a href="#高阶特性" class="headerlink" title="高阶特性"></a>高阶特性</h1><p>在实际编程中, 如果能大量运用高阶特性和函数, 就能大大缩短代码的行数, 写出非常 pythonic 的代码.</p>
<h2 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h2><p>类似C++ 和 Java 中的 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a ? b:c</span><br></pre></td></tr></table></figure>

<p>python 也支持类似的三目运算符.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b <span class="keyword">if</span> a <span class="keyword">else</span> c</span><br></pre></td></tr></table></figure>

<p>有一说一, 我认为这种python的这种语法更符合思考时的逻辑.</p>
<p>得益于这种三目运算符, 我们可以把一行代码写的很长很长, 大满足.<br>例如:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> (self.p &lt;= root.val <span class="keyword">and</span> self.q &gt;= root.val): root = root.left <span class="keyword">if</span> self.q &lt; root.val <span class="keyword">else</span> root.right</span><br></pre></td></tr></table></figure>

<h2 id="星号-的使用"><a href="#星号-的使用" class="headerlink" title="星号 * 的使用"></a>星号 * 的使用</h2><p>将可迭代对象拆分.</p>
<p>举例: </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(*(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"hello"</span>)</span><br><span class="line">hello</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(*<span class="string">"hello"</span>)</span><br><span class="line">h e l l o</span><br></pre></td></tr></table></figure>

<h2 id="双星号-的使用"><a href="#双星号-的使用" class="headerlink" title="双星号 ** 的使用"></a>双星号 ** 的使用</h2><p>上述星号 * 的用法有时会很方便, 但是 * 无法应对字典变量的拆解.<br>例如:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'a'</span>:<span class="string">'apple'</span>, <span class="string">'b'</span>:<span class="string">'banana'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(*d)</span><br><span class="line">a b</span><br></pre></td></tr></table></figure>

<ul>
<li>只能拆分字典的key值, 无法获取 value.<br>这种情况下应该使用 ** .<br>例如<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(**d)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="string">'a'</span> <span class="keyword">is</span> an invalid keyword argument <span class="keyword">for</span> print()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>竟然报错了, 原来 ** 的用法和我想象的并不一样.<br>它实际上会将字典转为 <code>key = value</code> 的形式, 所以 key 一定要符合 python 的变量命名规则.</p>
<p>正确的用法应该是这样的:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(a, b=<span class="number">2</span>, c = <span class="number">3</span>)</span>:</span> </span><br><span class="line"><span class="meta">... </span>print(a, b, c)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'a'</span>:<span class="number">1</span>, <span class="string">'b'</span>:<span class="number">-2</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>test(**d)</span><br><span class="line"><span class="number">1</span> <span class="number">-2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h2 id="func-args-kw"><a href="#func-args-kw" class="headerlink" title="func(*args, **kw)"></a><code>func(*args, **kw)</code></h2><p>可以接收任何数量的或者有关键字的参数的函数的一般形式.</p>
<h1 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h1><h2 id="filter"><a href="#filter" class="headerlink" title="filter()"></a>filter()</h2><p>filter这个单词的意思是过滤器, 顾名思义, filter()可以起到过滤器的作用.</p>
<blockquote>
<p>filter(function, sequence)<br>Parameters:<br>function: function that tests if each element of a<br>sequence true or not.<br>sequence: sequence which needs to be filtered, it can<br>be sets, lists, tuples, or containers of any iterators.<br>Returns:<br>returns an iterator that is already filtered.</p>
</blockquote>
<p>实例1:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># function that filters vowels </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(variable)</span>:</span> </span><br><span class="line">    letters = [<span class="string">'a'</span>, <span class="string">'e'</span>, <span class="string">'i'</span>, <span class="string">'o'</span>, <span class="string">'u'</span>] </span><br><span class="line">    <span class="keyword">if</span> (variable <span class="keyword">in</span> letters): </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># sequence </span></span><br><span class="line">sequence = [<span class="string">'g'</span>, <span class="string">'e'</span>, <span class="string">'e'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'s'</span>, <span class="string">'p'</span>, <span class="string">'r'</span>] </span><br><span class="line">  </span><br><span class="line"><span class="comment"># using filter function </span></span><br><span class="line">filtered = filter(fun, sequence) </span><br><span class="line">  </span><br><span class="line">print(<span class="string">'The filtered letters are:'</span>) </span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> filtered: </span><br><span class="line">    print(s)</span><br></pre></td></tr></table></figure>

<p>output:</p>
<blockquote>
<p>The filtered letters are:<br>e<br>e</p>
</blockquote>
<p>实例2: </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a list contains both even and odd numbers.  </span></span><br><span class="line">seq = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># result contains odd numbers of the list </span></span><br><span class="line">result = filter(<span class="keyword">lambda</span> x: x % <span class="number">2</span>, seq) </span><br><span class="line">print(list(result)) </span><br><span class="line">  </span><br><span class="line"><span class="comment"># result contains even numbers of the list </span></span><br><span class="line">result = filter(<span class="keyword">lambda</span> x: x % <span class="number">2</span> == <span class="number">0</span>, seq) </span><br><span class="line">print(list(result))</span><br></pre></td></tr></table></figure>

<p>output: </p>
<blockquote>
<p>[1, 3, 5, 13]<br>[0, 2, 8]</p>
</blockquote>
<p>filter的第一个参数为一个 <strong>lambda表达式</strong>. </p>
<h2 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h2><p>个人理解: 通过某种函数规则, 利用传入的(一个或多个)序列生成输出的序列.</p>
<blockquote>
<p>map(fun, iter)<br>Parameters :<br>fun : It is a function to which map passes each element of given iterable.<br>iter : It is a iterable which is to be mapped.<br>NOTE : You can pass one or more iterable to the map() function.<br>Returns :<br>Returns a list of the results after applying the given function<br>to each item of a given iterable (list, tuple etc.)</p>
</blockquote>
<p>实例1: </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addition</span><span class="params">(n)</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> n + n </span><br><span class="line">  </span><br><span class="line"><span class="comment"># We double all numbers using map() </span></span><br><span class="line">numbers = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>) </span><br><span class="line">result = map(addition, numbers) </span><br><span class="line">print(list(result))</span><br></pre></td></tr></table></figure>

<p>output:</p>
<blockquote>
<p>{2, 4, 6, 8}</p>
</blockquote>
<p>实例2:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">numbers1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line">numbers2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>] </span><br><span class="line">  </span><br><span class="line">result = map(<span class="keyword">lambda</span> x, y: x + y, numbers1, numbers2) </span><br><span class="line">print(list(result))</span><br></pre></td></tr></table></figure>

<p>output :</p>
<blockquote>
<p>[5, 7, 9]</p>
</blockquote>
<h2 id="enumerate"><a href="#enumerate" class="headerlink" title="enumerate()"></a>enumerate()</h2><p>个人理解: 可以返回可迭代的对象的”键值对”(枚举类对象)</p>
<blockquote>
<p>Syntax:<br>enumerate(iterable, start=0)<br>Parameters:<br>Iterable: any object that supports iteration<br>Start: the index value from which the counter is<br>              to be started, by default it is 0 </p>
</blockquote>
<p>举例:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>L2 = [<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="number">18</span>, <span class="string">'apple'</span>, <span class="literal">None</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[(x,y) <span class="keyword">for</span> x,y <span class="keyword">in</span> list(enumerate(L2))]</span><br><span class="line">[(<span class="number">0</span>, <span class="string">'hello'</span>), (<span class="number">1</span>, <span class="string">'world'</span>), (<span class="number">2</span>, <span class="number">18</span>), (<span class="number">3</span>, <span class="string">'apple'</span>), (<span class="number">4</span>, <span class="literal">None</span>)]</span><br></pre></td></tr></table></figure>

<h2 id="zip"><a href="#zip" class="headerlink" title="zip()"></a>zip()</h2><p>可以让两个可迭代变量成对出现, 长度由较短的那个变量决定.</p>
<p>举例:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(zip(a,b))</span><br><span class="line">&lt;zip object at <span class="number">0x000002701A44C688</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(zip(a,b)))</span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br></pre></td></tr></table></figure>

<h1 id="lambda表达式"><a href="#lambda表达式" class="headerlink" title="lambda表达式"></a>lambda表达式</h1><p>个人理解: lambda表达式 是一种匿名的函数.</p>
<p>Syntax:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> arguments : expression</span><br></pre></td></tr></table></figure>

<p>lambda表达式等效于函数, 例如下面的代码:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="keyword">lambda</span> a : a + <span class="number">10</span></span><br><span class="line"><span class="comment"># 等效于</span></span><br><span class="line"><span class="comment"># def x(a):</span></span><br><span class="line"><span class="comment">#     return a+10</span></span><br><span class="line">print(x(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<p>output</p>
<blockquote>
<p>15</p>
</blockquote>
<p>定义有多个参数的lambda表达式:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="keyword">lambda</span> a, b, c : a + b + c</span><br><span class="line">print(x(<span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<p>output:</p>
<blockquote>
<p>13</p>
</blockquote>
<h1 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h1><p>个人理解: 如果事前已经定义好一个函数f(), 随后想扩展它的功能而又不想修改 f() 的代码, 就可以使用装饰器.</p>
<p>例如, 已经有定义好的函数:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"hello world"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="简单装饰器"><a href="#简单装饰器" class="headerlink" title="简单装饰器"></a>简单装饰器</h2><p>现在, 想扩展f()的功能, 使其在输出<code>&quot;hello world&quot;</code>前先打印<code>&quot;start&quot;</code>. </p>
<p>为了不修改原来的代码, 可定义装饰器函数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">        print(<span class="string">'start'</span>)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>

<p>再在f()的定义前使用 @ 语法指定这个装饰器</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@before</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure>

<p>此时调用f(), 输出为:</p>
<blockquote>
<p>start<br>hello world</p>
</blockquote>
<p>实际上, 装饰器是一个返回函数的高阶函数.<br>当调用 f() 时, 因为存在装饰器, 所以并不会直接运行 f() 函数体内的代码, 而是会调用函数 before(f).<br>所以调用 f() 等效于:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = before(f)</span><br><span class="line">f()</span><br></pre></td></tr></table></figure>

<p>而 before 中其实只有一行代码 <code>return wrapper</code>.<br>所以 f 指向了新的函数 <code>wrapper</code>.<br>所以 <code>f()</code> 等效于 <code>wrapper()</code>.</p>
<h2 id="在-f-运行后再打印-quot-finish-quot"><a href="#在-f-运行后再打印-quot-finish-quot" class="headerlink" title="在 f() 运行后再打印&quot;finish&quot;"></a>在 f() 运行后再打印<code>&quot;finish&quot;</code></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">        print(<span class="string">'start'</span>)</span><br><span class="line">        result = func(*args, **kw)</span><br><span class="line">        print(<span class="string">'finish)</span></span><br><span class="line"><span class="string">        return result</span></span><br><span class="line"><span class="string">    return wrapper</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@before</span></span><br><span class="line"><span class="string">def f(*args, **kw):</span></span><br><span class="line"><span class="string">    print('</span>hello world<span class="string">')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">f()</span></span><br></pre></td></tr></table></figure>

<p>在 wrapper 中用变量 result 保存了 func 的返回值, 并在适当时刻返回到函数外.</p>
<h2 id="使用多个装饰器实现上一个功能"><a href="#使用多个装饰器实现上一个功能" class="headerlink" title="使用多个装饰器实现上一个功能"></a>使用多个装饰器实现上一个功能</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">        print(<span class="string">'start'</span>)</span><br><span class="line">        <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">after</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">        result = func()()</span><br><span class="line">        print(<span class="string">'finish'</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@after</span></span><br><span class="line"><span class="meta">@before</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">    print(<span class="string">'hello world'</span>)</span><br><span class="line"></span><br><span class="line">f()</span><br></pre></td></tr></table></figure>

<p>多个装饰器的执行顺序为由内到外.<br>等效于:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = after(before(f))</span><br><span class="line">f()</span><br></pre></td></tr></table></figure>

<h2 id="使用带有参数的装饰器-打印-quot-start-quot-参数"><a href="#使用带有参数的装饰器-打印-quot-start-quot-参数" class="headerlink" title="使用带有参数的装饰器, 打印&quot;start&quot; + 参数"></a>使用带有参数的装饰器, 打印<code>&quot;start&quot; + 参数</code></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">with_parm</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">before</span><span class="params">(func)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">            print(<span class="string">'start'</span>, name)</span><br><span class="line">            <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> before</span><br><span class="line"></span><br><span class="line"><span class="meta">@with_parm('yjn')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">    print(<span class="string">'hello world'</span>)</span><br><span class="line"></span><br><span class="line">f()</span><br></pre></td></tr></table></figure>

<p>这里带有参数的装饰器, 本质上是对原有的装饰器的封装.<br><code>with_parm(&#39;yjn&#39;)</code> 返回的便是普通的装饰器(before).<br>只不过在 with_parm 内通过传入的参数对 before 进行修改.</p>
<h1 id="列表生成式"><a href="#列表生成式" class="headerlink" title="列表生成式"></a>列表生成式</h1><p>假如需要一个列表: [1,4,9,16 …., 100], 可以使用哪些语法?</p>
<ol>
<li><p>使用for循环</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>):</span><br><span class="line">    a.append(x**<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用文章开始提到的 map() 函数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list(map(<span class="keyword">lambda</span> x:x**<span class="number">2</span>,list(range(<span class="number">1</span>,<span class="number">10</span>))))</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<strong>列表生成式</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>)]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>可以看出列表生成式能极大的简化代码. </p>
<p>此外如果使用两层for, 可以生成全排列.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[m+n <span class="keyword">for</span> m <span class="keyword">in</span> <span class="string">"abc"</span> <span class="keyword">for</span> n <span class="keyword">in</span> <span class="string">"yjn"</span>]</span><br><span class="line">[<span class="string">'ay'</span>, <span class="string">'aj'</span>, <span class="string">'an'</span>, <span class="string">'by'</span>, <span class="string">'bj'</span>, <span class="string">'bn'</span>, <span class="string">'cy'</span>, <span class="string">'cj'</span>, <span class="string">'cn'</span>]</span><br></pre></td></tr></table></figure>

<p>还可以搭配 if 和 else 一起使用:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>L1 = [<span class="string">'Hello'</span>, <span class="string">'World'</span>, <span class="number">18</span>, <span class="string">'Apple'</span>, <span class="literal">None</span>] </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x.lower()  <span class="keyword">if</span> isinstance(x,str) <span class="keyword">else</span> x <span class="keyword">for</span> x <span class="keyword">in</span> L1]       </span><br><span class="line">[<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="number">18</span>, <span class="string">'apple'</span>, <span class="literal">None</span>]</span><br></pre></td></tr></table></figure>

<h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><table>
<thead>
<tr>
<th>符号</th>
<th>解释</th>
<th>示例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>.</td>
<td>匹配任意字符</td>
<td>b.t</td>
<td>可以匹配bat / but / b#t / b1t等</td>
</tr>
<tr>
<td>\w</td>
<td>匹配字母/数字/下划线</td>
<td>b\wt</td>
<td>可以匹配bat / b1t / b_t等<br>但不能匹配b#t</td>
</tr>
<tr>
<td>\s</td>
<td>匹配空白字符（包括\r、\n、\t等）</td>
<td>love\syou</td>
<td>可以匹配love you</td>
</tr>
<tr>
<td>\d</td>
<td>匹配数字</td>
<td>\d\d</td>
<td>可以匹配01 / 23 / 99等</td>
</tr>
<tr>
<td>\b</td>
<td>匹配单词的边界</td>
<td>\bThe\b</td>
<td></td>
</tr>
<tr>
<td>^</td>
<td>匹配字符串的开始</td>
<td>^The</td>
<td>可以匹配The开头的字符串</td>
</tr>
<tr>
<td>$</td>
<td>匹配字符串的结束</td>
<td>.exe$</td>
<td>可以匹配.exe结尾的字符串</td>
</tr>
<tr>
<td>\W</td>
<td>匹配非字母/数字/下划线</td>
<td>b\Wt</td>
<td>可以匹配b#t / b@t等<br>但不能匹配but / b1t / b_t等</td>
</tr>
<tr>
<td>\S</td>
<td>匹配非空白字符</td>
<td>love\Syou</td>
<td>可以匹配love#you等<br>但不能匹配love you</td>
</tr>
<tr>
<td>\D</td>
<td>匹配非数字</td>
<td>\d\D</td>
<td>可以匹配9a / 3# / 0F等</td>
</tr>
<tr>
<td>\B</td>
<td>匹配非单词边界</td>
<td>\Bio\B</td>
<td></td>
</tr>
<tr>
<td>[]</td>
<td>匹配来自字符集的任意单一字符</td>
<td>[aeiou]</td>
<td>可以匹配任一元音字母字符</td>
</tr>
<tr>
<td>[^]</td>
<td>匹配不在字符集中的任意单一字符</td>
<td>[^aeiou]</td>
<td>可以匹配任一非元音字母字符</td>
</tr>
<tr>
<td>*</td>
<td>匹配0次或多次</td>
<td>\w*</td>
<td></td>
</tr>
<tr>
<td>+</td>
<td>匹配1次或多次</td>
<td>\w+</td>
<td></td>
</tr>
<tr>
<td>?</td>
<td>匹配0次或1次</td>
<td>\w?</td>
<td></td>
</tr>
<tr>
<td>{N}</td>
<td>匹配N次</td>
<td>\w{3}</td>
<td></td>
</tr>
<tr>
<td>{M,}</td>
<td>匹配至少M次</td>
<td>\w{3,}</td>
<td></td>
</tr>
<tr>
<td>{M,N}</td>
<td>匹配至少M次至多N次</td>
<td>\w{3,6}</td>
<td></td>
</tr>
<tr>
<td>|</td>
<td>分支</td>
<td>foo|bar</td>
<td>可以匹配foo或者bar</td>
</tr>
<tr>
<td>(?#)</td>
<td>注释</td>
<td></td>
<td></td>
</tr>
<tr>
<td>(exp)</td>
<td>匹配exp并捕获到自动命名的组中</td>
<td></td>
<td></td>
</tr>
<tr>
<td>(?&nbsp;&lt;name&gt;exp)</td>
<td>匹配exp并捕获到名为name的组中</td>
<td></td>
<td></td>
</tr>
<tr>
<td>(?:exp)</td>
<td>匹配exp但是不捕获匹配的文本</td>
<td></td>
<td></td>
</tr>
<tr>
<td>(?=exp)</td>
<td>匹配exp前面的位置</td>
<td>\b\w+(?=ing)</td>
<td>可以匹配I’m dancing中的danc</td>
</tr>
<tr>
<td>(?&lt;=exp)</td>
<td>匹配exp后面的位置</td>
<td>(?&lt;=\bdanc)\w+\b</td>
<td>可以匹配I love dancing and reading中的第一个ing</td>
</tr>
<tr>
<td>(?!exp)</td>
<td>匹配后面不是exp的位置</td>
<td></td>
<td></td>
</tr>
<tr>
<td>(?&lt;!exp)</td>
<td>匹配前面不是exp的位置</td>
<td></td>
<td></td>
</tr>
<tr>
<td>*?</td>
<td>重复任意次，但尽可能少重复</td>
<td>a.*b<br>a.*?b</td>
<td>将正则表达式应用于aabab，前者会匹配整个字符串aabab，后者会匹配aab和ab两个字符串</td>
</tr>
<tr>
<td>+?</td>
<td>重复1次或多次，但尽可能少重复</td>
<td></td>
<td></td>
</tr>
<tr>
<td>??</td>
<td>重复0次或1次，但尽可能少重复</td>
<td></td>
<td></td>
</tr>
<tr>
<td>{M,N}?</td>
<td>重复M到N次，但尽可能少重复</td>
<td></td>
<td></td>
</tr>
<tr>
<td>{M,}?</td>
<td>重复M次以上，但尽可能少重复</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>Python提供了re模块来支持正则表达式相关操作，下面是re模块中的核心函数。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>compile(pattern, flags=0)</td>
<td>编译正则表达式返回正则表达式对象</td>
</tr>
<tr>
<td>match(pattern, string, flags=0)</td>
<td>用正则表达式匹配字符串 成功返回匹配对象 否则返回None</td>
</tr>
<tr>
<td>search(pattern, string, flags=0)</td>
<td>搜索字符串中第一次出现正则表达式的模式 成功返回匹配对象 否则返回None</td>
</tr>
<tr>
<td>split(pattern, string, maxsplit=0, flags=0)</td>
<td>用正则表达式指定的模式分隔符拆分字符串 返回列表</td>
</tr>
<tr>
<td>sub(pattern, repl, string, count=0, flags=0)</td>
<td>用指定的字符串替换原字符串中与正则表达式匹配的模式 可以用count指定替换的次数</td>
</tr>
<tr>
<td>fullmatch(pattern, string, flags=0)</td>
<td>match函数的完全匹配（从字符串开头到结尾）版本</td>
</tr>
<tr>
<td>findall(pattern, string, flags=0)</td>
<td>查找字符串所有与正则表达式匹配的模式 返回字符串的列表</td>
</tr>
<tr>
<td>finditer(pattern, string, flags=0)</td>
<td>查找字符串所有与正则表达式匹配的模式 返回一个迭代器</td>
</tr>
<tr>
<td>purge()</td>
<td>清除隐式编译的正则表达式的缓存</td>
</tr>
<tr>
<td>re.I / re.IGNORECASE</td>
<td>忽略大小写匹配标记</td>
</tr>
<tr>
<td>re.M / re.MULTILINE</td>
<td>多行匹配标记</td>
</tr>
</tbody></table>
<h1 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h1><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><p>基本爬虫工作流程:</p>
<figure class="image-box">
                <a rel=python拯救计划 href="https://hexo-blog-1258787237.cos.ap-beijing.myqcloud.com/hexo-img/crawler-workflow.jpg" title="" data-fancybox="images"><img src="https://hexo-blog-1258787237.cos.ap-beijing.myqcloud.com/hexo-img/crawler-workflow.jpg" alt title class></a>
                <p></p>
            </figure>

<p>常用标准库和第三方库:</p>
<ul>
<li>下载数据 - urllib / requests / aiohttp</li>
<li>解析数据 - re / lxml / beautifulsoup4 / pyquery</li>
<li>缓存和持久化 - pymysql / sqlalchemy / peewee/ redis / pymongo</li>
<li>生成数字签名 - hashlib。</li>
<li>序列化和压缩 - pickle / json / zlib</li>
<li>调度器 - 多进程（multiprocessing） / 多线程（threading）</li>
</ul>
<p>当访问https链接时会因为验证SSL证书而产生错误. 解决方法有下面两种:</p>
<ul>
<li><p>使用未经验证的上下文</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"></span><br><span class="line">request = urllib.request.Request(url=<span class="string">'...'</span>, headers=&#123;...&#125;) </span><br><span class="line">context = ssl._create_unverified_context()</span><br><span class="line">web_page = urllib.request.urlopen(request, context=context)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置全局性取消证书验证</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"></span><br><span class="line">ssl._create_default_https_context = ssl._create_unverified_context</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="request-库"><a href="#request-库" class="headerlink" title="request 库"></a>request 库</h2><ol>
<li><p>使用GET请求和POST请求</p>
<ul>
<li><p>简单请求页面方式:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(<span class="string">'https://api.github.com/events'</span>)</span><br><span class="line">r = requests.post(<span class="string">'http://httpbin.org/post'</span>, data = &#123;<span class="string">'key'</span>:<span class="string">'value'</span>&#125;)</span><br><span class="line">r = requests.delete(<span class="string">'http://httpbin.org/delete'</span>)</span><br><span class="line">r = requests.head(<span class="string">'http://httpbin.org/get'</span>)</span><br><span class="line">r = requests.options(<span class="string">'http://httpbin.org/get'</span>)</span><br></pre></td></tr></table></figure>

<p>得到一个名为 r 的 Response 对象.</p>
</li>
</ul>
</li>
<li><p>参数和请求头</p>
<ul>
<li><p>带有参数的请求:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: <span class="string">'value2'</span>&#125;</span><br><span class="line">r = requests.get(<span class="string">"http://httpbin.org/get"</span>, params=payload)</span><br><span class="line">r = requests.post(<span class="string">'http://httpbin.org/post'</span>, data = &#123;<span class="string">'key'</span>:<span class="string">'value'</span>&#125;)</span><br><span class="line">r = requests.put(<span class="string">'http://httpbin.org/put'</span>, data = &#123;<span class="string">'key'</span>:<span class="string">'value'</span>&#125;)</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: [<span class="string">'value2'</span>, <span class="string">'value3'</span>]&#125;</span><br><span class="line">r = requests.get(<span class="string">'http://httpbin.org/get'</span>, params=payload)</span><br><span class="line">print(r.url)</span><br><span class="line"><span class="comment"># http://httpbin.org/get?key1=value1&amp;key2=value2&amp;key2=value3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>发送 Cookie</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">'http://httpbin.org/cookies'</span></span><br><span class="line">cookies = dict(cookies_are=<span class="string">'working'</span>)</span><br><span class="line"></span><br><span class="line">r = requests.get(url, cookies=cookies)</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写请求头</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">'https://api.github.com/some/endpoint'</span></span><br><span class="line">headers = &#123;<span class="string">'user-agent'</span>: <span class="string">'my-app/0.0.1'</span>&#125;</span><br><span class="line"></span><br><span class="line">r = requests.get(url, headers=headers)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>从 Response 对象中获取信息</p>
<ul>
<li><p>获取页面</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.text       <span class="comment"># 自动编码</span></span><br><span class="line">r.encoding = <span class="string">'utf-8'</span></span><br><span class="line">r.content    <span class="comment"># 二进制数据</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取响应状态码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(<span class="string">'http://httpbin.org/get'</span>)</span><br><span class="line">r.status_code</span><br><span class="line"><span class="comment"># 200</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取响应头</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.headers</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取二进制文件(如图片)</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line">i = Image.open(BytesIO(r.content))</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取 JSON</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(<span class="string">'https://api.github.com/events'</span>)</span><br><span class="line">    r.json()</span><br><span class="line">    <span class="comment"># [&#123;u'repository': &#123;u'open_issues': 0, u'url': 'https://github.com/...</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">'error'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取 Cookie</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.cookies[<span class="string">'example_cookie_name'</span>]</span><br><span class="line"><span class="comment"># 'example_cookie_value'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取套接字中的 TCP 报文段</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(filename, <span class="string">'wb'</span>) <span class="keyword">as</span> fd:</span><br><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size):</span><br><span class="line">    fd.write(chunk)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
<h2 id="XPath-解析"><a href="#XPath-解析" class="headerlink" title="XPath 解析"></a>XPath 解析</h2><ul>
<li><p>访问节点</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>bookstore</td>
<td>选取 bookstore 元素的所有子节点。</td>
</tr>
<tr>
<td>/bookstore</td>
<td>选取根元素 bookstore。注释：假如路径起始于正斜杠( / )，则此路径始终代表到某元素的绝对路径！</td>
</tr>
<tr>
<td>bookstore/book</td>
<td>选取属于 bookstore 的子元素的所有 book 元素。</td>
</tr>
<tr>
<td>//book</td>
<td>选取所有 book 子元素，而不管它们在文档中的位置。</td>
</tr>
<tr>
<td>bookstore//book</td>
<td>选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</td>
</tr>
<tr>
<td>//@lang</td>
<td>选取名为 lang 的所有属性。</td>
</tr>
</tbody></table>
</li>
<li><p>使用谓词 <code>[ ]</code>:</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>/bookstore/book[1]</td>
<td>选取属于 bookstore 子元素的第一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()]</td>
<td>选取属于 bookstore 子元素的最后一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()-1]</td>
<td>选取属于 bookstore 子元素的倒数第二个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[position() &lt; 3]</td>
<td>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</td>
</tr>
<tr>
<td>//title[@lang]</td>
<td>选取所有拥有名为 lang 的属性的 title 元素。</td>
</tr>
<tr>
<td>//title[@lang=’eng’]</td>
<td>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00]</td>
<td>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00]/title</td>
<td>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
</tbody></table>
</li>
<li><p>选取多个节点:</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>/bookstore/*</td>
<td>选取 bookstore 元素的所有子元素。</td>
</tr>
<tr>
<td>//*</td>
<td>选取文档中的所有元素。</td>
</tr>
<tr>
<td>//title[@*]</td>
<td>选取所有带有属性的 title 元素。</td>
</tr>
<tr>
<td>//book/title | //book/price</td>
<td>选取 book 元素的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>//title | //price</td>
<td>选取文档中的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>/bookstore/book/title | //price</td>
<td>选取属于 bookstore 元素的 book 元素的所有 title 元素，以及文档中所有的 price 元素。</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="实例-获取知乎发现上的问题链接"><a href="#实例-获取知乎发现上的问题链接" class="headerlink" title="实例: 获取知乎发现上的问题链接"></a>实例: 获取知乎发现上的问题链接</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urljoin</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    headers = &#123;<span class="string">'user-agent'</span>: <span class="string">'Baiduspider'</span>&#125;</span><br><span class="line">    proxies = &#123;</span><br><span class="line">        <span class="string">'http'</span>: <span class="string">'http://122.114.31.177:808'</span></span><br><span class="line">    &#125;</span><br><span class="line">    base_url = <span class="string">'https://www.zhihu.com/'</span></span><br><span class="line">    seed_url = urljoin(base_url, <span class="string">'explore'</span>) <span class="comment"># https://www.zhihu.com/explore</span></span><br><span class="line">    resp = requests.get(seed_url,</span><br><span class="line">                        headers=headers,</span><br><span class="line">                        proxies=proxies <span class="comment"># 代理</span></span><br><span class="line">            ) </span><br><span class="line">    soup = BeautifulSoup(resp.text, <span class="string">'lxml'</span>)  </span><br><span class="line">    href_regex = re.compile(<span class="string">r'^/question'</span>) <span class="comment"># 正则匹配 /question</span></span><br><span class="line">    link_set = set()</span><br><span class="line">    <span class="keyword">for</span> a_tag <span class="keyword">in</span> soup.find_all(<span class="string">'a'</span>, &#123;<span class="string">'href'</span>: href_regex&#125;):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'href'</span> <span class="keyword">in</span> a_tag.attrs:</span><br><span class="line">            href = a_tag.attrs[<span class="string">'href'</span>]</span><br><span class="line">            full_url = urljoin(base_url, href)</span><br><span class="line">            link_set.add(full_url)</span><br><span class="line">    print(<span class="string">'Total %d question pages found.'</span> % len(link_set))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="scrapy框架"><a href="#scrapy框架" class="headerlink" title="scrapy框架"></a>scrapy框架</h2><h3 id="实例-爬取我的博客的所有文章信息"><a href="#实例-爬取我的博客的所有文章信息" class="headerlink" title="实例: 爬取我的博客的所有文章信息"></a>实例: 爬取我的博客的所有文章信息</h3><ul>
<li><p>test.py</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> tutorial.items <span class="keyword">import</span> TutorialItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'test'</span>  <span class="comment"># 爬虫名字</span></span><br><span class="line">    allowed_domains = [<span class="string">'tjuyjn.top'</span>]  <span class="comment"># 允许爬取的域名</span></span><br><span class="line">    start_urls = [<span class="string">'http://tjuyjn.top/'</span>]  <span class="comment"># 开始url</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="comment"># print(response.text)  # 源码正常获取</span></span><br><span class="line">        quotes = response.css(<span class="string">".post-list-item.fade"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> quote <span class="keyword">in</span> quotes:</span><br><span class="line">            item = TutorialItem()</span><br><span class="line">            item[<span class="string">'title'</span>] = quote.css(<span class="string">".post-title-link::text"</span>).extract_first()</span><br><span class="line">            item[<span class="string">'tags'</span>] = quote.css(<span class="string">'.article-tag-list-link::text'</span>).extract()</span><br><span class="line">            <span class="keyword">yield</span> item</span><br><span class="line">        </span><br><span class="line">        next = response.css(<span class="string">".extend.next::attr(href)"</span>).extract_first()</span><br><span class="line">        url = response.urljoin(next)</span><br><span class="line">        print(url)</span><br><span class="line">        <span class="keyword">yield</span> scrapy.Request(url=url, callback=self.parse)</span><br></pre></td></tr></table></figure>
</li>
<li><p>items.py</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义爬取的数据结构</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TutorialItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    title = scrapy.Field()</span><br><span class="line">    tags = scrapy.Field()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>其它文件未改动.</p>
<p>运行结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;tags&apos;: [&apos;软件工程&apos;], &apos;title&apos;: &apos;software engineering 笔记&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;python&apos;], &apos;title&apos;: &apos;python拯救计划&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;GAN&apos;, &apos;tensorflow&apos;, &apos;深度学习&apos;], &apos;title&apos;: &apos;机器学习入门&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;计算机网络&apos;], &apos;title&apos;: &apos;计网 summary&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;java&apos;], &apos;title&apos;: &apos;Java 常用方法总结&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;linux&apos;], &apos;title&apos;: &apos;linux 常用命令&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;misc&apos;, &apos;python&apos;], &apos;title&apos;: &apos;拼接图像&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;CTF&apos;, &apos;随笔&apos;], &apos;title&apos;: &apos;CTF-writeup&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;web&apos;, &apos;文件上传漏洞&apos;, &apos;文件包含漏洞&apos;], &apos;title&apos;: &apos;CheckIn&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;arp欺骗&apos;, &apos;web&apos;, &apos;中间人攻击&apos;], &apos;title&apos;: &apos;arp欺骗 初见&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;linux提权&apos;, &apos;metasploit&apos;, &apos;web&apos;], &apos;title&apos;: &apos;Node靶机练习&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;python&apos;, &apos;word&apos;], &apos;title&apos;: &apos;python自动化处理word文档&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;mysql基本语法&apos;, &apos;sql注入&apos;, &apos;web&apos;], &apos;title&apos;: &apos;sqli-lab闯关记录&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;web&apos;, &apos;主机扫描&apos;], &apos;title&apos;: &apos;Nmap 学习笔记&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;linux&apos;, &apos;misc&apos;], &apos;title&apos;: &apos;一个有意思的小工具——aview&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;python&apos;], &apos;title&apos;: &apos;用python给女神刷赞会发生什么？&apos;&#125;</span><br><span class="line">&#123;&apos;tags&apos;: [&apos;php&apos;, &apos;一句话木马&apos;, &apos;图片马&apos;, &apos;文件上传漏洞&apos;], &apos;title&apos;: &apos;上传漏洞&apos;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>其它的可以看我github中练习的小项目. <a href="https://github.com/anti-entropy123/Python-Web-Crawler" target="_blank" rel="noopener">Python-Web-Crawler</a>.</p>
<h1 id="Web框架"><a href="#Web框架" class="headerlink" title="Web框架"></a>Web框架</h1><h2 id="flask框架"><a href="#flask框架" class="headerlink" title="flask框架"></a>flask框架</h2><p>在知乎上找了个学习路线, 我会抽时间总结下面这些问题的解决方案.</p>
<h3 id="定义-url-route"><a href="#定义-url-route" class="headerlink" title="定义 url route"></a>定义 url route</h3><h4 id="使用route-装饰器"><a href="#使用route-装饰器" class="headerlink" title="使用route()装饰器"></a>使用route()装饰器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/'):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Index Page'</span></span><br><span class="line"><span class="meta">@app.route('/hello):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello world'</span></span><br></pre></td></tr></table></figure>

<p><strong>可以在一个函数上附加多个URL route规则.</strong></p>
<h4 id="添加变量"><a href="#添加变量" class="headerlink" title="添加变量"></a>添加变量</h4><p>使用<code>&lt;converter:variable_name&gt;</code>语法来为规则添加变量.</p>
<p>使用例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/user/&lt;int:userid&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_user_profile</span><span class="params">(userid)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f'User <span class="subst">&#123;userid&#125;</span>'</span></span><br></pre></td></tr></table></figure>

<p>几种基本的转换器:<br>|转换器|含义|<br>|:—:|:—:|<br>| (不显使用转换器) |接收不含’/‘的字符串|<br>|int|接收整数|<br>|float|接收浮点数|<br>|path|和默认的类似, 但是接收’/‘|<br>但是有一个问题, 就是转换器接收的变量的两端似乎必须是<code>/</code>.</p>
<p>比如说<code>/user/&lt;int:userid&gt;</code>可以匹配<code>/user/1</code>, <code>/user/2</code>等URL,</p>
<p>但是<code>/user?id=&lt;int:userid&gt;</code>则只能匹配<code>user?id=&lt;int:userid&gt;</code>这个URL, 也就是变量的部分不起作用了. </p>
<p>这个坑是否可以避免我还找到办法, 只能说目前来看这个变量不适合处理<code>GET</code>传来的参数.</p>
<h3 id="组织-request-handler-函数"><a href="#组织-request-handler-函数" class="headerlink" title="组织 request handler 函数"></a>组织 request handler 函数</h3><h4 id="写一个最简单的request-handler-函数"><a href="#写一个最简单的request-handler-函数" class="headerlink" title="写一个最简单的request handler 函数"></a>写一个最简单的request handler 函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello world'</span></span><br></pre></td></tr></table></figure>

<h4 id="从get-post请求中取出参数"><a href="#从get-post请求中取出参数" class="headerlink" title="从get/post请求中取出参数"></a>从get/post请求中取出参数</h4><p>默认情况下, route装饰器只会响应GET请求(和HEAD请求). 如果要处理POST, 需要给route提供methods参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/login', methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        do_the_login()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        show_the_login_form()</span><br></pre></td></tr></table></figure>

<p>那么, 如果要接收数据, 需要使用请求对象 request</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="meta">@app.route('/login', methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    error = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">if</span> valid_login(request.form[<span class="string">'username'</span>], request.form[<span class="string">'password'</span>]):</span><br><span class="line">            <span class="keyword">return</span> log_the_user_in(request.form[<span class="string">'username'</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            error = <span class="string">'Invalid username/password'</span></span><br></pre></td></tr></table></figure>

<p>当form中的键值不存在时, 程序会抛出<code>KeyError</code>异常, 用户会看到HTTP 400 Bad Request. 所以最好捕获此异常, 或者使用<code>request.args.get(&#39;args_name&#39;, &#39;&#39;)</code> 方法.</p>
<h4 id="获取-修改-存储cookie-session数据"><a href="#获取-修改-存储cookie-session数据" class="headerlink" title="获取/修改/存储cookie,session数据"></a>获取/修改/存储cookie,session数据</h4><p>可以通过cookies属性来访问cookies.<br>通过相应对象的set_cookie方法来设置cookies.<br>例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 读取cookies</span></span><br><span class="line">    username = request.cookies.get(<span class="string">'username'</span>) <span class="comment"># 这种方法不会引起KeyError异常.</span></span><br><span class="line"><span class="meta">@app.route('/login')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    resp = make_response(render_template())</span><br><span class="line">    <span class="comment"># 设置cookies</span></span><br><span class="line">    resp.set_cookie(<span class="string">'username'</span>, <span class="string">'the username'</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure>

<p>上面的例子中演示了如何设置和读取cookies, 但是如果想使用会话, 不能直接使用cookies.</p>
<p>会话: session对象允许在不同请求间存储特定用户的信息. 这是在cookies的基础上实现的.<br>首先需要设置一个密钥.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/'):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'username'</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'Logged in as <span class="subst">&#123;escape(session[<span class="string">"username"</span>])&#125;</span>'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'You are not logged in'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login', methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        session[<span class="string">'username'</span>]=request.form[<span class="string">'username'</span>]</span><br><span class="line">        <span class="keyword">return</span>  redirect(url_for(<span class="string">'index'</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'''</span></span><br><span class="line"><span class="string">        &lt;form action="" method="post"&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;&lt;input type=text name=username&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;&lt;input type=submit value=Login&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"><span class="meta">@app.route('/logout')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">()</span>:</span></span><br><span class="line">    session.pop(<span class="string">'username'</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</span><br><span class="line"></span><br><span class="line">app.secret_key = os.urandom(<span class="number">24</span>)</span><br></pre></td></tr></table></figure>

<h4 id="修改-输出-http-header-数据"><a href="#修改-输出-http-header-数据" class="headerlink" title="修改/输出 http header 数据"></a>修改/输出 http header 数据</h4><p>在route函数中, 通常可以默认返回一个response对象. 例如 <code>return make_response(&#39;index.html&#39;)</code>. 这样client接收到的状态码和headers就是默认的.<br>可以通过return一个元组来设置. 例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> make_response(<span class="string">'style.css'</span>), <span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/css'</span>&#125;</span><br></pre></td></tr></table></figure>

<p>这个三元组分别对应响应体, 状态码和响应头.<br>或者修改response对象的属性:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">resp = make_response(<span class="string">'style.css'</span>)</span><br><span class="line">resp.headers[<span class="string">'Content-Type'</span>] = <span class="string">'text/css'</span></span><br><span class="line"><span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure>

<h3 id="使用模板系统"><a href="#使用模板系统" class="headerlink" title="使用模板系统"></a>使用模板系统</h3><h4 id="组织-访问-模板文件的目录结构"><a href="#组织-访问-模板文件的目录结构" class="headerlink" title="组织/访问 模板文件的目录结构"></a>组织/访问 模板文件的目录结构</h4><p>如果要使用模板, 首先要建立<code>/templates</code>目录, 然后向其中加入模板文件, 实例: <code>layout.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">stylesheet</span> <span class="attr">type</span>=<span class="string">text/css</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('static', filename='style.css')&#125;&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">metanav</span>&gt;</span></span><br><span class="line">        &#123;% if not session.logged_in %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('login')&#125;&#125;"</span>&gt;</span>log in<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('logout')&#125;&#125;"</span>&gt;</span>log out<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% for message in get_flashed_messages() %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">flash</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>有了这个<br>可以使用<code>render_template</code>方法来渲染模板, 只需要将模板名和作为关键字的参数传入模板的变量. </p>
<p>在模板中可以访问到 <code>request</code>, <code>session</code>, <code>g</code> 等对象, 以及<code>get_flashed_messages()</code>函数. 它可以实现消息的闪现, 在这里暂时不展开.</p>
<p>上述的实例模板中还有<code>if-else-endif</code>, <code>for</code>等控制语句, 都比较简单, 与 Python 的语法很接近.</p>
<h4 id="配置静态文件访问"><a href="#配置静态文件访问" class="headerlink" title="配置静态文件访问"></a>配置静态文件访问</h4><p>静态文件通常是css和JavaScript文件. 如果要通过Flask访问这种静态文件, 可以在模块旁边或者包中创建一个名为<code>static</code>的文件夹, url为<code>/static</code>即可访问.<br>如果要引用静态文件, 最好用<code>url_for</code>方法.<br>例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"&#123;&#123; url_for('static', filename='style.css') &#125;&#125;"</span> /&gt;  <span class="comment"># static/style.css</span></span><br></pre></td></tr></table></figure>

<h4 id="在模板中嵌入代码模板"><a href="#在模板中嵌入代码模板" class="headerlink" title="在模板中嵌入代码模板"></a>在模板中嵌入代码模板</h4><p>有两种方式进行分别是包含<code>include</code>和继承<code>block</code>.</p>
<ul>
<li><p>包含</p>
<p>  include 比较简单, 看起来只是把一个文件的内容引用至此处. 但是把一个复杂的页面分成若干个不相干的部分, 分别写到其它文件中再一一包含至此, 可以提高代码的可读性、可维护性, 逻辑也会更清晰.</p>
<ul>
<li><p>A.html</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">stylesheet</span> <span class="attr">type</span>=<span class="string">text/css</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('static', filename='style.css')&#125;&#125;"</span>&gt;</span></span><br><span class="line">&#123;% include "B.html" %&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<pre><code>+ B.html

    <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">metanav</span>&gt;</span></span><br><span class="line">        &#123;% if not session.logged_in %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('login')&#125;&#125;"</span>&gt;</span>log in<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('logout')&#125;&#125;"</span>&gt;</span>log out<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% for message in get_flashed_messages() %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">flash</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>


此时如果通过`render_template`来访问 A.html , 就会发现 B.html 中的内容也被加载进来了. </code></pre><ul>
<li><p>继承</p>
<p>  如果说 A 包含 B 是把 B 的代码引入A中, </p>
<p>  那么     A 继承 B 则更像是把 A 的代码覆盖到 B 中, 不过是根据 block 分别覆盖.</p>
<p>  使用的关键字是<code>extends</code> <code>block</code></p>
<ul>
<li><p>A.html</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">main</span> <span class="attr">id</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 顶部标签栏 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"top-header"</span> <span class="attr">id</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-row clearfix"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">class</span>=<span class="string">"header-icon pull-left waves-effect waves-circle waves-light on"</span> <span class="attr">id</span>=<span class="string">"menu-toggle"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"icon icon-lg icon-navicon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-col header-title ellipsis"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">id</span>=<span class="string">"site_search_btn"</span> <span class="attr">class</span>=<span class="string">"header-icon pull-right waves-effect waves-circle waves-light"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"icon icon-lg icon-search"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">        &#123;% block main_layout %&#125;</span><br><span class="line">        主要内容显示于此, 如果你看到了这句话, 请联系站长 qq: 1348651580</span><br><span class="line">        &#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>B.html</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends "A.html" %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main_layout %&#125;</span><br><span class="line"><span class="comment">&lt;!-- index 页的主内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container body-wrap"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 文章列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"post-list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<pre><code>那么此时再访问 B.html, 则会发现 B 中的 `main_layout`这个 block 替换掉了 A 中的 `main_layout`. </code></pre><p>​    </p>
<p>虽然继承和包含使用起来很方便, 但是同时使用二者依然有的时候会有坑, 我遇到的一个就是在被 include 的文件中的 block 的可见性问题.  例如在包含的示例代码 B.html 中, 我希望将顶层的div标签的class值作为一个block, 使得后面继承的模板能让此class具有不同的值.</p>
<p>所以B的代码就成了:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#123;%</span> <span class="attr">block</span> <span class="attr">class</span> %&#125;<span class="attr">page</span>&#123;% <span class="attr">endblock</span> %&#125;&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">metanav</span>&gt;</span></span><br><span class="line">        &#123;% if not session.logged_in %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('login')&#125;&#125;"</span>&gt;</span>log in<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('logout')&#125;&#125;"</span>&gt;</span>log out<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% for message in get_flashed_messages() %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">flash</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同时有一个C.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends "A.html" %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block class %&#125;non-page&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

<p>那么再访问C.html, 会发现这里没有实现对<code>block class</code>的继承. 我推测原因是B中的<code>block class</code>对于C来说是不可见的.</p>
<p>目前我的解决方案是,  把 block 提到 A 中.</p>
<p>A.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">stylesheet</span> <span class="attr">type</span>=<span class="string">text/css</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('static', filename='style.css')&#125;&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#123;%</span> <span class="attr">block</span> <span class="attr">class</span> %&#125;<span class="attr">page</span>&#123;% <span class="attr">endblock</span> %&#125;&gt;</span></span><br><span class="line">	&#123;% include "B.html" %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者设置局部变量应该也行吧, 还没尝试.</p>
<h4 id="自定义模板函数"><a href="#自定义模板函数" class="headerlink" title="自定义模板函数"></a>自定义模板函数</h4><p>// todo</p>
<h3 id="访问数据库"><a href="#访问数据库" class="headerlink" title="访问数据库"></a>访问数据库</h3><h4 id="定义-组织-初始化-数据表"><a href="#定义-组织-初始化-数据表" class="headerlink" title="定义/组织/初始化 数据表"></a>定义/组织/初始化 数据表</h4><p>初始化数据库, 事先将建表的sql语句存储在文件<code>schema.sql</code>中, 然后设置函数进行初始化.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> closing</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect_db</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sqlite3.connect(app.config[<span class="string">'DATABASE'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_db</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> closing(connect_db()) <span class="keyword">as</span> db:</span><br><span class="line">        <span class="keyword">with</span> app.open_resource(<span class="string">'schema.sql'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            db.cursor().executescript(f.read())</span><br><span class="line">            db.commit()</span><br></pre></td></tr></table></figure>

<p>这里的closing方法也比较陌生, 顺带提一下, with 语句打开和关闭某些资源的原理是自动调用对象的<code>__enter__</code>和<code>__exit__</code>方法, 但是有些类并没有这个方法, 所以这里的closing就是给这种类加上<code>__enter__</code>和<code>__exit__</code>, 让它们也能享受到with语句的便利.</p>
<h4 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h4><p>如果要在每个请求前都连接数据库, 最好使用<code>before_request</code>, <code>after_request</code>和<code>teardown_request</code>三个修饰器. 它们的作用是:</p>
<ul>
<li>before_request: 装饰的函数会在请求前调用, 它没有参数. 但当异常抛出时, 不一定被执行.</li>
<li>after_request: 装饰的函数会在请求结束后调用, 需要传入响应.</li>
<li>teardown_request: 装饰的函数将会在响应构造后执行(无论响应构造过程中是否会抛出异常), 不允许修改请求, 返回的值会被忽略. 如果有异常抛出, 则会被作为参数传入, 否则传入None</li>
</ul>
<p>样例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before_request</span><span class="params">()</span>:</span></span><br><span class="line">    g.db = connect_db()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.teardown_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">teardown_request</span><span class="params">(exception)</span>:</span></span><br><span class="line">    g.db.close()</span><br></pre></td></tr></table></figure>

<h4 id="对接orm系统和现有的表结构"><a href="#对接orm系统和现有的表结构" class="headerlink" title="对接orm系统和现有的表结构"></a>对接orm系统和现有的表结构</h4><h4 id="掌握最基本的add"><a href="#掌握最基本的add" class="headerlink" title="掌握最基本的add"></a>掌握最基本的add</h4><h4 id="掌握最基本的delete"><a href="#掌握最基本的delete" class="headerlink" title="掌握最基本的delete"></a>掌握最基本的delete</h4><h4 id="按字段查询"><a href="#按字段查询" class="headerlink" title="按字段查询"></a>按字段查询</h4><h4 id="count"><a href="#count" class="headerlink" title="count"></a>count</h4><h4 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h4><h4 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a>order by</h4><h4 id="直接使用sql访问数据库"><a href="#直接使用sql访问数据库" class="headerlink" title="直接使用sql访问数据库"></a>直接使用sql访问数据库</h4><h3 id="部署app"><a href="#部署app" class="headerlink" title="部署app"></a>部署app</h3><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>一个简洁的方案是创建独立的 .ini 或 .py 文件</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, g, redirect, url_for, abort, render_template, flash</span><br><span class="line"></span><br><span class="line">DATABASE = <span class="string">'/tmp/flaskr.db'</span></span><br><span class="line">DEBUG = <span class="literal">True</span></span><br><span class="line">SECRET_KEY = <span class="string">'development key'</span></span><br><span class="line">USERNAME = <span class="string">'admin'</span></span><br><span class="line">PASSWORD = <span class="string">'default'</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(__name__)</span><br></pre></td></tr></table></figure>

<p><code>from_object()</code>会遍历给定的对象, 如果它是一个字符串, 则会导入它, 否则搜寻里面定义的全部大写的变量. </p>
<h3 id="可选的学习项目"><a href="#可选的学习项目" class="headerlink" title="可选的学习项目"></a>可选的学习项目</h3><h4 id="发送email"><a href="#发送email" class="headerlink" title="发送email"></a>发送email</h4><h4 id="log"><a href="#log" class="headerlink" title="log"></a>log</h4><h4 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h4>
        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-05-18T16:56:34.171Z" itemprop="dateUpdated">2020-05-19 00:56:34</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/2019/12/18/python-saving/" target="_blank" rel="external">https://tjuyjn.top/2019/12/18/python-saving/</a>
        
    </div>
    <footer>
        <a href="https://tjuyjn.top">
            <img src="/img/avatar.jpg" alt="Anti-entropy">
            Anti-entropy
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask/">flask</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scrapy/">scrapy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/正则表达式/">正则表达式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/爬虫/">爬虫</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tjuyjn.top/2019/12/18/python-saving/&title=《python拯救计划》 — Anti-entropy's blog&pic=https://tjuyjn.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tjuyjn.top/2019/12/18/python-saving/&title=《python拯救计划》 — Anti-entropy's blog&source=我决心要提高python编程能力. 在此积累一些牛逼的python使用方法." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tjuyjn.top/2019/12/18/python-saving/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《python拯救计划》 — Anti-entropy's blog&url=https://tjuyjn.top/2019/12/18/python-saving/&via=https://tjuyjn.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tjuyjn.top/2019/12/18/python-saving/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            
    <div id="comment"></div>



        
    </div>
    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="next">
      <a href="/2019/11/05/Computer-network-summary/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">计网 summary</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#高阶特性"><span class="post-toc-number">1.</span> <span class="post-toc-text">高阶特性</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三目运算符"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">三目运算符</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#星号-的使用"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">星号 * 的使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#双星号-的使用"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">双星号 ** 的使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#func-args-kw"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">func(*args, **kw)</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#高阶函数"><span class="post-toc-number">2.</span> <span class="post-toc-text">高阶函数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#filter"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">filter()</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#map"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">map()</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#enumerate"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">enumerate()</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#zip"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">zip()</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#lambda表达式"><span class="post-toc-number">3.</span> <span class="post-toc-text">lambda表达式</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#装饰器"><span class="post-toc-number">4.</span> <span class="post-toc-text">装饰器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#简单装饰器"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">简单装饰器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#在-f-运行后再打印-quot-finish-quot"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">在 f() 运行后再打印&quot;finish&quot;</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用多个装饰器实现上一个功能"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">使用多个装饰器实现上一个功能</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用带有参数的装饰器-打印-quot-start-quot-参数"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">使用带有参数的装饰器, 打印&quot;start&quot; + 参数</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#列表生成式"><span class="post-toc-number">5.</span> <span class="post-toc-text">列表生成式</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#正则表达式"><span class="post-toc-number">6.</span> <span class="post-toc-text">正则表达式</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#爬虫"><span class="post-toc-number">7.</span> <span class="post-toc-text">爬虫</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Basic"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">Basic</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#request-库"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">request 库</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#XPath-解析"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">XPath 解析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#实例-获取知乎发现上的问题链接"><span class="post-toc-number">7.4.</span> <span class="post-toc-text">实例: 获取知乎发现上的问题链接</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#scrapy框架"><span class="post-toc-number">7.5.</span> <span class="post-toc-text">scrapy框架</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实例-爬取我的博客的所有文章信息"><span class="post-toc-number">7.5.1.</span> <span class="post-toc-text">实例: 爬取我的博客的所有文章信息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#其他"><span class="post-toc-number">7.5.2.</span> <span class="post-toc-text">其他</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web框架"><span class="post-toc-number">8.</span> <span class="post-toc-text">Web框架</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#flask框架"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">flask框架</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#定义-url-route"><span class="post-toc-number">8.1.1.</span> <span class="post-toc-text">定义 url route</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用route-装饰器"><span class="post-toc-number">8.1.1.1.</span> <span class="post-toc-text">使用route()装饰器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加变量"><span class="post-toc-number">8.1.1.2.</span> <span class="post-toc-text">添加变量</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#组织-request-handler-函数"><span class="post-toc-number">8.1.2.</span> <span class="post-toc-text">组织 request handler 函数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#写一个最简单的request-handler-函数"><span class="post-toc-number">8.1.2.1.</span> <span class="post-toc-text">写一个最简单的request handler 函数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#从get-post请求中取出参数"><span class="post-toc-number">8.1.2.2.</span> <span class="post-toc-text">从get/post请求中取出参数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#获取-修改-存储cookie-session数据"><span class="post-toc-number">8.1.2.3.</span> <span class="post-toc-text">获取/修改/存储cookie,session数据</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#修改-输出-http-header-数据"><span class="post-toc-number">8.1.2.4.</span> <span class="post-toc-text">修改/输出 http header 数据</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用模板系统"><span class="post-toc-number">8.1.3.</span> <span class="post-toc-text">使用模板系统</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#组织-访问-模板文件的目录结构"><span class="post-toc-number">8.1.3.1.</span> <span class="post-toc-text">组织/访问 模板文件的目录结构</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#配置静态文件访问"><span class="post-toc-number">8.1.3.2.</span> <span class="post-toc-text">配置静态文件访问</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在模板中嵌入代码模板"><span class="post-toc-number">8.1.3.3.</span> <span class="post-toc-text">在模板中嵌入代码模板</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#自定义模板函数"><span class="post-toc-number">8.1.3.4.</span> <span class="post-toc-text">自定义模板函数</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#访问数据库"><span class="post-toc-number">8.1.4.</span> <span class="post-toc-text">访问数据库</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#定义-组织-初始化-数据表"><span class="post-toc-number">8.1.4.1.</span> <span class="post-toc-text">定义/组织/初始化 数据表</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#连接数据库"><span class="post-toc-number">8.1.4.2.</span> <span class="post-toc-text">连接数据库</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#对接orm系统和现有的表结构"><span class="post-toc-number">8.1.4.3.</span> <span class="post-toc-text">对接orm系统和现有的表结构</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#掌握最基本的add"><span class="post-toc-number">8.1.4.4.</span> <span class="post-toc-text">掌握最基本的add</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#掌握最基本的delete"><span class="post-toc-number">8.1.4.5.</span> <span class="post-toc-text">掌握最基本的delete</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#按字段查询"><span class="post-toc-number">8.1.4.6.</span> <span class="post-toc-text">按字段查询</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#count"><span class="post-toc-number">8.1.4.7.</span> <span class="post-toc-text">count</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#slice"><span class="post-toc-number">8.1.4.8.</span> <span class="post-toc-text">slice</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#order-by"><span class="post-toc-number">8.1.4.9.</span> <span class="post-toc-text">order by</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#直接使用sql访问数据库"><span class="post-toc-number">8.1.4.10.</span> <span class="post-toc-text">直接使用sql访问数据库</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#部署app"><span class="post-toc-number">8.1.5.</span> <span class="post-toc-text">部署app</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#配置文件"><span class="post-toc-number">8.1.5.1.</span> <span class="post-toc-text">配置文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#可选的学习项目"><span class="post-toc-number">8.1.6.</span> <span class="post-toc-text">可选的学习项目</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#发送email"><span class="post-toc-number">8.1.6.1.</span> <span class="post-toc-text">发送email</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#log"><span class="post-toc-number">8.1.6.2.</span> <span class="post-toc-text">log</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#图片处理"><span class="post-toc-number">8.1.6.3.</span> <span class="post-toc-text">图片处理</span></a></li></ol></li></ol></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        我们一起来让这个世界有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://www.lujingtao.com" target="_blank">主题作者</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.tjuscswyz.cn/" target="_blank">p4ssw0rd</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/ever17/" target="_blank">Ever17</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/tkj521Ya/" target="_blank">Exaggerate~</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://r1895.github.io" target="_blank">jason1999</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://tjublesson.top/" target="_blank">blesson</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://glimmerzcy.github.io" target="_blank">ZCY</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://blog.csdn.net/Harry____" target="_blank">Harry____</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://daemon.tjunsa.com/" target="_blank">deamon</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Anti-entropy &copy; 2019 - 2020
            </span>
        		
           	
            
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tjuyjn.top/2019/12/18/python-saving/&title=《python拯救计划》 — Anti-entropy's blog&pic=https://tjuyjn.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tjuyjn.top/2019/12/18/python-saving/&title=《python拯救计划》 — Anti-entropy's blog&source=我决心要提高python编程能力. 在此积累一些牛逼的python使用方法." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tjuyjn.top/2019/12/18/python-saving/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《python拯救计划》 — Anti-entropy's blog&url=https://tjuyjn.top/2019/12/18/python-saving/&via=https://tjuyjn.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tjuyjn.top/2019/12/18/python-saving/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACHklEQVR42u3aMW7DMAwF0Nz/0i7QqR2ifJJO0EpPk4dE8vNAkCIfj3hd32vy/HPlv7l5YWBg/FvGtVzrI3s7VD/TemcMDIxzGL0g++xz5LExP/fFO2NgYGAsg906yCYLAwMD496AOzlsnWJiYGBgrBlJCZpfiiWveFd5jIGBcQLjM42B3vOf629gYGB8nHEN1jxEToreX//FwMDYmlG90K8GyrxtmSSXL94QAwNjU0by06TdWA2syVn5uRgYGGcyeqEwH7OoXrcVilgMDIxNGdUmQXJk/rrVUY+nARcDA+MARj7iMGoiFgvjKGXEwMDYmtFLznpFb57wNZsNGBgYxzCqr5IkfL0mZbInBgbGCYx8o0mTMr+ey6/wno5ZYGBgbMropW6952pTM/o0GBgYRzLeMWzRaxIUxsIwMDC2ZuRNxGoad0OFnaSkGBgYRzLyQFxtbc5JGBgYpzHmRebk0r/asCzkuRgYGNsx8tI033SSblbLZgwMjBMYkWwQCpOw2zuxcOmGgYGxBSNJ1HpBOf8EeUH7YroNAwNjO0Zevt52NVbNVav/wsDA2IhxFVdylT/HJ/tjYGCcw8hX7/osGpWI98TAwDiZMW8A9K7yqwE3GrbAwMDYmjFvN+bJYh58CzwMDAyMYnZZDa/5iRgYGBj59EJyWG8iojdwhoGBcQLjHU3Kyf7lJBIDA2NrRq8xUE0Nq0G82hDFwMDYlPEF+GUZBmCI4/oAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.2"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.2"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.2"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.2"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.2"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
        <script type="text/javascript" src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script type="text/javascript" src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script type="text/javascript" src="/js/plugins/valine.js?v=1.4.2"></script>
    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '不要离开我！';
                clearTimeout(titleTime);
            } else {
                document.title = '嘤嘤嘤!太好了~';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
    <script type="text/javascript">           
        /* 鼠标特效 */ 
        var a_idx = 0; 
        jQuery(document).ready(function($) { 
            $("body").click(function(e) { 
                var a = new Array("❤好❤","❤看❤","❤就❤","❤留❤","❤个❤","❤言❤","❤吧❤"); 
                var $i = $("<span></span>").text(a[a_idx]); 
                a_idx = (a_idx + 1) % a.length; 
                var x = e.pageX, 
                y = e.pageY; 
                $i.css({ 
                    "z-index": 999999999999999999999999999999999999999999999999999999999999999999999, 
                    "top": y - 20, 
                    "left": x, 
                    "position": "absolute", 
                    "font-weight": "bold", 
                    "color": "rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")" 
                }); 
                $("body").append($i); 
                $i.animate({ 
                    "top": y - 180, 
                    "opacity": 0 
                }, 
                1500, 
                function() { 
                    $i.remove(); 
                }); 
            }); 
        }); 
    </script>
    <!--动态线条背景-->
    <script type="text/javascript" color="30,144,255" opacity='0.7' zIndex="-2" count="50" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
